(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{34537:function(e){"use strict";e.exports=function(e,t){var i=new Array(arguments.length-1),n=0,r=2,o=!0;for(;r<arguments.length;)i[n++]=arguments[r++];return new Promise((function(r,s){i[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),i=0;i<t.length;)t[i++]=arguments[i];r.apply(null,t)}};try{e.apply(t||null,i)}catch(a){o&&(o=!1,s(a))}}))}},97419:function(e,t){"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var n=new Array(64),r=new Array(123),o=0;o<64;)r[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function(e,t,i){for(var r,o=null,s=[],a=0,c=0;t<i;){var d=e[t++];switch(c){case 0:s[a++]=n[d>>2],r=(3&d)<<4,c=1;break;case 1:s[a++]=n[r|d>>4],r=(15&d)<<2,c=2;break;case 2:s[a++]=n[r|d>>6],s[a++]=n[63&d],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[r],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";i.decode=function(e,t,i){for(var n,o=i,a=0,c=0;c<e.length;){var d=e.charCodeAt(c++);if(61===d&&a>1)break;if(void 0===(d=r[d]))throw Error(s);switch(a){case 0:n=d,a=1;break;case 1:t[i++]=n<<2|(48&d)>>4,n=d,a=2;break;case 2:t[i++]=(15&n)<<4|(60&d)>>2,n=d,a=3;break;case 3:t[i++]=(3&n)<<6|d,a=0}}if(1===a)throw Error(s);return i-o},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},19211:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},10945:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),i=new Uint8Array(t.buffer),n=128===i[3];function r(e,n,r){t[0]=e,n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2],n[r+3]=i[3]}function o(e,n,r){t[0]=e,n[r]=i[3],n[r+1]=i[2],n[r+2]=i[1],n[r+3]=i[0]}function s(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],t[0]}function a(e,n){return i[3]=e[n],i[2]=e[n+1],i[1]=e[n+2],i[0]=e[n+3],t[0]}e.writeFloatLE=n?r:o,e.writeFloatBE=n?o:r,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,i,n){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,i,n);else if(isNaN(t))e(2143289344,i,n);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,i,n);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,i,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((r<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,i,n)}}function s(e,t,i){var n=e(t,i),r=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:r*(1/0):0===o?1401298464324817e-60*r*s:r*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,n),e.readFloatLE=s.bind(null,r),e.readFloatBE=s.bind(null,o)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),i=new Uint8Array(t.buffer),n=128===i[7];function r(e,n,r){t[0]=e,n[r]=i[0],n[r+1]=i[1],n[r+2]=i[2],n[r+3]=i[3],n[r+4]=i[4],n[r+5]=i[5],n[r+6]=i[6],n[r+7]=i[7]}function o(e,n,r){t[0]=e,n[r]=i[7],n[r+1]=i[6],n[r+2]=i[5],n[r+3]=i[4],n[r+4]=i[3],n[r+5]=i[2],n[r+6]=i[1],n[r+7]=i[0]}function s(e,n){return i[0]=e[n],i[1]=e[n+1],i[2]=e[n+2],i[3]=e[n+3],i[4]=e[n+4],i[5]=e[n+5],i[6]=e[n+6],i[7]=e[n+7],t[0]}function a(e,n){return i[7]=e[n],i[6]=e[n+1],i[5]=e[n+2],i[4]=e[n+3],i[3]=e[n+4],i[2]=e[n+5],i[1]=e[n+6],i[0]=e[n+7],t[0]}e.writeDoubleLE=n?r:o,e.writeDoubleBE=n?o:r,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,i,n,r,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,r,o+t),e(1/n>0?0:2147483648,r,o+i);else if(isNaN(n))e(0,r,o+t),e(2146959360,r,o+i);else if(n>17976931348623157e292)e(0,r,o+t),e((s<<31|2146435072)>>>0,r,o+i);else{var a;if(n<22250738585072014e-324)e((a=n/5e-324)>>>0,r,o+t),e((s<<31|a/4294967296)>>>0,r,o+i);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,r,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,r,o+i)}}}function s(e,t,i,n,r){var o=e(n,r+t),s=e(n,r+i),a=2*(s>>31)+1,c=s>>>20&2047,d=4294967296*(1048575&s)+o;return 2047===c?d?NaN:a*(1/0):0===c?5e-324*a*d:a*Math.pow(2,c-1075)*(d+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,n,4,0),e.readDoubleLE=s.bind(null,r,0,4),e.readDoubleBE=s.bind(null,o,4,0)}(),e}function i(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}function n(e,t,i){t[i]=e>>>24,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}function r(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},67199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},76662:function(e){"use strict";e.exports=function(e,t,i){var n=i||8192,r=n>>>1,o=null,s=n;return function(i){if(i<1||i>r)return e(i);s+i>n&&(o=e(n),s=0);var a=t.call(o,s,s+=i);return 7&s&&(s=1+(7|s)),a}}},94997:function(e,t){"use strict";var i=t;i.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296===(64512&i)&&56320===(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},i.read=function(e,t,i){if(i-t<1)return"";for(var n,r=null,o=[],s=0;t<i;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,o)),s=0);return r?(s&&r.push(String.fromCharCode.apply(String,o.slice(0,s))),r.join("")):String.fromCharCode.apply(String,o.slice(0,s))},i.write=function(e,t,i){for(var n,r,o=i,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296===(64512&n)&&56320===(64512&(r=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&r),++s,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-o}},17187:function(e){"use strict";var t,i="object"===typeof Reflect?Reflect:null,n=i&&"function"===typeof i.apply?i.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};t=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,o),n(i)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,i){"function"===typeof e.on&&m(e,"error",t,i)}(e,r,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,i,n){var r,o,s,d;if(a(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),s=o[t]),void 0===s)s=o[t]=i,++e._eventsCount;else if("function"===typeof s?s=o[t]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(r=c(e))>0&&s.length>r&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,d=u,console&&console.warn&&console.warn(d)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=u.bind(n);return r.listener=i,n.wrapFn=r,r}function p(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"===typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):f(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"===typeof i)return 1;if(void 0!==i)return i.length}return 0}function f(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function m(e,t,i,n){if("function"===typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){n.once&&e.removeEventListener(t,r),i(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var d=c.length,u=f(c,d);for(i=0;i<d;++i)n(u[i],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,l(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,l(this,e,t)),this},o.prototype.removeListener=function(e,t){var i,n,r,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!==typeof i){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){s=i[o].listener,r=o;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(r=o[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},o.prototype.listenerCount=h,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},9286:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toProtoSessionDescription=t.SignalClient=void 0,i(50835);const o=r(i(72662)),s=i(44658),a=i(67650),c=i(71981);function d(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function u(e){return{sdp:e.sdp,type:e.type}}t.SignalClient=class{constructor(e=!1){this.isConnected=!1,this.useJSON=e}join(e,t,i){return n(this,void 0,void 0,(function*(){return yield this.connect(e,t,{autoSubscribe:null===i||void 0===i?void 0:i.autoSubscribe})}))}reconnect(e,t){return n(this,void 0,void 0,(function*(){yield this.connect(e,t,{reconnect:!0})}))}connect(e,t,i){e.startsWith("http")&&(e=e.replace("http","ws")),e=e.replace(/\/$/,""),e+="/rtc";const r=function(e,t,i){const n=new URLSearchParams;n.set("access_token",e),(null===i||void 0===i?void 0:i.reconnect)&&n.set("reconnect","1");void 0!==(null===i||void 0===i?void 0:i.autoSubscribe)&&n.set("auto_subscribe",i.autoSubscribe?"1":"0");n.set("sdk","js"),n.set("version",t.version),n.set("protocol",t.protocol.toString()),t.deviceModel&&n.set("device_model",t.deviceModel);t.os&&n.set("os",t.os);t.osVersion&&n.set("os_version",t.osVersion);t.browser&&n.set("browser",t.browser);t.browserVersion&&n.set("browser_version",t.browserVersion);return`?${n.toString()}`}(t,c.getClientInfo(),i);return new Promise(((t,d)=>{o.default.debug("connecting to",e+r),this.ws=void 0;const u=new WebSocket(e+r);u.binaryType="arraybuffer",u.onerror=t=>n(this,void 0,void 0,(function*(){if(this.ws)this.handleWSError(t);else try{const t=yield fetch(`http${e.substring(2)}/validate${r}`);if(t.ok)d(new a.ConnectionError("Internal error"));else{const e=yield t.text();d(new a.ConnectionError(e))}}catch(i){d(new a.ConnectionError("server was not reachable"))}})),u.onopen=()=>{this.ws=u,i.reconnect&&(this.isConnected=!0,t())},u.onmessage=e=>n(this,void 0,void 0,(function*(){let i;if("string"===typeof e.data){const t=JSON.parse(e.data);i=s.SignalResponse.fromJSON(t)}else{if(!(e.data instanceof ArrayBuffer))return void o.default.error("could not decode websocket message",typeof e.data);i=s.SignalResponse.decode(new Uint8Array(e.data))}this.isConnected?(this.signalLatency&&(yield c.sleep(this.signalLatency)),this.handleSignalResponse(i)):i.join?(this.isConnected=!0,t(i.join)):d(new a.ConnectionError("did not receive join response"))})),u.onclose=e=>{this.isConnected&&(o.default.debug("websocket connection closed",e.reason),this.isConnected=!1,this.onClose&&this.onClose(e.reason),this.ws===u&&(this.ws=void 0))}}))}close(){var e;this.isConnected=!1,this.ws&&(this.ws.onclose=null),null===(e=this.ws)||void 0===e||e.close(),this.ws=void 0}sendOffer(e){o.default.debug("sending offer",e),this.sendRequest({offer:u(e)})}sendAnswer(e){o.default.debug("sending answer"),this.sendRequest({answer:u(e)})}sendIceCandidate(e,t){o.default.trace("sending ice candidate",e),this.sendRequest({trickle:{candidateInit:JSON.stringify(e),target:t}})}sendMuteTrack(e,t){this.sendRequest({mute:{sid:e,muted:t}})}sendAddTrack(e){this.sendRequest({addTrack:s.AddTrackRequest.fromPartial(e)})}sendUpdateTrackSettings(e){this.sendRequest({trackSetting:e})}sendUpdateSubscription(e){this.sendRequest({subscription:e})}sendSyncState(e){this.sendRequest({syncState:e})}sendUpdateVideoLayers(e,t){this.sendRequest({updateLayers:{trackSid:e,layers:t}})}sendUpdateSubscriptionPermissions(e,t){this.sendRequest({subscriptionPermissions:{allParticipants:e,trackPermissions:t}})}sendSimulateScenario(e){this.sendRequest({simulate:e})}sendLeave(){this.sendRequest(s.SignalRequest.fromPartial({leave:{}}))}sendRequest(e){return n(this,void 0,void 0,(function*(){if(this.signalLatency&&(yield c.sleep(this.signalLatency)),this.ws)try{this.useJSON?this.ws.send(JSON.stringify(s.SignalRequest.toJSON(e))):this.ws.send(s.SignalRequest.encode(e).finish())}catch(t){o.default.error("error sending signal message",t)}else o.default.error("cannot send signal request before connected")}))}handleSignalResponse(e){if(e.answer){const t=d(e.answer);this.onAnswer&&this.onAnswer(t)}else if(e.offer){const t=d(e.offer);this.onOffer&&this.onOffer(t)}else if(e.trickle){const t=JSON.parse(e.trickle.candidateInit);this.onTrickle&&this.onTrickle(t,e.trickle.target)}else e.update?this.onParticipantUpdate&&this.onParticipantUpdate(e.update.participants):e.trackPublished?this.onLocalTrackPublished&&this.onLocalTrackPublished(e.trackPublished):e.speakersChanged?this.onSpeakersChanged&&this.onSpeakersChanged(e.speakersChanged.speakers):e.leave?this.onLeave&&this.onLeave():e.mute?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(e.mute.sid,e.mute.muted):e.roomUpdate?this.onRoomUpdate&&this.onRoomUpdate(e.roomUpdate.room):e.connectionQuality?this.onConnectionQuality&&this.onConnectionQuality(e.connectionQuality):e.streamStateUpdate?this.onStreamStateUpdate&&this.onStreamStateUpdate(e.streamStateUpdate):e.subscribedQualityUpdate?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(e.subscribedQualityUpdate):e.subscriptionPermissionUpdate?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(e.subscriptionPermissionUpdate):o.default.debug("unsupported message",e)}handleWSError(e){o.default.error("websocket error",e)}},t.toProtoSessionDescription=u},22011:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=t.version=void 0;const c=o(i(72662)),d=i(67650),u=i(28911),l=a(i(93258));var p=i(36942);Object.defineProperty(t,"version",{enumerable:!0,get:function(){return p.version}}),t.connect=function(e,t,i){var n,r,o,a;return s(this,void 0,void 0,(function*(){null!==i&&void 0!==i||(i={}),void 0===i.adaptiveStream&&(i.adaptiveStream=i.autoManageVideo),c.setLogLevel(null!==(n=i.logLevel)&&void 0!==n?n:c.LogLevel.warn);const p=null!==(r=i.rtcConfig)&&void 0!==r?r:{};i.iceServers&&(p.iceServers=i.iceServers);const h=new l.default(i);yield h.connect(e,t,i);const f=null!==(o=i.audio)&&void 0!==o&&o,m=null!==(a=i.video)&&void 0!==a&&a;return(f||m)&&setTimeout((()=>s(this,void 0,void 0,(function*(){let e;if(f&&m)try{yield h.localParticipant.enableCameraAndMicrophone()}catch(t){const n=d.MediaDeviceFailure.getFailure(t);if(c.default.warn("received error while creating media",n),t instanceof Error&&c.default.warn(t.message),n===d.MediaDeviceFailure.NotFound||n===d.MediaDeviceFailure.DeviceInUse)try{yield h.localParticipant.setMicrophoneEnabled(!0)}catch(i){e=i}else e=t}else if(f)try{yield h.localParticipant.setMicrophoneEnabled(!0)}catch(t){e=t}else if(m)try{yield h.localParticipant.setCameraEnabled(!0)}catch(t){e=t}e&&(h.emit(u.RoomEvent.MediaDevicesError,e),c.default.error("could not create media",e))})))),h}))}},78219:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},s=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoQuality=t.TrackPublication=t.RemoteTrackPublication=t.RemoteVideoTrack=t.RemoteAudioTrack=t.RemoteTrack=t.LocalTrackPublication=t.LocalTrack=t.LocalVideoTrack=t.LocalAudioTrack=t.LocalParticipant=t.RemoteParticipant=t.Participant=t.ConnectionQuality=t.DataPacket_Kind=t.RoomState=t.Room=t.setLogLevel=void 0;const c=i(72662);Object.defineProperty(t,"setLogLevel",{enumerable:!0,get:function(){return c.setLogLevel}});const d=i(8983);Object.defineProperty(t,"DataPacket_Kind",{enumerable:!0,get:function(){return d.DataPacket_Kind}}),Object.defineProperty(t,"VideoQuality",{enumerable:!0,get:function(){return d.VideoQuality}});const u=a(i(24149));t.LocalParticipant=u.default;const l=o(i(22070));t.Participant=l.default,Object.defineProperty(t,"ConnectionQuality",{enumerable:!0,get:function(){return l.ConnectionQuality}});const p=a(i(51488));t.RemoteParticipant=p.default;const h=o(i(93258));t.Room=h.default,Object.defineProperty(t,"RoomState",{enumerable:!0,get:function(){return h.RoomState}});const f=a(i(98669));t.LocalAudioTrack=f.default;const m=a(i(35728));t.LocalTrack=m.default;const v=a(i(170));t.LocalTrackPublication=v.default;const b=a(i(76887));t.LocalVideoTrack=b.default;const g=a(i(35941));t.RemoteAudioTrack=g.default;const k=a(i(65785));t.RemoteTrack=k.default;const S=a(i(40297));t.RemoteTrackPublication=S.default;const y=a(i(466));t.RemoteVideoTrack=y.default;const w=i(22184);Object.defineProperty(t,"TrackPublication",{enumerable:!0,get:function(){return w.TrackPublication}}),s(i(22011),t),s(i(4797),t),s(i(67650),t),s(i(28911),t),s(i(60119),t),s(i(36669),t),s(i(80410),t),s(i(55884),t),s(i(36942),t)},72662:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setLogLevel=t.LogLevel=void 0;const r=n(i(2043));var o;!function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.silent="silent"}(o=t.LogLevel||(t.LogLevel={}));const s=r.default.getLogger("livekit");s.setLevel(o.info),t.default=s,t.setLogLevel=function(e){s.setLevel(e)}},4797:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},8983:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ClientInfo=t.ParticipantTracks=t.UserPacket=t.SpeakerInfo=t.ActiveSpeakerUpdate=t.DataPacket=t.VideoLayer=t.TrackInfo=t.ParticipantInfo=t.Codec=t.Room=t.clientInfo_SDKToJSON=t.clientInfo_SDKFromJSON=t.ClientInfo_SDK=t.dataPacket_KindToJSON=t.dataPacket_KindFromJSON=t.DataPacket_Kind=t.participantInfo_StateToJSON=t.participantInfo_StateFromJSON=t.ParticipantInfo_State=t.connectionQualityToJSON=t.connectionQualityFromJSON=t.ConnectionQuality=t.videoQualityToJSON=t.videoQualityFromJSON=t.VideoQuality=t.trackSourceToJSON=t.trackSourceFromJSON=t.TrackSource=t.trackTypeToJSON=t.trackTypeFromJSON=t.TrackType=t.protobufPackage=void 0;const r=n(i(43720)),o=n(i(62100));var s,a,c,d,u,l,p;function h(e){switch(e){case 0:case"AUDIO":return s.AUDIO;case 1:case"VIDEO":return s.VIDEO;case 2:case"DATA":return s.DATA;case-1:case"UNRECOGNIZED":default:return s.UNRECOGNIZED}}function f(e){switch(e){case s.AUDIO:return"AUDIO";case s.VIDEO:return"VIDEO";case s.DATA:return"DATA";default:return"UNKNOWN"}}function m(e){switch(e){case 0:case"UNKNOWN":return a.UNKNOWN;case 1:case"CAMERA":return a.CAMERA;case 2:case"MICROPHONE":return a.MICROPHONE;case 3:case"SCREEN_SHARE":return a.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return a.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return a.UNRECOGNIZED}}function v(e){switch(e){case a.UNKNOWN:return"UNKNOWN";case a.CAMERA:return"CAMERA";case a.MICROPHONE:return"MICROPHONE";case a.SCREEN_SHARE:return"SCREEN_SHARE";case a.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";default:return"UNKNOWN"}}function b(e){switch(e){case 0:case"LOW":return c.LOW;case 1:case"MEDIUM":return c.MEDIUM;case 2:case"HIGH":return c.HIGH;case 3:case"OFF":return c.OFF;case-1:case"UNRECOGNIZED":default:return c.UNRECOGNIZED}}function g(e){switch(e){case c.LOW:return"LOW";case c.MEDIUM:return"MEDIUM";case c.HIGH:return"HIGH";case c.OFF:return"OFF";default:return"UNKNOWN"}}function k(e){switch(e){case 0:case"JOINING":return u.JOINING;case 1:case"JOINED":return u.JOINED;case 2:case"ACTIVE":return u.ACTIVE;case 3:case"DISCONNECTED":return u.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return u.UNRECOGNIZED}}function S(e){switch(e){case u.JOINING:return"JOINING";case u.JOINED:return"JOINED";case u.ACTIVE:return"ACTIVE";case u.DISCONNECTED:return"DISCONNECTED";default:return"UNKNOWN"}}function y(e){switch(e){case 0:case"RELIABLE":return l.RELIABLE;case 1:case"LOSSY":return l.LOSSY;case-1:case"UNRECOGNIZED":default:return l.UNRECOGNIZED}}function w(e){switch(e){case l.RELIABLE:return"RELIABLE";case l.LOSSY:return"LOSSY";default:return"UNKNOWN"}}function T(e){switch(e){case 0:case"UNKNOWN":return p.UNKNOWN;case 1:case"JS":return p.JS;case 2:case"SWIFT":return p.SWIFT;case 3:case"ANDROID":return p.ANDROID;case 4:case"FLUTTER":return p.FLUTTER;case 5:case"GO":return p.GO;case 6:case"UNITY":return p.UNITY;case-1:case"UNRECOGNIZED":default:return p.UNRECOGNIZED}}function P(e){switch(e){case p.UNKNOWN:return"UNKNOWN";case p.JS:return"JS";case p.SWIFT:return"SWIFT";case p.ANDROID:return"ANDROID";case p.FLUTTER:return"FLUTTER";case p.GO:return"GO";case p.UNITY:return"UNITY";default:return"UNKNOWN"}}t.protobufPackage="livekit",function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(s=t.TrackType||(t.TrackType={})),t.trackTypeFromJSON=h,t.trackTypeToJSON=f,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(a=t.TrackSource||(t.TrackSource={})),t.trackSourceFromJSON=m,t.trackSourceToJSON=v,function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(c=t.VideoQuality||(t.VideoQuality={})),t.videoQualityFromJSON=b,t.videoQualityToJSON=g,function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(d=t.ConnectionQuality||(t.ConnectionQuality={})),t.connectionQualityFromJSON=function(e){switch(e){case 0:case"POOR":return d.POOR;case 1:case"GOOD":return d.GOOD;case 2:case"EXCELLENT":return d.EXCELLENT;case-1:case"UNRECOGNIZED":default:return d.UNRECOGNIZED}},t.connectionQualityToJSON=function(e){switch(e){case d.POOR:return"POOR";case d.GOOD:return"GOOD";case d.EXCELLENT:return"EXCELLENT";default:return"UNKNOWN"}},function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(u=t.ParticipantInfo_State||(t.ParticipantInfo_State={})),t.participantInfo_StateFromJSON=k,t.participantInfo_StateToJSON=S,function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(l=t.DataPacket_Kind||(t.DataPacket_Kind={})),t.dataPacket_KindFromJSON=y,t.dataPacket_KindToJSON=w,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(p=t.ClientInfo_SDK||(t.ClientInfo_SDK={})),t.clientInfo_SDKFromJSON=T,t.clientInfo_SDKToJSON=P;const C={sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",metadata:"",numParticipants:0,activeRecording:!1};t.Room={encode(e,i=o.default.Writer.create()){""!==e.sid&&i.uint32(10).string(e.sid),""!==e.name&&i.uint32(18).string(e.name),0!==e.emptyTimeout&&i.uint32(24).uint32(e.emptyTimeout),0!==e.maxParticipants&&i.uint32(32).uint32(e.maxParticipants),0!==e.creationTime&&i.uint32(40).int64(e.creationTime),""!==e.turnPassword&&i.uint32(50).string(e.turnPassword);for(const n of e.enabledCodecs)t.Codec.encode(n,i.uint32(58).fork()).ldelim();return""!==e.metadata&&i.uint32(66).string(e.metadata),0!==e.numParticipants&&i.uint32(72).uint32(e.numParticipants),!0===e.activeRecording&&i.uint32(80).bool(e.activeRecording),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},C);for(s.enabledCodecs=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.sid=n.string();break;case 2:s.name=n.string();break;case 3:s.emptyTimeout=n.uint32();break;case 4:s.maxParticipants=n.uint32();break;case 5:s.creationTime=J(n.int64());break;case 6:s.turnPassword=n.string();break;case 7:s.enabledCodecs.push(t.Codec.decode(n,n.uint32()));break;case 8:s.metadata=n.string();break;case 9:s.numParticipants=n.uint32();break;case 10:s.activeRecording=n.bool();break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},C);if(i.enabledCodecs=[],void 0!==e.sid&&null!==e.sid?i.sid=String(e.sid):i.sid="",void 0!==e.name&&null!==e.name?i.name=String(e.name):i.name="",void 0!==e.emptyTimeout&&null!==e.emptyTimeout?i.emptyTimeout=Number(e.emptyTimeout):i.emptyTimeout=0,void 0!==e.maxParticipants&&null!==e.maxParticipants?i.maxParticipants=Number(e.maxParticipants):i.maxParticipants=0,void 0!==e.creationTime&&null!==e.creationTime?i.creationTime=Number(e.creationTime):i.creationTime=0,void 0!==e.turnPassword&&null!==e.turnPassword?i.turnPassword=String(e.turnPassword):i.turnPassword="",void 0!==e.enabledCodecs&&null!==e.enabledCodecs)for(const n of e.enabledCodecs)i.enabledCodecs.push(t.Codec.fromJSON(n));return void 0!==e.metadata&&null!==e.metadata?i.metadata=String(e.metadata):i.metadata="",void 0!==e.numParticipants&&null!==e.numParticipants?i.numParticipants=Number(e.numParticipants):i.numParticipants=0,void 0!==e.activeRecording&&null!==e.activeRecording?i.activeRecording=Boolean(e.activeRecording):i.activeRecording=!1,i},toJSON(e){const i={};return void 0!==e.sid&&(i.sid=e.sid),void 0!==e.name&&(i.name=e.name),void 0!==e.emptyTimeout&&(i.emptyTimeout=e.emptyTimeout),void 0!==e.maxParticipants&&(i.maxParticipants=e.maxParticipants),void 0!==e.creationTime&&(i.creationTime=e.creationTime),void 0!==e.turnPassword&&(i.turnPassword=e.turnPassword),e.enabledCodecs?i.enabledCodecs=e.enabledCodecs.map((e=>e?t.Codec.toJSON(e):void 0)):i.enabledCodecs=[],void 0!==e.metadata&&(i.metadata=e.metadata),void 0!==e.numParticipants&&(i.numParticipants=e.numParticipants),void 0!==e.activeRecording&&(i.activeRecording=e.activeRecording),i},fromPartial(e){var i,n,r,o,s,a,c,d,u;const l=Object.assign({},C);if(l.sid=null!==(i=e.sid)&&void 0!==i?i:"",l.name=null!==(n=e.name)&&void 0!==n?n:"",l.emptyTimeout=null!==(r=e.emptyTimeout)&&void 0!==r?r:0,l.maxParticipants=null!==(o=e.maxParticipants)&&void 0!==o?o:0,l.creationTime=null!==(s=e.creationTime)&&void 0!==s?s:0,l.turnPassword=null!==(a=e.turnPassword)&&void 0!==a?a:"",l.enabledCodecs=[],void 0!==e.enabledCodecs&&null!==e.enabledCodecs)for(const p of e.enabledCodecs)l.enabledCodecs.push(t.Codec.fromPartial(p));return l.metadata=null!==(c=e.metadata)&&void 0!==c?c:"",l.numParticipants=null!==(d=e.numParticipants)&&void 0!==d?d:0,l.activeRecording=null!==(u=e.activeRecording)&&void 0!==u&&u,l}};const E={mime:"",fmtpLine:""};t.Codec={encode:(e,t=o.default.Writer.create())=>(""!==e.mime&&t.uint32(10).string(e.mime),""!==e.fmtpLine&&t.uint32(18).string(e.fmtpLine),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},E);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.mime=i.string();break;case 2:r.fmtpLine=i.string();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},E);return void 0!==e.mime&&null!==e.mime?t.mime=String(e.mime):t.mime="",void 0!==e.fmtpLine&&null!==e.fmtpLine?t.fmtpLine=String(e.fmtpLine):t.fmtpLine="",t},toJSON(e){const t={};return void 0!==e.mime&&(t.mime=e.mime),void 0!==e.fmtpLine&&(t.fmtpLine=e.fmtpLine),t},fromPartial(e){var t,i;const n=Object.assign({},E);return n.mime=null!==(t=e.mime)&&void 0!==t?t:"",n.fmtpLine=null!==(i=e.fmtpLine)&&void 0!==i?i:"",n}};const O={sid:"",identity:"",state:0,metadata:"",joinedAt:0,hidden:!1,recorder:!1,name:""};t.ParticipantInfo={encode(e,i=o.default.Writer.create()){""!==e.sid&&i.uint32(10).string(e.sid),""!==e.identity&&i.uint32(18).string(e.identity),0!==e.state&&i.uint32(24).int32(e.state);for(const n of e.tracks)t.TrackInfo.encode(n,i.uint32(34).fork()).ldelim();return""!==e.metadata&&i.uint32(42).string(e.metadata),0!==e.joinedAt&&i.uint32(48).int64(e.joinedAt),!0===e.hidden&&i.uint32(56).bool(e.hidden),!0===e.recorder&&i.uint32(64).bool(e.recorder),""!==e.name&&i.uint32(74).string(e.name),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},O);for(s.tracks=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.sid=n.string();break;case 2:s.identity=n.string();break;case 3:s.state=n.int32();break;case 4:s.tracks.push(t.TrackInfo.decode(n,n.uint32()));break;case 5:s.metadata=n.string();break;case 6:s.joinedAt=J(n.int64());break;case 7:s.hidden=n.bool();break;case 8:s.recorder=n.bool();break;case 9:s.name=n.string();break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},O);if(i.tracks=[],void 0!==e.sid&&null!==e.sid?i.sid=String(e.sid):i.sid="",void 0!==e.identity&&null!==e.identity?i.identity=String(e.identity):i.identity="",void 0!==e.state&&null!==e.state?i.state=k(e.state):i.state=0,void 0!==e.tracks&&null!==e.tracks)for(const n of e.tracks)i.tracks.push(t.TrackInfo.fromJSON(n));return void 0!==e.metadata&&null!==e.metadata?i.metadata=String(e.metadata):i.metadata="",void 0!==e.joinedAt&&null!==e.joinedAt?i.joinedAt=Number(e.joinedAt):i.joinedAt=0,void 0!==e.hidden&&null!==e.hidden?i.hidden=Boolean(e.hidden):i.hidden=!1,void 0!==e.recorder&&null!==e.recorder?i.recorder=Boolean(e.recorder):i.recorder=!1,void 0!==e.name&&null!==e.name?i.name=String(e.name):i.name="",i},toJSON(e){const i={};return void 0!==e.sid&&(i.sid=e.sid),void 0!==e.identity&&(i.identity=e.identity),void 0!==e.state&&(i.state=S(e.state)),e.tracks?i.tracks=e.tracks.map((e=>e?t.TrackInfo.toJSON(e):void 0)):i.tracks=[],void 0!==e.metadata&&(i.metadata=e.metadata),void 0!==e.joinedAt&&(i.joinedAt=e.joinedAt),void 0!==e.hidden&&(i.hidden=e.hidden),void 0!==e.recorder&&(i.recorder=e.recorder),void 0!==e.name&&(i.name=e.name),i},fromPartial(e){var i,n,r,o,s,a,c,d;const u=Object.assign({},O);if(u.sid=null!==(i=e.sid)&&void 0!==i?i:"",u.identity=null!==(n=e.identity)&&void 0!==n?n:"",u.state=null!==(r=e.state)&&void 0!==r?r:0,u.tracks=[],void 0!==e.tracks&&null!==e.tracks)for(const l of e.tracks)u.tracks.push(t.TrackInfo.fromPartial(l));return u.metadata=null!==(o=e.metadata)&&void 0!==o?o:"",u.joinedAt=null!==(s=e.joinedAt)&&void 0!==s?s:0,u.hidden=null!==(a=e.hidden)&&void 0!==a&&a,u.recorder=null!==(c=e.recorder)&&void 0!==c&&c,u.name=null!==(d=e.name)&&void 0!==d?d:"",u}};const R={sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,mimeType:"",mid:""};t.TrackInfo={encode(e,i=o.default.Writer.create()){""!==e.sid&&i.uint32(10).string(e.sid),0!==e.type&&i.uint32(16).int32(e.type),""!==e.name&&i.uint32(26).string(e.name),!0===e.muted&&i.uint32(32).bool(e.muted),0!==e.width&&i.uint32(40).uint32(e.width),0!==e.height&&i.uint32(48).uint32(e.height),!0===e.simulcast&&i.uint32(56).bool(e.simulcast),!0===e.disableDtx&&i.uint32(64).bool(e.disableDtx),0!==e.source&&i.uint32(72).int32(e.source);for(const n of e.layers)t.VideoLayer.encode(n,i.uint32(82).fork()).ldelim();return""!==e.mimeType&&i.uint32(90).string(e.mimeType),""!==e.mid&&i.uint32(98).string(e.mid),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},R);for(s.layers=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.sid=n.string();break;case 2:s.type=n.int32();break;case 3:s.name=n.string();break;case 4:s.muted=n.bool();break;case 5:s.width=n.uint32();break;case 6:s.height=n.uint32();break;case 7:s.simulcast=n.bool();break;case 8:s.disableDtx=n.bool();break;case 9:s.source=n.int32();break;case 10:s.layers.push(t.VideoLayer.decode(n,n.uint32()));break;case 11:s.mimeType=n.string();break;case 12:s.mid=n.string();break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},R);if(i.layers=[],void 0!==e.sid&&null!==e.sid?i.sid=String(e.sid):i.sid="",void 0!==e.type&&null!==e.type?i.type=h(e.type):i.type=0,void 0!==e.name&&null!==e.name?i.name=String(e.name):i.name="",void 0!==e.muted&&null!==e.muted?i.muted=Boolean(e.muted):i.muted=!1,void 0!==e.width&&null!==e.width?i.width=Number(e.width):i.width=0,void 0!==e.height&&null!==e.height?i.height=Number(e.height):i.height=0,void 0!==e.simulcast&&null!==e.simulcast?i.simulcast=Boolean(e.simulcast):i.simulcast=!1,void 0!==e.disableDtx&&null!==e.disableDtx?i.disableDtx=Boolean(e.disableDtx):i.disableDtx=!1,void 0!==e.source&&null!==e.source?i.source=m(e.source):i.source=0,void 0!==e.layers&&null!==e.layers)for(const n of e.layers)i.layers.push(t.VideoLayer.fromJSON(n));return void 0!==e.mimeType&&null!==e.mimeType?i.mimeType=String(e.mimeType):i.mimeType="",void 0!==e.mid&&null!==e.mid?i.mid=String(e.mid):i.mid="",i},toJSON(e){const i={};return void 0!==e.sid&&(i.sid=e.sid),void 0!==e.type&&(i.type=f(e.type)),void 0!==e.name&&(i.name=e.name),void 0!==e.muted&&(i.muted=e.muted),void 0!==e.width&&(i.width=e.width),void 0!==e.height&&(i.height=e.height),void 0!==e.simulcast&&(i.simulcast=e.simulcast),void 0!==e.disableDtx&&(i.disableDtx=e.disableDtx),void 0!==e.source&&(i.source=v(e.source)),e.layers?i.layers=e.layers.map((e=>e?t.VideoLayer.toJSON(e):void 0)):i.layers=[],void 0!==e.mimeType&&(i.mimeType=e.mimeType),void 0!==e.mid&&(i.mid=e.mid),i},fromPartial(e){var i,n,r,o,s,a,c,d,u,l,p;const h=Object.assign({},R);if(h.sid=null!==(i=e.sid)&&void 0!==i?i:"",h.type=null!==(n=e.type)&&void 0!==n?n:0,h.name=null!==(r=e.name)&&void 0!==r?r:"",h.muted=null!==(o=e.muted)&&void 0!==o&&o,h.width=null!==(s=e.width)&&void 0!==s?s:0,h.height=null!==(a=e.height)&&void 0!==a?a:0,h.simulcast=null!==(c=e.simulcast)&&void 0!==c&&c,h.disableDtx=null!==(d=e.disableDtx)&&void 0!==d&&d,h.source=null!==(u=e.source)&&void 0!==u?u:0,h.layers=[],void 0!==e.layers&&null!==e.layers)for(const f of e.layers)h.layers.push(t.VideoLayer.fromPartial(f));return h.mimeType=null!==(l=e.mimeType)&&void 0!==l?l:"",h.mid=null!==(p=e.mid)&&void 0!==p?p:"",h}};const _={quality:0,width:0,height:0,bitrate:0,ssrc:0};t.VideoLayer={encode:(e,t=o.default.Writer.create())=>(0!==e.quality&&t.uint32(8).int32(e.quality),0!==e.width&&t.uint32(16).uint32(e.width),0!==e.height&&t.uint32(24).uint32(e.height),0!==e.bitrate&&t.uint32(32).uint32(e.bitrate),0!==e.ssrc&&t.uint32(40).uint32(e.ssrc),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},_);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.quality=i.int32();break;case 2:r.width=i.uint32();break;case 3:r.height=i.uint32();break;case 4:r.bitrate=i.uint32();break;case 5:r.ssrc=i.uint32();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},_);return void 0!==e.quality&&null!==e.quality?t.quality=b(e.quality):t.quality=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,void 0!==e.bitrate&&null!==e.bitrate?t.bitrate=Number(e.bitrate):t.bitrate=0,void 0!==e.ssrc&&null!==e.ssrc?t.ssrc=Number(e.ssrc):t.ssrc=0,t},toJSON(e){const t={};return void 0!==e.quality&&(t.quality=g(e.quality)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.bitrate&&(t.bitrate=e.bitrate),void 0!==e.ssrc&&(t.ssrc=e.ssrc),t},fromPartial(e){var t,i,n,r,o;const s=Object.assign({},_);return s.quality=null!==(t=e.quality)&&void 0!==t?t:0,s.width=null!==(i=e.width)&&void 0!==i?i:0,s.height=null!==(n=e.height)&&void 0!==n?n:0,s.bitrate=null!==(r=e.bitrate)&&void 0!==r?r:0,s.ssrc=null!==(o=e.ssrc)&&void 0!==o?o:0,s}};const N={kind:0};t.DataPacket={encode:(e,i=o.default.Writer.create())=>(0!==e.kind&&i.uint32(8).int32(e.kind),void 0!==e.user&&t.UserPacket.encode(e.user,i.uint32(18).fork()).ldelim(),void 0!==e.speaker&&t.ActiveSpeakerUpdate.encode(e.speaker,i.uint32(26).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},N);for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.kind=n.int32();break;case 2:s.user=t.UserPacket.decode(n,n.uint32());break;case 3:s.speaker=t.ActiveSpeakerUpdate.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},N);return void 0!==e.kind&&null!==e.kind?i.kind=y(e.kind):i.kind=0,void 0!==e.user&&null!==e.user?i.user=t.UserPacket.fromJSON(e.user):i.user=void 0,void 0!==e.speaker&&null!==e.speaker?i.speaker=t.ActiveSpeakerUpdate.fromJSON(e.speaker):i.speaker=void 0,i},toJSON(e){const i={};return void 0!==e.kind&&(i.kind=w(e.kind)),void 0!==e.user&&(i.user=e.user?t.UserPacket.toJSON(e.user):void 0),void 0!==e.speaker&&(i.speaker=e.speaker?t.ActiveSpeakerUpdate.toJSON(e.speaker):void 0),i},fromPartial(e){var i;const n=Object.assign({},N);return n.kind=null!==(i=e.kind)&&void 0!==i?i:0,void 0!==e.user&&null!==e.user?n.user=t.UserPacket.fromPartial(e.user):n.user=void 0,void 0!==e.speaker&&null!==e.speaker?n.speaker=t.ActiveSpeakerUpdate.fromPartial(e.speaker):n.speaker=void 0,n}};const D={};t.ActiveSpeakerUpdate={encode(e,i=o.default.Writer.create()){for(const n of e.speakers)t.SpeakerInfo.encode(n,i.uint32(10).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},D);for(s.speakers=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.speakers.push(t.SpeakerInfo.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},D);if(i.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const n of e.speakers)i.speakers.push(t.SpeakerInfo.fromJSON(n));return i},toJSON(e){const i={};return e.speakers?i.speakers=e.speakers.map((e=>e?t.SpeakerInfo.toJSON(e):void 0)):i.speakers=[],i},fromPartial(e){const i=Object.assign({},D);if(i.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const n of e.speakers)i.speakers.push(t.SpeakerInfo.fromPartial(n));return i}};const U={sid:"",level:0,active:!1};t.SpeakerInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),0!==e.level&&t.uint32(21).float(e.level),!0===e.active&&t.uint32(24).bool(e.active),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},U);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sid=i.string();break;case 2:r.level=i.float();break;case 3:r.active=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},U);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.level&&null!==e.level?t.level=Number(e.level):t.level=0,void 0!==e.active&&null!==e.active?t.active=Boolean(e.active):t.active=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.level&&(t.level=e.level),void 0!==e.active&&(t.active=e.active),t},fromPartial(e){var t,i,n;const r=Object.assign({},U);return r.sid=null!==(t=e.sid)&&void 0!==t?t:"",r.level=null!==(i=e.level)&&void 0!==i?i:0,r.active=null!==(n=e.active)&&void 0!==n&&n,r}};const I={participantSid:"",destinationSids:""};t.UserPacket={encode(e,t=o.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.payload.length&&t.uint32(18).bytes(e.payload);for(const i of e.destinationSids)t.uint32(26).string(i);return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},I);for(r.destinationSids=[],r.payload=new Uint8Array;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.payload=i.bytes();break;case 3:r.destinationSids.push(i.string());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},I);if(t.destinationSids=[],t.payload=new Uint8Array,void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.payload&&null!==e.payload&&(t.payload=function(e){const t=A(e),i=new Uint8Array(t.length);for(let n=0;n<t.length;++n)i[n]=t.charCodeAt(n);return i}(e.payload)),void 0!==e.destinationSids&&null!==e.destinationSids)for(const i of e.destinationSids)t.destinationSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.payload&&(t.payload=function(e){const t=[];for(const i of e)t.push(String.fromCharCode(i));return j(t.join(""))}(void 0!==e.payload?e.payload:new Uint8Array)),e.destinationSids?t.destinationSids=e.destinationSids.map((e=>e)):t.destinationSids=[],t},fromPartial(e){var t,i;const n=Object.assign({},I);if(n.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",n.payload=null!==(i=e.payload)&&void 0!==i?i:new Uint8Array,n.destinationSids=[],void 0!==e.destinationSids&&null!==e.destinationSids)for(const r of e.destinationSids)n.destinationSids.push(r);return n}};const M={participantSid:"",trackSids:""};t.ParticipantTracks={encode(e,t=o.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid);for(const i of e.trackSids)t.uint32(18).string(i);return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},M);for(r.trackSids=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.trackSids.push(i.string());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},M);if(t.trackSids=[],void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],t},fromPartial(e){var t;const i=Object.assign({},M);if(i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const n of e.trackSids)i.trackSids.push(n);return i}};const L={sdk:0,version:"",protocol:0,os:"",osVersion:"",deviceModel:"",browser:"",browserVersion:""};t.ClientInfo={encode:(e,t=o.default.Writer.create())=>(0!==e.sdk&&t.uint32(8).int32(e.sdk),""!==e.version&&t.uint32(18).string(e.version),0!==e.protocol&&t.uint32(24).int32(e.protocol),""!==e.os&&t.uint32(34).string(e.os),""!==e.osVersion&&t.uint32(42).string(e.osVersion),""!==e.deviceModel&&t.uint32(50).string(e.deviceModel),""!==e.browser&&t.uint32(58).string(e.browser),""!==e.browserVersion&&t.uint32(66).string(e.browserVersion),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},L);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sdk=i.int32();break;case 2:r.version=i.string();break;case 3:r.protocol=i.int32();break;case 4:r.os=i.string();break;case 5:r.osVersion=i.string();break;case 6:r.deviceModel=i.string();break;case 7:r.browser=i.string();break;case 8:r.browserVersion=i.string();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},L);return void 0!==e.sdk&&null!==e.sdk?t.sdk=T(e.sdk):t.sdk=0,void 0!==e.version&&null!==e.version?t.version=String(e.version):t.version="",void 0!==e.protocol&&null!==e.protocol?t.protocol=Number(e.protocol):t.protocol=0,void 0!==e.os&&null!==e.os?t.os=String(e.os):t.os="",void 0!==e.osVersion&&null!==e.osVersion?t.osVersion=String(e.osVersion):t.osVersion="",void 0!==e.deviceModel&&null!==e.deviceModel?t.deviceModel=String(e.deviceModel):t.deviceModel="",void 0!==e.browser&&null!==e.browser?t.browser=String(e.browser):t.browser="",void 0!==e.browserVersion&&null!==e.browserVersion?t.browserVersion=String(e.browserVersion):t.browserVersion="",t},toJSON(e){const t={};return void 0!==e.sdk&&(t.sdk=P(e.sdk)),void 0!==e.version&&(t.version=e.version),void 0!==e.protocol&&(t.protocol=e.protocol),void 0!==e.os&&(t.os=e.os),void 0!==e.osVersion&&(t.osVersion=e.osVersion),void 0!==e.deviceModel&&(t.deviceModel=e.deviceModel),void 0!==e.browser&&(t.browser=e.browser),void 0!==e.browserVersion&&(t.browserVersion=e.browserVersion),t},fromPartial(e){var t,i,n,r,o,s,a,c;const d=Object.assign({},L);return d.sdk=null!==(t=e.sdk)&&void 0!==t?t:0,d.version=null!==(i=e.version)&&void 0!==i?i:"",d.protocol=null!==(n=e.protocol)&&void 0!==n?n:0,d.os=null!==(r=e.os)&&void 0!==r?r:"",d.osVersion=null!==(o=e.osVersion)&&void 0!==o?o:"",d.deviceModel=null!==(s=e.deviceModel)&&void 0!==s?s:"",d.browser=null!==(a=e.browser)&&void 0!==a?a:"",d.browserVersion=null!==(c=e.browserVersion)&&void 0!==c?c:"",d}};var x=(()=>{if("undefined"!==typeof x)return x;if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof i.g)return i.g;throw"Unable to locate global object"})();const A=x.atob||(e=>x.Buffer.from(e,"base64").toString("binary"));const j=x.btoa||(e=>x.Buffer.from(e,"binary").toString("base64"));function J(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new x.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}o.default.util.Long!==r.default&&(o.default.util.Long=r.default,o.default.configure())},44658:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimulateScenario=t.SyncState=t.SubscriptionPermissionUpdate=t.UpdateSubscriptionPermissions=t.TrackPermission=t.SubscribedQualityUpdate=t.SubscribedQuality=t.StreamStateUpdate=t.StreamStateInfo=t.ConnectionQualityUpdate=t.ConnectionQualityInfo=t.RoomUpdate=t.SpeakersChanged=t.ICEServer=t.UpdateVideoLayers=t.LeaveRequest=t.UpdateTrackSettings=t.UpdateSubscription=t.ParticipantUpdate=t.SessionDescription=t.TrackPublishedResponse=t.JoinResponse=t.MuteTrackRequest=t.TrickleRequest=t.AddTrackRequest=t.SignalResponse=t.SignalRequest=t.streamStateToJSON=t.streamStateFromJSON=t.StreamState=t.signalTargetToJSON=t.signalTargetFromJSON=t.SignalTarget=t.protobufPackage=void 0;const r=n(i(43720)),o=n(i(62100)),s=i(8983);var a,c;function d(e){switch(e){case 0:case"PUBLISHER":return a.PUBLISHER;case 1:case"SUBSCRIBER":return a.SUBSCRIBER;case-1:case"UNRECOGNIZED":default:return a.UNRECOGNIZED}}function u(e){switch(e){case a.PUBLISHER:return"PUBLISHER";case a.SUBSCRIBER:return"SUBSCRIBER";default:return"UNKNOWN"}}function l(e){switch(e){case 0:case"ACTIVE":return c.ACTIVE;case 1:case"PAUSED":return c.PAUSED;case-1:case"UNRECOGNIZED":default:return c.UNRECOGNIZED}}function p(e){switch(e){case c.ACTIVE:return"ACTIVE";case c.PAUSED:return"PAUSED";default:return"UNKNOWN"}}t.protobufPackage="livekit",function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(a=t.SignalTarget||(t.SignalTarget={})),t.signalTargetFromJSON=d,t.signalTargetToJSON=u,function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(c=t.StreamState||(t.StreamState={})),t.streamStateFromJSON=l,t.streamStateToJSON=p;const h={};t.SignalRequest={encode:(e,i=o.default.Writer.create())=>(void 0!==e.offer&&t.SessionDescription.encode(e.offer,i.uint32(10).fork()).ldelim(),void 0!==e.answer&&t.SessionDescription.encode(e.answer,i.uint32(18).fork()).ldelim(),void 0!==e.trickle&&t.TrickleRequest.encode(e.trickle,i.uint32(26).fork()).ldelim(),void 0!==e.addTrack&&t.AddTrackRequest.encode(e.addTrack,i.uint32(34).fork()).ldelim(),void 0!==e.mute&&t.MuteTrackRequest.encode(e.mute,i.uint32(42).fork()).ldelim(),void 0!==e.subscription&&t.UpdateSubscription.encode(e.subscription,i.uint32(50).fork()).ldelim(),void 0!==e.trackSetting&&t.UpdateTrackSettings.encode(e.trackSetting,i.uint32(58).fork()).ldelim(),void 0!==e.leave&&t.LeaveRequest.encode(e.leave,i.uint32(66).fork()).ldelim(),void 0!==e.updateLayers&&t.UpdateVideoLayers.encode(e.updateLayers,i.uint32(82).fork()).ldelim(),void 0!==e.subscriptionPermissions&&t.UpdateSubscriptionPermissions.encode(e.subscriptionPermissions,i.uint32(90).fork()).ldelim(),void 0!==e.syncState&&t.SyncState.encode(e.syncState,i.uint32(98).fork()).ldelim(),void 0!==e.simulate&&t.SimulateScenario.encode(e.simulate,i.uint32(106).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},h);for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.offer=t.SessionDescription.decode(n,n.uint32());break;case 2:s.answer=t.SessionDescription.decode(n,n.uint32());break;case 3:s.trickle=t.TrickleRequest.decode(n,n.uint32());break;case 4:s.addTrack=t.AddTrackRequest.decode(n,n.uint32());break;case 5:s.mute=t.MuteTrackRequest.decode(n,n.uint32());break;case 6:s.subscription=t.UpdateSubscription.decode(n,n.uint32());break;case 7:s.trackSetting=t.UpdateTrackSettings.decode(n,n.uint32());break;case 8:s.leave=t.LeaveRequest.decode(n,n.uint32());break;case 10:s.updateLayers=t.UpdateVideoLayers.decode(n,n.uint32());break;case 11:s.subscriptionPermissions=t.UpdateSubscriptionPermissions.decode(n,n.uint32());break;case 12:s.syncState=t.SyncState.decode(n,n.uint32());break;case 13:s.simulate=t.SimulateScenario.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},h);return void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromJSON(e.offer):i.offer=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromJSON(e.answer):i.answer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromJSON(e.trickle):i.trickle=void 0,void 0!==e.addTrack&&null!==e.addTrack?i.addTrack=t.AddTrackRequest.fromJSON(e.addTrack):i.addTrack=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromJSON(e.mute):i.mute=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromJSON(e.subscription):i.subscription=void 0,void 0!==e.trackSetting&&null!==e.trackSetting?i.trackSetting=t.UpdateTrackSettings.fromJSON(e.trackSetting):i.trackSetting=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromJSON(e.leave):i.leave=void 0,void 0!==e.updateLayers&&null!==e.updateLayers?i.updateLayers=t.UpdateVideoLayers.fromJSON(e.updateLayers):i.updateLayers=void 0,void 0!==e.subscriptionPermissions&&null!==e.subscriptionPermissions?i.subscriptionPermissions=t.UpdateSubscriptionPermissions.fromJSON(e.subscriptionPermissions):i.subscriptionPermissions=void 0,void 0!==e.syncState&&null!==e.syncState?i.syncState=t.SyncState.fromJSON(e.syncState):i.syncState=void 0,void 0!==e.simulate&&null!==e.simulate?i.simulate=t.SimulateScenario.fromJSON(e.simulate):i.simulate=void 0,i},toJSON(e){const i={};return void 0!==e.offer&&(i.offer=e.offer?t.SessionDescription.toJSON(e.offer):void 0),void 0!==e.answer&&(i.answer=e.answer?t.SessionDescription.toJSON(e.answer):void 0),void 0!==e.trickle&&(i.trickle=e.trickle?t.TrickleRequest.toJSON(e.trickle):void 0),void 0!==e.addTrack&&(i.addTrack=e.addTrack?t.AddTrackRequest.toJSON(e.addTrack):void 0),void 0!==e.mute&&(i.mute=e.mute?t.MuteTrackRequest.toJSON(e.mute):void 0),void 0!==e.subscription&&(i.subscription=e.subscription?t.UpdateSubscription.toJSON(e.subscription):void 0),void 0!==e.trackSetting&&(i.trackSetting=e.trackSetting?t.UpdateTrackSettings.toJSON(e.trackSetting):void 0),void 0!==e.leave&&(i.leave=e.leave?t.LeaveRequest.toJSON(e.leave):void 0),void 0!==e.updateLayers&&(i.updateLayers=e.updateLayers?t.UpdateVideoLayers.toJSON(e.updateLayers):void 0),void 0!==e.subscriptionPermissions&&(i.subscriptionPermissions=e.subscriptionPermissions?t.UpdateSubscriptionPermissions.toJSON(e.subscriptionPermissions):void 0),void 0!==e.syncState&&(i.syncState=e.syncState?t.SyncState.toJSON(e.syncState):void 0),void 0!==e.simulate&&(i.simulate=e.simulate?t.SimulateScenario.toJSON(e.simulate):void 0),i},fromPartial(e){const i=Object.assign({},h);return void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromPartial(e.offer):i.offer=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromPartial(e.answer):i.answer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromPartial(e.trickle):i.trickle=void 0,void 0!==e.addTrack&&null!==e.addTrack?i.addTrack=t.AddTrackRequest.fromPartial(e.addTrack):i.addTrack=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromPartial(e.mute):i.mute=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromPartial(e.subscription):i.subscription=void 0,void 0!==e.trackSetting&&null!==e.trackSetting?i.trackSetting=t.UpdateTrackSettings.fromPartial(e.trackSetting):i.trackSetting=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromPartial(e.leave):i.leave=void 0,void 0!==e.updateLayers&&null!==e.updateLayers?i.updateLayers=t.UpdateVideoLayers.fromPartial(e.updateLayers):i.updateLayers=void 0,void 0!==e.subscriptionPermissions&&null!==e.subscriptionPermissions?i.subscriptionPermissions=t.UpdateSubscriptionPermissions.fromPartial(e.subscriptionPermissions):i.subscriptionPermissions=void 0,void 0!==e.syncState&&null!==e.syncState?i.syncState=t.SyncState.fromPartial(e.syncState):i.syncState=void 0,void 0!==e.simulate&&null!==e.simulate?i.simulate=t.SimulateScenario.fromPartial(e.simulate):i.simulate=void 0,i}};const f={};t.SignalResponse={encode:(e,i=o.default.Writer.create())=>(void 0!==e.join&&t.JoinResponse.encode(e.join,i.uint32(10).fork()).ldelim(),void 0!==e.answer&&t.SessionDescription.encode(e.answer,i.uint32(18).fork()).ldelim(),void 0!==e.offer&&t.SessionDescription.encode(e.offer,i.uint32(26).fork()).ldelim(),void 0!==e.trickle&&t.TrickleRequest.encode(e.trickle,i.uint32(34).fork()).ldelim(),void 0!==e.update&&t.ParticipantUpdate.encode(e.update,i.uint32(42).fork()).ldelim(),void 0!==e.trackPublished&&t.TrackPublishedResponse.encode(e.trackPublished,i.uint32(50).fork()).ldelim(),void 0!==e.leave&&t.LeaveRequest.encode(e.leave,i.uint32(66).fork()).ldelim(),void 0!==e.mute&&t.MuteTrackRequest.encode(e.mute,i.uint32(74).fork()).ldelim(),void 0!==e.speakersChanged&&t.SpeakersChanged.encode(e.speakersChanged,i.uint32(82).fork()).ldelim(),void 0!==e.roomUpdate&&t.RoomUpdate.encode(e.roomUpdate,i.uint32(90).fork()).ldelim(),void 0!==e.connectionQuality&&t.ConnectionQualityUpdate.encode(e.connectionQuality,i.uint32(98).fork()).ldelim(),void 0!==e.streamStateUpdate&&t.StreamStateUpdate.encode(e.streamStateUpdate,i.uint32(106).fork()).ldelim(),void 0!==e.subscribedQualityUpdate&&t.SubscribedQualityUpdate.encode(e.subscribedQualityUpdate,i.uint32(114).fork()).ldelim(),void 0!==e.subscriptionPermissionUpdate&&t.SubscriptionPermissionUpdate.encode(e.subscriptionPermissionUpdate,i.uint32(122).fork()).ldelim(),i),decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},f);for(;n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.join=t.JoinResponse.decode(n,n.uint32());break;case 2:s.answer=t.SessionDescription.decode(n,n.uint32());break;case 3:s.offer=t.SessionDescription.decode(n,n.uint32());break;case 4:s.trickle=t.TrickleRequest.decode(n,n.uint32());break;case 5:s.update=t.ParticipantUpdate.decode(n,n.uint32());break;case 6:s.trackPublished=t.TrackPublishedResponse.decode(n,n.uint32());break;case 8:s.leave=t.LeaveRequest.decode(n,n.uint32());break;case 9:s.mute=t.MuteTrackRequest.decode(n,n.uint32());break;case 10:s.speakersChanged=t.SpeakersChanged.decode(n,n.uint32());break;case 11:s.roomUpdate=t.RoomUpdate.decode(n,n.uint32());break;case 12:s.connectionQuality=t.ConnectionQualityUpdate.decode(n,n.uint32());break;case 13:s.streamStateUpdate=t.StreamStateUpdate.decode(n,n.uint32());break;case 14:s.subscribedQualityUpdate=t.SubscribedQualityUpdate.decode(n,n.uint32());break;case 15:s.subscriptionPermissionUpdate=t.SubscriptionPermissionUpdate.decode(n,n.uint32());break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},f);return void 0!==e.join&&null!==e.join?i.join=t.JoinResponse.fromJSON(e.join):i.join=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromJSON(e.answer):i.answer=void 0,void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromJSON(e.offer):i.offer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromJSON(e.trickle):i.trickle=void 0,void 0!==e.update&&null!==e.update?i.update=t.ParticipantUpdate.fromJSON(e.update):i.update=void 0,void 0!==e.trackPublished&&null!==e.trackPublished?i.trackPublished=t.TrackPublishedResponse.fromJSON(e.trackPublished):i.trackPublished=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromJSON(e.leave):i.leave=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromJSON(e.mute):i.mute=void 0,void 0!==e.speakersChanged&&null!==e.speakersChanged?i.speakersChanged=t.SpeakersChanged.fromJSON(e.speakersChanged):i.speakersChanged=void 0,void 0!==e.roomUpdate&&null!==e.roomUpdate?i.roomUpdate=t.RoomUpdate.fromJSON(e.roomUpdate):i.roomUpdate=void 0,void 0!==e.connectionQuality&&null!==e.connectionQuality?i.connectionQuality=t.ConnectionQualityUpdate.fromJSON(e.connectionQuality):i.connectionQuality=void 0,void 0!==e.streamStateUpdate&&null!==e.streamStateUpdate?i.streamStateUpdate=t.StreamStateUpdate.fromJSON(e.streamStateUpdate):i.streamStateUpdate=void 0,void 0!==e.subscribedQualityUpdate&&null!==e.subscribedQualityUpdate?i.subscribedQualityUpdate=t.SubscribedQualityUpdate.fromJSON(e.subscribedQualityUpdate):i.subscribedQualityUpdate=void 0,void 0!==e.subscriptionPermissionUpdate&&null!==e.subscriptionPermissionUpdate?i.subscriptionPermissionUpdate=t.SubscriptionPermissionUpdate.fromJSON(e.subscriptionPermissionUpdate):i.subscriptionPermissionUpdate=void 0,i},toJSON(e){const i={};return void 0!==e.join&&(i.join=e.join?t.JoinResponse.toJSON(e.join):void 0),void 0!==e.answer&&(i.answer=e.answer?t.SessionDescription.toJSON(e.answer):void 0),void 0!==e.offer&&(i.offer=e.offer?t.SessionDescription.toJSON(e.offer):void 0),void 0!==e.trickle&&(i.trickle=e.trickle?t.TrickleRequest.toJSON(e.trickle):void 0),void 0!==e.update&&(i.update=e.update?t.ParticipantUpdate.toJSON(e.update):void 0),void 0!==e.trackPublished&&(i.trackPublished=e.trackPublished?t.TrackPublishedResponse.toJSON(e.trackPublished):void 0),void 0!==e.leave&&(i.leave=e.leave?t.LeaveRequest.toJSON(e.leave):void 0),void 0!==e.mute&&(i.mute=e.mute?t.MuteTrackRequest.toJSON(e.mute):void 0),void 0!==e.speakersChanged&&(i.speakersChanged=e.speakersChanged?t.SpeakersChanged.toJSON(e.speakersChanged):void 0),void 0!==e.roomUpdate&&(i.roomUpdate=e.roomUpdate?t.RoomUpdate.toJSON(e.roomUpdate):void 0),void 0!==e.connectionQuality&&(i.connectionQuality=e.connectionQuality?t.ConnectionQualityUpdate.toJSON(e.connectionQuality):void 0),void 0!==e.streamStateUpdate&&(i.streamStateUpdate=e.streamStateUpdate?t.StreamStateUpdate.toJSON(e.streamStateUpdate):void 0),void 0!==e.subscribedQualityUpdate&&(i.subscribedQualityUpdate=e.subscribedQualityUpdate?t.SubscribedQualityUpdate.toJSON(e.subscribedQualityUpdate):void 0),void 0!==e.subscriptionPermissionUpdate&&(i.subscriptionPermissionUpdate=e.subscriptionPermissionUpdate?t.SubscriptionPermissionUpdate.toJSON(e.subscriptionPermissionUpdate):void 0),i},fromPartial(e){const i=Object.assign({},f);return void 0!==e.join&&null!==e.join?i.join=t.JoinResponse.fromPartial(e.join):i.join=void 0,void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromPartial(e.answer):i.answer=void 0,void 0!==e.offer&&null!==e.offer?i.offer=t.SessionDescription.fromPartial(e.offer):i.offer=void 0,void 0!==e.trickle&&null!==e.trickle?i.trickle=t.TrickleRequest.fromPartial(e.trickle):i.trickle=void 0,void 0!==e.update&&null!==e.update?i.update=t.ParticipantUpdate.fromPartial(e.update):i.update=void 0,void 0!==e.trackPublished&&null!==e.trackPublished?i.trackPublished=t.TrackPublishedResponse.fromPartial(e.trackPublished):i.trackPublished=void 0,void 0!==e.leave&&null!==e.leave?i.leave=t.LeaveRequest.fromPartial(e.leave):i.leave=void 0,void 0!==e.mute&&null!==e.mute?i.mute=t.MuteTrackRequest.fromPartial(e.mute):i.mute=void 0,void 0!==e.speakersChanged&&null!==e.speakersChanged?i.speakersChanged=t.SpeakersChanged.fromPartial(e.speakersChanged):i.speakersChanged=void 0,void 0!==e.roomUpdate&&null!==e.roomUpdate?i.roomUpdate=t.RoomUpdate.fromPartial(e.roomUpdate):i.roomUpdate=void 0,void 0!==e.connectionQuality&&null!==e.connectionQuality?i.connectionQuality=t.ConnectionQualityUpdate.fromPartial(e.connectionQuality):i.connectionQuality=void 0,void 0!==e.streamStateUpdate&&null!==e.streamStateUpdate?i.streamStateUpdate=t.StreamStateUpdate.fromPartial(e.streamStateUpdate):i.streamStateUpdate=void 0,void 0!==e.subscribedQualityUpdate&&null!==e.subscribedQualityUpdate?i.subscribedQualityUpdate=t.SubscribedQualityUpdate.fromPartial(e.subscribedQualityUpdate):i.subscribedQualityUpdate=void 0,void 0!==e.subscriptionPermissionUpdate&&null!==e.subscriptionPermissionUpdate?i.subscriptionPermissionUpdate=t.SubscriptionPermissionUpdate.fromPartial(e.subscriptionPermissionUpdate):i.subscriptionPermissionUpdate=void 0,i}};const m={cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0};t.AddTrackRequest={encode(e,t=o.default.Writer.create()){""!==e.cid&&t.uint32(10).string(e.cid),""!==e.name&&t.uint32(18).string(e.name),0!==e.type&&t.uint32(24).int32(e.type),0!==e.width&&t.uint32(32).uint32(e.width),0!==e.height&&t.uint32(40).uint32(e.height),!0===e.muted&&t.uint32(48).bool(e.muted),!0===e.disableDtx&&t.uint32(56).bool(e.disableDtx),0!==e.source&&t.uint32(64).int32(e.source);for(const i of e.layers)s.VideoLayer.encode(i,t.uint32(74).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},m);for(r.layers=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.cid=i.string();break;case 2:r.name=i.string();break;case 3:r.type=i.int32();break;case 4:r.width=i.uint32();break;case 5:r.height=i.uint32();break;case 6:r.muted=i.bool();break;case 7:r.disableDtx=i.bool();break;case 8:r.source=i.int32();break;case 9:r.layers.push(s.VideoLayer.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},m);if(t.layers=[],void 0!==e.cid&&null!==e.cid?t.cid=String(e.cid):t.cid="",void 0!==e.name&&null!==e.name?t.name=String(e.name):t.name="",void 0!==e.type&&null!==e.type?t.type=s.trackTypeFromJSON(e.type):t.type=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,void 0!==e.disableDtx&&null!==e.disableDtx?t.disableDtx=Boolean(e.disableDtx):t.disableDtx=!1,void 0!==e.source&&null!==e.source?t.source=s.trackSourceFromJSON(e.source):t.source=0,void 0!==e.layers&&null!==e.layers)for(const i of e.layers)t.layers.push(s.VideoLayer.fromJSON(i));return t},toJSON(e){const t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.name&&(t.name=e.name),void 0!==e.type&&(t.type=s.trackTypeToJSON(e.type)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),void 0!==e.muted&&(t.muted=e.muted),void 0!==e.disableDtx&&(t.disableDtx=e.disableDtx),void 0!==e.source&&(t.source=s.trackSourceToJSON(e.source)),e.layers?t.layers=e.layers.map((e=>e?s.VideoLayer.toJSON(e):void 0)):t.layers=[],t},fromPartial(e){var t,i,n,r,o,a,c,d;const u=Object.assign({},m);if(u.cid=null!==(t=e.cid)&&void 0!==t?t:"",u.name=null!==(i=e.name)&&void 0!==i?i:"",u.type=null!==(n=e.type)&&void 0!==n?n:0,u.width=null!==(r=e.width)&&void 0!==r?r:0,u.height=null!==(o=e.height)&&void 0!==o?o:0,u.muted=null!==(a=e.muted)&&void 0!==a&&a,u.disableDtx=null!==(c=e.disableDtx)&&void 0!==c&&c,u.source=null!==(d=e.source)&&void 0!==d?d:0,u.layers=[],void 0!==e.layers&&null!==e.layers)for(const l of e.layers)u.layers.push(s.VideoLayer.fromPartial(l));return u}};const v={candidateInit:"",target:0};t.TrickleRequest={encode:(e,t=o.default.Writer.create())=>(""!==e.candidateInit&&t.uint32(10).string(e.candidateInit),0!==e.target&&t.uint32(16).int32(e.target),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},v);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.candidateInit=i.string();break;case 2:r.target=i.int32();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},v);return void 0!==e.candidateInit&&null!==e.candidateInit?t.candidateInit=String(e.candidateInit):t.candidateInit="",void 0!==e.target&&null!==e.target?t.target=d(e.target):t.target=0,t},toJSON(e){const t={};return void 0!==e.candidateInit&&(t.candidateInit=e.candidateInit),void 0!==e.target&&(t.target=u(e.target)),t},fromPartial(e){var t,i;const n=Object.assign({},v);return n.candidateInit=null!==(t=e.candidateInit)&&void 0!==t?t:"",n.target=null!==(i=e.target)&&void 0!==i?i:0,n}};const b={sid:"",muted:!1};t.MuteTrackRequest={encode:(e,t=o.default.Writer.create())=>(""!==e.sid&&t.uint32(10).string(e.sid),!0===e.muted&&t.uint32(16).bool(e.muted),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},b);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.sid=i.string();break;case 2:r.muted=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},b);return void 0!==e.sid&&null!==e.sid?t.sid=String(e.sid):t.sid="",void 0!==e.muted&&null!==e.muted?t.muted=Boolean(e.muted):t.muted=!1,t},toJSON(e){const t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.muted&&(t.muted=e.muted),t},fromPartial(e){var t,i;const n=Object.assign({},b);return n.sid=null!==(t=e.sid)&&void 0!==t?t:"",n.muted=null!==(i=e.muted)&&void 0!==i&&i,n}};const g={serverVersion:"",subscriberPrimary:!1,alternativeUrl:""};t.JoinResponse={encode(e,i=o.default.Writer.create()){void 0!==e.room&&s.Room.encode(e.room,i.uint32(10).fork()).ldelim(),void 0!==e.participant&&s.ParticipantInfo.encode(e.participant,i.uint32(18).fork()).ldelim();for(const t of e.otherParticipants)s.ParticipantInfo.encode(t,i.uint32(26).fork()).ldelim();""!==e.serverVersion&&i.uint32(34).string(e.serverVersion);for(const n of e.iceServers)t.ICEServer.encode(n,i.uint32(42).fork()).ldelim();return!0===e.subscriberPrimary&&i.uint32(48).bool(e.subscriberPrimary),""!==e.alternativeUrl&&i.uint32(58).string(e.alternativeUrl),i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const a=Object.assign({},g);for(a.otherParticipants=[],a.iceServers=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:a.room=s.Room.decode(n,n.uint32());break;case 2:a.participant=s.ParticipantInfo.decode(n,n.uint32());break;case 3:a.otherParticipants.push(s.ParticipantInfo.decode(n,n.uint32()));break;case 4:a.serverVersion=n.string();break;case 5:a.iceServers.push(t.ICEServer.decode(n,n.uint32()));break;case 6:a.subscriberPrimary=n.bool();break;case 7:a.alternativeUrl=n.string();break;default:n.skipType(7&e)}}return a},fromJSON(e){const i=Object.assign({},g);if(i.otherParticipants=[],i.iceServers=[],void 0!==e.room&&null!==e.room?i.room=s.Room.fromJSON(e.room):i.room=void 0,void 0!==e.participant&&null!==e.participant?i.participant=s.ParticipantInfo.fromJSON(e.participant):i.participant=void 0,void 0!==e.otherParticipants&&null!==e.otherParticipants)for(const t of e.otherParticipants)i.otherParticipants.push(s.ParticipantInfo.fromJSON(t));if(void 0!==e.serverVersion&&null!==e.serverVersion?i.serverVersion=String(e.serverVersion):i.serverVersion="",void 0!==e.iceServers&&null!==e.iceServers)for(const n of e.iceServers)i.iceServers.push(t.ICEServer.fromJSON(n));return void 0!==e.subscriberPrimary&&null!==e.subscriberPrimary?i.subscriberPrimary=Boolean(e.subscriberPrimary):i.subscriberPrimary=!1,void 0!==e.alternativeUrl&&null!==e.alternativeUrl?i.alternativeUrl=String(e.alternativeUrl):i.alternativeUrl="",i},toJSON(e){const i={};return void 0!==e.room&&(i.room=e.room?s.Room.toJSON(e.room):void 0),void 0!==e.participant&&(i.participant=e.participant?s.ParticipantInfo.toJSON(e.participant):void 0),e.otherParticipants?i.otherParticipants=e.otherParticipants.map((e=>e?s.ParticipantInfo.toJSON(e):void 0)):i.otherParticipants=[],void 0!==e.serverVersion&&(i.serverVersion=e.serverVersion),e.iceServers?i.iceServers=e.iceServers.map((e=>e?t.ICEServer.toJSON(e):void 0)):i.iceServers=[],void 0!==e.subscriberPrimary&&(i.subscriberPrimary=e.subscriberPrimary),void 0!==e.alternativeUrl&&(i.alternativeUrl=e.alternativeUrl),i},fromPartial(e){var i,n,r;const o=Object.assign({},g);if(void 0!==e.room&&null!==e.room?o.room=s.Room.fromPartial(e.room):o.room=void 0,void 0!==e.participant&&null!==e.participant?o.participant=s.ParticipantInfo.fromPartial(e.participant):o.participant=void 0,o.otherParticipants=[],void 0!==e.otherParticipants&&null!==e.otherParticipants)for(const t of e.otherParticipants)o.otherParticipants.push(s.ParticipantInfo.fromPartial(t));if(o.serverVersion=null!==(i=e.serverVersion)&&void 0!==i?i:"",o.iceServers=[],void 0!==e.iceServers&&null!==e.iceServers)for(const s of e.iceServers)o.iceServers.push(t.ICEServer.fromPartial(s));return o.subscriberPrimary=null!==(n=e.subscriberPrimary)&&void 0!==n&&n,o.alternativeUrl=null!==(r=e.alternativeUrl)&&void 0!==r?r:"",o}};const k={cid:""};t.TrackPublishedResponse={encode:(e,t=o.default.Writer.create())=>(""!==e.cid&&t.uint32(10).string(e.cid),void 0!==e.track&&s.TrackInfo.encode(e.track,t.uint32(18).fork()).ldelim(),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},k);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.cid=i.string();break;case 2:r.track=s.TrackInfo.decode(i,i.uint32());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},k);return void 0!==e.cid&&null!==e.cid?t.cid=String(e.cid):t.cid="",void 0!==e.track&&null!==e.track?t.track=s.TrackInfo.fromJSON(e.track):t.track=void 0,t},toJSON(e){const t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.track&&(t.track=e.track?s.TrackInfo.toJSON(e.track):void 0),t},fromPartial(e){var t;const i=Object.assign({},k);return i.cid=null!==(t=e.cid)&&void 0!==t?t:"",void 0!==e.track&&null!==e.track?i.track=s.TrackInfo.fromPartial(e.track):i.track=void 0,i}};const S={type:"",sdp:""};t.SessionDescription={encode:(e,t=o.default.Writer.create())=>(""!==e.type&&t.uint32(10).string(e.type),""!==e.sdp&&t.uint32(18).string(e.sdp),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},S);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.type=i.string();break;case 2:r.sdp=i.string();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},S);return void 0!==e.type&&null!==e.type?t.type=String(e.type):t.type="",void 0!==e.sdp&&null!==e.sdp?t.sdp=String(e.sdp):t.sdp="",t},toJSON(e){const t={};return void 0!==e.type&&(t.type=e.type),void 0!==e.sdp&&(t.sdp=e.sdp),t},fromPartial(e){var t,i;const n=Object.assign({},S);return n.type=null!==(t=e.type)&&void 0!==t?t:"",n.sdp=null!==(i=e.sdp)&&void 0!==i?i:"",n}};const y={};t.ParticipantUpdate={encode(e,t=o.default.Writer.create()){for(const i of e.participants)s.ParticipantInfo.encode(i,t.uint32(10).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},y);for(r.participants=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participants.push(s.ParticipantInfo.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},y);if(t.participants=[],void 0!==e.participants&&null!==e.participants)for(const i of e.participants)t.participants.push(s.ParticipantInfo.fromJSON(i));return t},toJSON(e){const t={};return e.participants?t.participants=e.participants.map((e=>e?s.ParticipantInfo.toJSON(e):void 0)):t.participants=[],t},fromPartial(e){const t=Object.assign({},y);if(t.participants=[],void 0!==e.participants&&null!==e.participants)for(const i of e.participants)t.participants.push(s.ParticipantInfo.fromPartial(i));return t}};const w={trackSids:"",subscribe:!1};t.UpdateSubscription={encode(e,t=o.default.Writer.create()){for(const i of e.trackSids)t.uint32(10).string(i);!0===e.subscribe&&t.uint32(16).bool(e.subscribe);for(const i of e.participantTracks)s.ParticipantTracks.encode(i,t.uint32(26).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},w);for(r.trackSids=[],r.participantTracks=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.trackSids.push(i.string());break;case 2:r.subscribe=i.bool();break;case 3:r.participantTracks.push(s.ParticipantTracks.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},w);if(t.trackSids=[],t.participantTracks=[],void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));if(void 0!==e.subscribe&&null!==e.subscribe?t.subscribe=Boolean(e.subscribe):t.subscribe=!1,void 0!==e.participantTracks&&null!==e.participantTracks)for(const i of e.participantTracks)t.participantTracks.push(s.ParticipantTracks.fromJSON(i));return t},toJSON(e){const t={};return e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],void 0!==e.subscribe&&(t.subscribe=e.subscribe),e.participantTracks?t.participantTracks=e.participantTracks.map((e=>e?s.ParticipantTracks.toJSON(e):void 0)):t.participantTracks=[],t},fromPartial(e){var t;const i=Object.assign({},w);if(i.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const n of e.trackSids)i.trackSids.push(n);if(i.subscribe=null!==(t=e.subscribe)&&void 0!==t&&t,i.participantTracks=[],void 0!==e.participantTracks&&null!==e.participantTracks)for(const n of e.participantTracks)i.participantTracks.push(s.ParticipantTracks.fromPartial(n));return i}};const T={trackSids:"",disabled:!1,quality:0,width:0,height:0};t.UpdateTrackSettings={encode(e,t=o.default.Writer.create()){for(const i of e.trackSids)t.uint32(10).string(i);return!0===e.disabled&&t.uint32(24).bool(e.disabled),0!==e.quality&&t.uint32(32).int32(e.quality),0!==e.width&&t.uint32(40).uint32(e.width),0!==e.height&&t.uint32(48).uint32(e.height),t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},T);for(r.trackSids=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.trackSids.push(i.string());break;case 3:r.disabled=i.bool();break;case 4:r.quality=i.int32();break;case 5:r.width=i.uint32();break;case 6:r.height=i.uint32();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},T);if(t.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));return void 0!==e.disabled&&null!==e.disabled?t.disabled=Boolean(e.disabled):t.disabled=!1,void 0!==e.quality&&null!==e.quality?t.quality=s.videoQualityFromJSON(e.quality):t.quality=0,void 0!==e.width&&null!==e.width?t.width=Number(e.width):t.width=0,void 0!==e.height&&null!==e.height?t.height=Number(e.height):t.height=0,t},toJSON(e){const t={};return e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],void 0!==e.disabled&&(t.disabled=e.disabled),void 0!==e.quality&&(t.quality=s.videoQualityToJSON(e.quality)),void 0!==e.width&&(t.width=e.width),void 0!==e.height&&(t.height=e.height),t},fromPartial(e){var t,i,n,r;const o=Object.assign({},T);if(o.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const s of e.trackSids)o.trackSids.push(s);return o.disabled=null!==(t=e.disabled)&&void 0!==t&&t,o.quality=null!==(i=e.quality)&&void 0!==i?i:0,o.width=null!==(n=e.width)&&void 0!==n?n:0,o.height=null!==(r=e.height)&&void 0!==r?r:0,o}};const P={canReconnect:!1};t.LeaveRequest={encode:(e,t=o.default.Writer.create())=>(!0===e.canReconnect&&t.uint32(8).bool(e.canReconnect),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},P);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.canReconnect=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},P);return void 0!==e.canReconnect&&null!==e.canReconnect?t.canReconnect=Boolean(e.canReconnect):t.canReconnect=!1,t},toJSON(e){const t={};return void 0!==e.canReconnect&&(t.canReconnect=e.canReconnect),t},fromPartial(e){var t;const i=Object.assign({},P);return i.canReconnect=null!==(t=e.canReconnect)&&void 0!==t&&t,i}};const C={trackSid:""};t.UpdateVideoLayers={encode(e,t=o.default.Writer.create()){""!==e.trackSid&&t.uint32(10).string(e.trackSid);for(const i of e.layers)s.VideoLayer.encode(i,t.uint32(18).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},C);for(r.layers=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.trackSid=i.string();break;case 2:r.layers.push(s.VideoLayer.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},C);if(t.layers=[],void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",void 0!==e.layers&&null!==e.layers)for(const i of e.layers)t.layers.push(s.VideoLayer.fromJSON(i));return t},toJSON(e){const t={};return void 0!==e.trackSid&&(t.trackSid=e.trackSid),e.layers?t.layers=e.layers.map((e=>e?s.VideoLayer.toJSON(e):void 0)):t.layers=[],t},fromPartial(e){var t;const i=Object.assign({},C);if(i.trackSid=null!==(t=e.trackSid)&&void 0!==t?t:"",i.layers=[],void 0!==e.layers&&null!==e.layers)for(const n of e.layers)i.layers.push(s.VideoLayer.fromPartial(n));return i}};const E={urls:"",username:"",credential:""};t.ICEServer={encode(e,t=o.default.Writer.create()){for(const i of e.urls)t.uint32(10).string(i);return""!==e.username&&t.uint32(18).string(e.username),""!==e.credential&&t.uint32(26).string(e.credential),t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},E);for(r.urls=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.urls.push(i.string());break;case 2:r.username=i.string();break;case 3:r.credential=i.string();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},E);if(t.urls=[],void 0!==e.urls&&null!==e.urls)for(const i of e.urls)t.urls.push(String(i));return void 0!==e.username&&null!==e.username?t.username=String(e.username):t.username="",void 0!==e.credential&&null!==e.credential?t.credential=String(e.credential):t.credential="",t},toJSON(e){const t={};return e.urls?t.urls=e.urls.map((e=>e)):t.urls=[],void 0!==e.username&&(t.username=e.username),void 0!==e.credential&&(t.credential=e.credential),t},fromPartial(e){var t,i;const n=Object.assign({},E);if(n.urls=[],void 0!==e.urls&&null!==e.urls)for(const r of e.urls)n.urls.push(r);return n.username=null!==(t=e.username)&&void 0!==t?t:"",n.credential=null!==(i=e.credential)&&void 0!==i?i:"",n}};const O={};t.SpeakersChanged={encode(e,t=o.default.Writer.create()){for(const i of e.speakers)s.SpeakerInfo.encode(i,t.uint32(10).fork()).ldelim();return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},O);for(r.speakers=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.speakers.push(s.SpeakerInfo.decode(i,i.uint32()));break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},O);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const i of e.speakers)t.speakers.push(s.SpeakerInfo.fromJSON(i));return t},toJSON(e){const t={};return e.speakers?t.speakers=e.speakers.map((e=>e?s.SpeakerInfo.toJSON(e):void 0)):t.speakers=[],t},fromPartial(e){const t=Object.assign({},O);if(t.speakers=[],void 0!==e.speakers&&null!==e.speakers)for(const i of e.speakers)t.speakers.push(s.SpeakerInfo.fromPartial(i));return t}};const R={};t.RoomUpdate={encode:(e,t=o.default.Writer.create())=>(void 0!==e.room&&s.Room.encode(e.room,t.uint32(10).fork()).ldelim(),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},R);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.room=s.Room.decode(i,i.uint32());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},R);return void 0!==e.room&&null!==e.room?t.room=s.Room.fromJSON(e.room):t.room=void 0,t},toJSON(e){const t={};return void 0!==e.room&&(t.room=e.room?s.Room.toJSON(e.room):void 0),t},fromPartial(e){const t=Object.assign({},R);return void 0!==e.room&&null!==e.room?t.room=s.Room.fromPartial(e.room):t.room=void 0,t}};const _={participantSid:"",quality:0,score:0};t.ConnectionQualityInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.quality&&t.uint32(16).int32(e.quality),0!==e.score&&t.uint32(29).float(e.score),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},_);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.quality=i.int32();break;case 3:r.score=i.float();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},_);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.quality&&null!==e.quality?t.quality=s.connectionQualityFromJSON(e.quality):t.quality=0,void 0!==e.score&&null!==e.score?t.score=Number(e.score):t.score=0,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.quality&&(t.quality=s.connectionQualityToJSON(e.quality)),void 0!==e.score&&(t.score=e.score),t},fromPartial(e){var t,i,n;const r=Object.assign({},_);return r.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",r.quality=null!==(i=e.quality)&&void 0!==i?i:0,r.score=null!==(n=e.score)&&void 0!==n?n:0,r}};const N={};t.ConnectionQualityUpdate={encode(e,i=o.default.Writer.create()){for(const n of e.updates)t.ConnectionQualityInfo.encode(n,i.uint32(10).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},N);for(s.updates=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.updates.push(t.ConnectionQualityInfo.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},N);if(i.updates=[],void 0!==e.updates&&null!==e.updates)for(const n of e.updates)i.updates.push(t.ConnectionQualityInfo.fromJSON(n));return i},toJSON(e){const i={};return e.updates?i.updates=e.updates.map((e=>e?t.ConnectionQualityInfo.toJSON(e):void 0)):i.updates=[],i},fromPartial(e){const i=Object.assign({},N);if(i.updates=[],void 0!==e.updates&&null!==e.updates)for(const n of e.updates)i.updates.push(t.ConnectionQualityInfo.fromPartial(n));return i}};const D={participantSid:"",trackSid:"",state:0};t.StreamStateInfo={encode:(e,t=o.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),""!==e.trackSid&&t.uint32(18).string(e.trackSid),0!==e.state&&t.uint32(24).int32(e.state),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},D);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.trackSid=i.string();break;case 3:r.state=i.int32();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},D);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",void 0!==e.state&&null!==e.state?t.state=l(e.state):t.state=0,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.trackSid&&(t.trackSid=e.trackSid),void 0!==e.state&&(t.state=p(e.state)),t},fromPartial(e){var t,i,n;const r=Object.assign({},D);return r.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",r.trackSid=null!==(i=e.trackSid)&&void 0!==i?i:"",r.state=null!==(n=e.state)&&void 0!==n?n:0,r}};const U={};t.StreamStateUpdate={encode(e,i=o.default.Writer.create()){for(const n of e.streamStates)t.StreamStateInfo.encode(n,i.uint32(10).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},U);for(s.streamStates=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.streamStates.push(t.StreamStateInfo.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},U);if(i.streamStates=[],void 0!==e.streamStates&&null!==e.streamStates)for(const n of e.streamStates)i.streamStates.push(t.StreamStateInfo.fromJSON(n));return i},toJSON(e){const i={};return e.streamStates?i.streamStates=e.streamStates.map((e=>e?t.StreamStateInfo.toJSON(e):void 0)):i.streamStates=[],i},fromPartial(e){const i=Object.assign({},U);if(i.streamStates=[],void 0!==e.streamStates&&null!==e.streamStates)for(const n of e.streamStates)i.streamStates.push(t.StreamStateInfo.fromPartial(n));return i}};const I={quality:0,enabled:!1};t.SubscribedQuality={encode:(e,t=o.default.Writer.create())=>(0!==e.quality&&t.uint32(8).int32(e.quality),!0===e.enabled&&t.uint32(16).bool(e.enabled),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},I);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.quality=i.int32();break;case 2:r.enabled=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},I);return void 0!==e.quality&&null!==e.quality?t.quality=s.videoQualityFromJSON(e.quality):t.quality=0,void 0!==e.enabled&&null!==e.enabled?t.enabled=Boolean(e.enabled):t.enabled=!1,t},toJSON(e){const t={};return void 0!==e.quality&&(t.quality=s.videoQualityToJSON(e.quality)),void 0!==e.enabled&&(t.enabled=e.enabled),t},fromPartial(e){var t,i;const n=Object.assign({},I);return n.quality=null!==(t=e.quality)&&void 0!==t?t:0,n.enabled=null!==(i=e.enabled)&&void 0!==i&&i,n}};const M={trackSid:""};t.SubscribedQualityUpdate={encode(e,i=o.default.Writer.create()){""!==e.trackSid&&i.uint32(10).string(e.trackSid);for(const n of e.subscribedQualities)t.SubscribedQuality.encode(n,i.uint32(18).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},M);for(s.subscribedQualities=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.trackSid=n.string();break;case 2:s.subscribedQualities.push(t.SubscribedQuality.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},M);if(i.subscribedQualities=[],void 0!==e.trackSid&&null!==e.trackSid?i.trackSid=String(e.trackSid):i.trackSid="",void 0!==e.subscribedQualities&&null!==e.subscribedQualities)for(const n of e.subscribedQualities)i.subscribedQualities.push(t.SubscribedQuality.fromJSON(n));return i},toJSON(e){const i={};return void 0!==e.trackSid&&(i.trackSid=e.trackSid),e.subscribedQualities?i.subscribedQualities=e.subscribedQualities.map((e=>e?t.SubscribedQuality.toJSON(e):void 0)):i.subscribedQualities=[],i},fromPartial(e){var i;const n=Object.assign({},M);if(n.trackSid=null!==(i=e.trackSid)&&void 0!==i?i:"",n.subscribedQualities=[],void 0!==e.subscribedQualities&&null!==e.subscribedQualities)for(const r of e.subscribedQualities)n.subscribedQualities.push(t.SubscribedQuality.fromPartial(r));return n}};const L={participantSid:"",allTracks:!1,trackSids:""};t.TrackPermission={encode(e,t=o.default.Writer.create()){""!==e.participantSid&&t.uint32(10).string(e.participantSid),!0===e.allTracks&&t.uint32(16).bool(e.allTracks);for(const i of e.trackSids)t.uint32(26).string(i);return t},decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},L);for(r.trackSids=[];i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.allTracks=i.bool();break;case 3:r.trackSids.push(i.string());break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},L);if(t.trackSids=[],void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.allTracks&&null!==e.allTracks?t.allTracks=Boolean(e.allTracks):t.allTracks=!1,void 0!==e.trackSids&&null!==e.trackSids)for(const i of e.trackSids)t.trackSids.push(String(i));return t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.allTracks&&(t.allTracks=e.allTracks),e.trackSids?t.trackSids=e.trackSids.map((e=>e)):t.trackSids=[],t},fromPartial(e){var t,i;const n=Object.assign({},L);if(n.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",n.allTracks=null!==(i=e.allTracks)&&void 0!==i&&i,n.trackSids=[],void 0!==e.trackSids&&null!==e.trackSids)for(const r of e.trackSids)n.trackSids.push(r);return n}};const x={allParticipants:!1};t.UpdateSubscriptionPermissions={encode(e,i=o.default.Writer.create()){!0===e.allParticipants&&i.uint32(8).bool(e.allParticipants);for(const n of e.trackPermissions)t.TrackPermission.encode(n,i.uint32(18).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},x);for(s.trackPermissions=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.allParticipants=n.bool();break;case 2:s.trackPermissions.push(t.TrackPermission.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},x);if(i.trackPermissions=[],void 0!==e.allParticipants&&null!==e.allParticipants?i.allParticipants=Boolean(e.allParticipants):i.allParticipants=!1,void 0!==e.trackPermissions&&null!==e.trackPermissions)for(const n of e.trackPermissions)i.trackPermissions.push(t.TrackPermission.fromJSON(n));return i},toJSON(e){const i={};return void 0!==e.allParticipants&&(i.allParticipants=e.allParticipants),e.trackPermissions?i.trackPermissions=e.trackPermissions.map((e=>e?t.TrackPermission.toJSON(e):void 0)):i.trackPermissions=[],i},fromPartial(e){var i;const n=Object.assign({},x);if(n.allParticipants=null!==(i=e.allParticipants)&&void 0!==i&&i,n.trackPermissions=[],void 0!==e.trackPermissions&&null!==e.trackPermissions)for(const r of e.trackPermissions)n.trackPermissions.push(t.TrackPermission.fromPartial(r));return n}};const A={participantSid:"",trackSid:"",allowed:!1};t.SubscriptionPermissionUpdate={encode:(e,t=o.default.Writer.create())=>(""!==e.participantSid&&t.uint32(10).string(e.participantSid),""!==e.trackSid&&t.uint32(18).string(e.trackSid),!0===e.allowed&&t.uint32(24).bool(e.allowed),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},A);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.participantSid=i.string();break;case 2:r.trackSid=i.string();break;case 3:r.allowed=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},A);return void 0!==e.participantSid&&null!==e.participantSid?t.participantSid=String(e.participantSid):t.participantSid="",void 0!==e.trackSid&&null!==e.trackSid?t.trackSid=String(e.trackSid):t.trackSid="",void 0!==e.allowed&&null!==e.allowed?t.allowed=Boolean(e.allowed):t.allowed=!1,t},toJSON(e){const t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.trackSid&&(t.trackSid=e.trackSid),void 0!==e.allowed&&(t.allowed=e.allowed),t},fromPartial(e){var t,i,n;const r=Object.assign({},A);return r.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",r.trackSid=null!==(i=e.trackSid)&&void 0!==i?i:"",r.allowed=null!==(n=e.allowed)&&void 0!==n&&n,r}};const j={};t.SyncState={encode(e,i=o.default.Writer.create()){void 0!==e.answer&&t.SessionDescription.encode(e.answer,i.uint32(10).fork()).ldelim(),void 0!==e.subscription&&t.UpdateSubscription.encode(e.subscription,i.uint32(18).fork()).ldelim();for(const n of e.publishTracks)t.TrackPublishedResponse.encode(n,i.uint32(26).fork()).ldelim();return i},decode(e,i){const n=e instanceof o.default.Reader?e:new o.default.Reader(e);let r=void 0===i?n.len:n.pos+i;const s=Object.assign({},j);for(s.publishTracks=[];n.pos<r;){const e=n.uint32();switch(e>>>3){case 1:s.answer=t.SessionDescription.decode(n,n.uint32());break;case 2:s.subscription=t.UpdateSubscription.decode(n,n.uint32());break;case 3:s.publishTracks.push(t.TrackPublishedResponse.decode(n,n.uint32()));break;default:n.skipType(7&e)}}return s},fromJSON(e){const i=Object.assign({},j);if(i.publishTracks=[],void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromJSON(e.answer):i.answer=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromJSON(e.subscription):i.subscription=void 0,void 0!==e.publishTracks&&null!==e.publishTracks)for(const n of e.publishTracks)i.publishTracks.push(t.TrackPublishedResponse.fromJSON(n));return i},toJSON(e){const i={};return void 0!==e.answer&&(i.answer=e.answer?t.SessionDescription.toJSON(e.answer):void 0),void 0!==e.subscription&&(i.subscription=e.subscription?t.UpdateSubscription.toJSON(e.subscription):void 0),e.publishTracks?i.publishTracks=e.publishTracks.map((e=>e?t.TrackPublishedResponse.toJSON(e):void 0)):i.publishTracks=[],i},fromPartial(e){const i=Object.assign({},j);if(void 0!==e.answer&&null!==e.answer?i.answer=t.SessionDescription.fromPartial(e.answer):i.answer=void 0,void 0!==e.subscription&&null!==e.subscription?i.subscription=t.UpdateSubscription.fromPartial(e.subscription):i.subscription=void 0,i.publishTracks=[],void 0!==e.publishTracks&&null!==e.publishTracks)for(const n of e.publishTracks)i.publishTracks.push(t.TrackPublishedResponse.fromPartial(n));return i}};const J={};t.SimulateScenario={encode:(e,t=o.default.Writer.create())=>(void 0!==e.speakerUpdate&&t.uint32(8).int32(e.speakerUpdate),void 0!==e.nodeFailure&&t.uint32(16).bool(e.nodeFailure),void 0!==e.migration&&t.uint32(24).bool(e.migration),void 0!==e.serverLeave&&t.uint32(32).bool(e.serverLeave),t),decode(e,t){const i=e instanceof o.default.Reader?e:new o.default.Reader(e);let n=void 0===t?i.len:i.pos+t;const r=Object.assign({},J);for(;i.pos<n;){const e=i.uint32();switch(e>>>3){case 1:r.speakerUpdate=i.int32();break;case 2:r.nodeFailure=i.bool();break;case 3:r.migration=i.bool();break;case 4:r.serverLeave=i.bool();break;default:i.skipType(7&e)}}return r},fromJSON(e){const t=Object.assign({},J);return void 0!==e.speakerUpdate&&null!==e.speakerUpdate?t.speakerUpdate=Number(e.speakerUpdate):t.speakerUpdate=void 0,void 0!==e.nodeFailure&&null!==e.nodeFailure?t.nodeFailure=Boolean(e.nodeFailure):t.nodeFailure=void 0,void 0!==e.migration&&null!==e.migration?t.migration=Boolean(e.migration):t.migration=void 0,void 0!==e.serverLeave&&null!==e.serverLeave?t.serverLeave=Boolean(e.serverLeave):t.serverLeave=void 0,t},toJSON(e){const t={};return void 0!==e.speakerUpdate&&(t.speakerUpdate=e.speakerUpdate),void 0!==e.nodeFailure&&(t.nodeFailure=e.nodeFailure),void 0!==e.migration&&(t.migration=e.migration),void 0!==e.serverLeave&&(t.serverLeave=e.serverLeave),t},fromPartial(e){var t,i,n,r;const o=Object.assign({},J);return o.speakerUpdate=null!==(t=e.speakerUpdate)&&void 0!==t?t:void 0,o.nodeFailure=null!==(i=e.nodeFailure)&&void 0!==i?i:void 0,o.migration=null!==(n=e.migration)&&void 0!==n?n:void 0,o.serverLeave=null!==(r=e.serverLeave)&&void 0!==r?r:void 0,o}},o.default.util.Long!==r.default&&(o.default.util.Long=r.default,o.default.configure())},11480:function(e,t){"use strict";var i=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const n="default";class r{static getInstance(){return void 0===this.instance&&(this.instance=new r),this.instance}getDevices(e){return i(this,void 0,void 0,(function*(){let t=yield navigator.mediaDevices.enumerateDevices();if(t=t.filter((t=>t.kind===e)),t.length>1&&t[0].deviceId===n){const e=t[0];for(let i=1;i<t.length;i+=1)if(t[i].groupId===e.groupId){const e=t[0];t[0]=t[i],t[i]=e;break}return t.filter((t=>t!==e))}return t}))}normalizeDeviceId(e,t,r){return i(this,void 0,void 0,(function*(){if(t!==n)return t;const i=(yield this.getDevices(e)).find((e=>e.groupId===r&&e.deviceId!==n));return null===i||void 0===i?void 0:i.deviceId}))}}t.default=r,r.mediaDeviceKinds=["audioinput","audiooutput","videoinput"]},8974:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(2938),s=r(i(72662));t.default=class{constructor(e){this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.negotiate=o.debounce((()=>{this.createAndSendOffer()}),100),this.pc=new RTCPeerConnection(e)}get isICEConnected(){return"connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState}addIceCandidate(e){return n(this,void 0,void 0,(function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)}))}setRemoteDescription(e){return n(this,void 0,void 0,(function*(){yield this.pc.setRemoteDescription(e),this.pendingCandidates.forEach((e=>{this.pc.addIceCandidate(e)})),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate&&(this.renegotiate=!1,this.createAndSendOffer())}))}createAndSendOffer(e){return n(this,void 0,void 0,(function*(){if(void 0===this.onOffer)return;if((null===e||void 0===e?void 0:e.iceRestart)&&(s.default.debug("restarting ICE"),this.restartingIce=!0),"have-local-offer"===this.pc.signalingState){const t=this.pc.remoteDescription;if(!(null===e||void 0===e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this.pc.setRemoteDescription(t)}else if("closed"===this.pc.signalingState)return void s.default.warn("could not createOffer with closed peer connection");s.default.debug("starting to negotiate");const t=yield this.pc.createOffer(e);yield this.pc.setLocalDescription(t),this.onOffer(t)}))}close(){this.pc.close()}}},68947:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.maxICEConnectTimeout=void 0;const o=i(17187),s=i(9286),a=r(i(72662)),c=i(8983),d=i(44658),u=i(67650),l=i(28911),p=r(i(8974)),h=i(71981),f="_lossy",m="_reliable";t.maxICEConnectTimeout=5e3;class v extends o.EventEmitter{constructor(){super(),this.rtcConfig={},this.subscriberPrimary=!1,this.iceConnected=!1,this.isClosed=!0,this.pendingTrackResolvers={},this.hasPublished=!1,this.reconnectAttempts=0,this.handleDataChannel=({channel:e})=>n(this,void 0,void 0,(function*(){if(e){if(e.label===m)this.reliableDCSub=e;else{if(e.label!==f)return;this.lossyDCSub=e}e.onmessage=this.handleDataMessage}})),this.handleDataMessage=e=>n(this,void 0,void 0,(function*(){let t;if(e.data instanceof ArrayBuffer)t=e.data;else{if(!(e.data instanceof Blob))return void a.default.error("unsupported data type",e.data);t=yield e.data.arrayBuffer()}const i=c.DataPacket.decode(new Uint8Array(t));i.speaker?this.emit(l.EngineEvent.ActiveSpeakersUpdate,i.speaker.speakers):i.user&&this.emit(l.EngineEvent.DataPacketReceived,i.user,i.kind)})),this.handleDisconnect=e=>{if(this.isClosed)return;if(a.default.debug(`${e} disconnected`),this.reconnectAttempts>=5)return a.default.info("could not connect to signal after",5,"attempts. giving up"),this.emit(l.EngineEvent.Disconnected),void this.close();const t=this.reconnectAttempts*this.reconnectAttempts*300;setTimeout((()=>{this.reconnect().then((()=>{this.reconnectAttempts=0})).catch(this.handleDisconnect)}),t)},this.client=new s.SignalClient}join(e,t,i){return n(this,void 0,void 0,(function*(){this.url=e,this.token=t;const n=yield this.client.join(e,t,i);return this.emit(l.EngineEvent.SignalConnected),this.isClosed=!1,this.subscriberPrimary=n.subscriberPrimary,this.publisher||this.configure(n),this.subscriberPrimary||this.negotiate(),n}))}close(){this.isClosed=!0,this.removeAllListeners(),this.publisher&&"closed"!==this.publisher.pc.signalingState&&(this.publisher.pc.getSenders().forEach((e=>{var t;try{null===(t=this.publisher)||void 0===t||t.pc.removeTrack(e)}catch(i){a.default.warn("could not removeTrack",i)}})),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.client.close()}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new u.TrackInvalidError("a track with the same ID has already been published");return new Promise((t=>{this.pendingTrackResolvers[e.cid]=t,this.client.sendAddTrack(e)}))}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}get connectedServerAddress(){return this.connectedServerAddr}configure(e){if(this.publisher||this.subscriber)return;if(e.iceServers&&!this.rtcConfig.iceServers){const t=[];e.iceServers.forEach((e=>{const i={urls:e.urls};e.username&&(i.username=e.username),e.credential&&(i.credential=e.credential),t.push(i)})),this.rtcConfig.iceServers=t}this.publisher=new p.default(this.rtcConfig),this.subscriber=new p.default(this.rtcConfig),this.publisher.pc.onicecandidate=e=>{e.candidate&&(a.default.trace("adding ICE candidate for peer",e.candidate),this.client.sendIceCandidate(e.candidate,d.SignalTarget.PUBLISHER))},this.subscriber.pc.onicecandidate=e=>{e.candidate&&this.client.sendIceCandidate(e.candidate,d.SignalTarget.SUBSCRIBER)},this.publisher.onOffer=e=>{this.client.sendOffer(e)};let t=this.publisher.pc;e.subscriberPrimary&&(t=this.subscriber.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),t.oniceconnectionstatechange=()=>{"connected"===t.iceConnectionState?(a.default.trace("ICE connected"),this.iceConnected||(this.iceConnected=!0,this.emit(l.EngineEvent.Connected)),function(e){var t;return n(this,void 0,void 0,(function*(){let i="";const n=new Map,r=new Map;if((yield e.getStats()).forEach((e=>{switch(e.type){case"transport":i=e.selectedCandidatePairId;break;case"candidate-pair":""===i&&e.selected&&(i=e.id),n.set(e.id,e);break;case"remote-candidate":r.set(e.id,`${e.address}:${e.port}`)}})),""===i)return;const o=null===(t=n.get(i))||void 0===t?void 0:t.remoteCandidateId;return void 0!==o?r.get(o):void 0}))}(t).then((e=>{this.connectedServerAddr=e}))):"failed"===t.iceConnectionState&&(a.default.trace("ICE disconnected"),this.iceConnected&&(this.iceConnected=!1,this.handleDisconnect("peerconnection")))},this.subscriber.pc.ontrack=e=>{this.emit(l.EngineEvent.MediaTrackAdded,e.track,e.streams[0],e.receiver)},this.lossyDC=this.publisher.pc.createDataChannel(f,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(m,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.client.onAnswer=e=>n(this,void 0,void 0,(function*(){this.publisher&&(a.default.debug("received server answer",e.type,this.publisher.pc.signalingState),yield this.publisher.setRemoteDescription(e))})),this.client.onTrickle=(e,t)=>{this.publisher&&this.subscriber&&(a.default.trace("got ICE candidate from peer",e,t),t===d.SignalTarget.PUBLISHER?this.publisher.addIceCandidate(e):this.subscriber.addIceCandidate(e))},this.client.onOffer=e=>n(this,void 0,void 0,(function*(){if(!this.subscriber)return;a.default.debug("received server offer",e.type,this.subscriber.pc.signalingState),yield this.subscriber.setRemoteDescription(e);const t=yield this.subscriber.pc.createAnswer();yield this.subscriber.pc.setLocalDescription(t),this.client.sendAnswer(t)})),this.client.onLocalTrackPublished=e=>{a.default.debug("received trackPublishedResponse",e);const t=this.pendingTrackResolvers[e.cid];t?(delete this.pendingTrackResolvers[e.cid],t(e.track)):a.default.error("missing track resolver for ",e.cid)},this.client.onClose=()=>{this.handleDisconnect("signal")},this.client.onLeave=()=>{this.emit(l.EngineEvent.Disconnected),this.close()}}reconnect(){return n(this,void 0,void 0,(function*(){if(this.isClosed)return;if(!this.url||!this.token)throw new u.ConnectionError("could not reconnect, url or token not saved");if(a.default.info("reconnecting to signal connection, attempt",this.reconnectAttempts),0===this.reconnectAttempts&&this.emit(l.EngineEvent.Reconnecting),this.reconnectAttempts+=1,yield this.client.reconnect(this.url,this.token),this.emit(l.EngineEvent.SignalConnected),!this.publisher||!this.subscriber)throw new u.UnexpectedConnectionState("publisher and subscriber connections unset");this.subscriber.restartingIce=!0,this.hasPublished&&(yield this.publisher.createAndSendOffer({iceRestart:!0}));const e=(new Date).getTime();for(;(new Date).getTime()-e<2*t.maxICEConnectTimeout;){if(this.iceConnected)return void this.emit(l.EngineEvent.Reconnected);yield h.sleep(100)}throw new u.ConnectionError("could not establish ICE connection")}))}sendDataPacket(e,t){return n(this,void 0,void 0,(function*(){const i=c.DataPacket.encode(e).finish();yield this.ensurePublisherConnected(t),t===c.DataPacket_Kind.LOSSY&&this.lossyDC?this.lossyDC.send(i):t===c.DataPacket_Kind.RELIABLE&&this.reliableDC&&this.reliableDC.send(i)}))}ensurePublisherConnected(e){var i,r;return n(this,void 0,void 0,(function*(){if(!this.subscriberPrimary)return;if(!this.publisher)throw new u.ConnectionError("publisher connection not set");this.publisher.isICEConnected||"checking"===this.publisher.pc.iceConnectionState||this.negotiate();const n=this.dataChannelForKind(e);if("open"===(null===n||void 0===n?void 0:n.readyState))return;const o=(new Date).getTime()+t.maxICEConnectTimeout;for(;(new Date).getTime()<o;){if(this.publisher.isICEConnected&&"open"===(null===(i=this.dataChannelForKind(e))||void 0===i?void 0:i.readyState))return;yield h.sleep(50)}throw new u.ConnectionError(`could not establish publisher connection, state ${null===(r=this.publisher)||void 0===r?void 0:r.pc.iceConnectionState}`)}))}negotiate(){this.publisher&&(this.hasPublished=!0,this.publisher.negotiate())}dataChannelForKind(e){return e===c.DataPacket_Kind.LOSSY?this.lossyDC:e===c.DataPacket_Kind.RELIABLE?this.reliableDC:void 0}}t.default=v},93258:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RoomState=void 0;const c=i(17187),d=i(9286),u=a(i(72662)),l=i(8983),p=i(44658),h=a(i(11480)),f=i(67650),m=i(28911),v=a(i(24149)),b=a(i(51488)),g=o(i(68947)),k=i(21442),S=i(80410),y=i(71981);var w;!function(e){e.Disconnected="disconnected",e.Connected="connected",e.Reconnecting="reconnecting"}(w=t.RoomState||(t.RoomState={}));class T extends c.EventEmitter{constructor(e){super(),this.state=w.Disconnected,this.activeSpeakers=[],this.sid="",this.name="",this.metadata=void 0,this.audioEnabled=!0,this.connect=(e,t,i)=>s(this,void 0,void 0,(function*(){if(this.state===w.Disconnected){this.createEngine(),this.acquireAudioContext(),(null===i||void 0===i?void 0:i.rtcConfig)&&(this.engine.rtcConfig=i.rtcConfig),this.connOptions=i;try{const n=yield this.engine.join(e,t,i);if(u.default.debug("connected to Livekit Server",n.serverVersion),!n.serverVersion)throw new f.UnsupportedServer("unknown server version");"0.15.1"===n.serverVersion&&this.options.dynacast&&(u.default.debug("disabling dynacast due to server version"),this.options.dynacast=!1),this.state=w.Connected;const r=n.participant;this.localParticipant=new v.default(r.sid,r.identity,this.engine,this.options),this.localParticipant.updateInfo(r),this.localParticipant.on(m.ParticipantEvent.MetadataChanged,(e=>{this.emit(m.RoomEvent.MetadataChanged,e,this.localParticipant)})).on(m.ParticipantEvent.ParticipantMetadataChanged,(e=>{this.emit(m.RoomEvent.ParticipantMetadataChanged,e,this.localParticipant)})).on(m.ParticipantEvent.TrackMuted,(e=>{this.emit(m.RoomEvent.TrackMuted,e,this.localParticipant)})).on(m.ParticipantEvent.TrackUnmuted,(e=>{this.emit(m.RoomEvent.TrackUnmuted,e,this.localParticipant)})).on(m.ParticipantEvent.LocalTrackPublished,(e=>{this.emit(m.RoomEvent.LocalTrackPublished,e,this.localParticipant)})).on(m.ParticipantEvent.LocalTrackUnpublished,(e=>{this.emit(m.RoomEvent.LocalTrackUnpublished,e,this.localParticipant)})).on(m.ParticipantEvent.ConnectionQualityChanged,(e=>{this.emit(m.RoomEvent.ConnectionQualityChanged,e,this.localParticipant)})).on(m.ParticipantEvent.MediaDevicesError,(e=>{this.emit(m.RoomEvent.MediaDevicesError,e)})),n.otherParticipants.forEach((e=>{this.getOrCreateParticipant(e.sid,e)})),this.name=n.room.name,this.sid=n.room.sid,this.metadata=n.room.metadata}catch(n){throw this.engine.close(),n}return new Promise(((e,t)=>{const i=setTimeout((()=>{this.engine.close(),t(new f.ConnectionError("could not connect after timeout"))}),g.maxICEConnectTimeout);this.engine.once(m.EngineEvent.Connected,(()=>{clearTimeout(i),window.addEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange),e(this)}))}))}u.default.warn("already connected to room",this.name)})),this.disconnect=(e=!0)=>{this.engine&&(this.engine.client.sendLeave(),this.engine.close()),this.handleDisconnect(e),this.engine=void 0},this.onBeforeUnload=()=>{this.disconnect()},this.handleParticipantUpdates=e=>{e.forEach((e=>{if(e.sid===this.localParticipant.sid)return void this.localParticipant.updateInfo(e);let t=this.participants.get(e.sid);const i=!t;t=this.getOrCreateParticipant(e.sid,e),e.state===l.ParticipantInfo_State.DISCONNECTED?this.handleParticipantDisconnected(e.sid,t):i?this.emit(m.RoomEvent.ParticipantConnected,t):t.updateInfo(e)}))},this.handleActiveSpeakersUpdate=e=>{const t=[],i={};e.forEach((e=>{if(i[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const i=this.participants.get(e.sid);i&&(i.audioLevel=e.level,i.setIsSpeaking(!0),t.push(i))}})),i[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach((e=>{i[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))})),this.activeSpeakers=t,this.emit(m.RoomEvent.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach((e=>{t.set(e.sid,e)})),e.forEach((e=>{let i=this.participants.get(e.sid);e.sid===this.localParticipant.sid&&(i=this.localParticipant),i&&(i.audioLevel=e.level,i.setIsSpeaking(e.active),e.active?t.set(e.sid,i):t.delete(e.sid))}));const i=Array.from(t.values());i.sort(((e,t)=>t.audioLevel-e.audioLevel)),this.activeSpeakers=i,this.emit(m.RoomEvent.ActiveSpeakersChanged,i)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach((e=>{const t=this.participants.get(e.participantSid);if(!t)return;const i=t.getTrackPublication(e.trackSid);i&&i.track&&(i.track.streamState=S.Track.streamStateFromProto(e.state),t.emit(m.ParticipantEvent.TrackStreamStateChanged,i,i.track.streamState),this.emit(m.ParticipantEvent.TrackStreamStateChanged,i,i.track.streamState,t))}))},this.handleSubscriptionPermissionUpdate=e=>{const t=this.participants.get(e.participantSid);if(!t)return;const i=t.getTrackPublication(e.trackSid);i&&(i._allowed=e.allowed,t.emit(m.ParticipantEvent.TrackSubscriptionPermissionChanged,i,i.subscriptionStatus),this.emit(m.ParticipantEvent.TrackSubscriptionPermissionChanged,i,i.subscriptionStatus,t))},this.handleDataPacket=(e,t)=>{const i=this.participants.get(e.participantSid);this.emit(m.RoomEvent.DataReceived,e.payload,i,t),null===i||void 0===i||i.emit(m.ParticipantEvent.DataReceived,e.payload,t)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(m.RoomEvent.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{u.default.warn("could not playback audio",e),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(m.RoomEvent.AudioPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>s(this,void 0,void 0,(function*(){this.emit(m.RoomEvent.MediaDevicesChanged)})),this.handleRoomUpdate=e=>{this.metadata=e.metadata,this.emit(m.RoomEvent.RoomMetadataChanged,e.metadata)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach((e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.participants.get(e.participantSid);t&&t.setConnectionQuality(e.quality)}))},this.participants=new Map,this.options=e||{},this.options.audioCaptureDefaults=Object.assign(Object.assign({},k.audioDefaults),null===e||void 0===e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},k.videoDefaults),null===e||void 0===e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},k.publishDefaults),null===e||void 0===e?void 0:e.publishDefaults),this.createEngine(),this.localParticipant=new v.default("","",this.engine,this.options)}createEngine(){this.engine||(this.engine=new g.default,this.engine.client.signalLatency=this.options.expSignalLatency,this.engine.on(m.EngineEvent.MediaTrackAdded,((e,t,i)=>{this.onTrackAdded(e,t,i)})),this.engine.on(m.EngineEvent.Disconnected,(()=>{this.handleDisconnect()})),this.engine.client.onParticipantUpdate=this.handleParticipantUpdates,this.engine.client.onRoomUpdate=this.handleRoomUpdate,this.engine.client.onSpeakersChanged=this.handleSpeakersChanged,this.engine.client.onStreamStateUpdate=this.handleStreamStateUpdate,this.engine.client.onSubscriptionPermissionUpdate=this.handleSubscriptionPermissionUpdate,this.engine.on(m.EngineEvent.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate),this.engine.on(m.EngineEvent.DataPacketReceived,this.handleDataPacket),this.engine.on(m.EngineEvent.Reconnecting,(()=>{this.state=w.Reconnecting,this.emit(m.RoomEvent.Reconnecting)})),this.engine.on(m.EngineEvent.Reconnected,(()=>{this.state=w.Connected,this.emit(m.RoomEvent.Reconnected)})),this.engine.on(m.EngineEvent.SignalConnected,(()=>{this.state===w.Reconnecting&&this.sendSyncState()})),this.engine.client.onConnectionQuality=this.handleConnectionQualityUpdate)}static getLocalDevices(e){return h.default.getInstance().getDevices(e)}getParticipantByIdentity(e){for(const[,t]of this.participants)if(t.identity===e)return t;if(this.localParticipant.identity===e)return this.localParticipant}simulateScenario(e){let t;switch(e){case"speaker":t=p.SimulateScenario.fromPartial({speakerUpdate:3});break;case"node-failure":t=p.SimulateScenario.fromPartial({nodeFailure:!0});break;case"server-leave":t=p.SimulateScenario.fromPartial({serverLeave:!0});break;case"migration":t=p.SimulateScenario.fromPartial({migration:!0})}t&&this.engine.client.sendSimulateScenario(t)}startAudio(){return s(this,void 0,void 0,(function*(){this.acquireAudioContext();const e=[];this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))}));try{yield Promise.all(e.map((e=>e.play()))),this.handleAudioPlaybackStarted()}catch(t){throw this.handleAudioPlaybackFailed(t),t}}))}get canPlaybackAudio(){return this.audioEnabled}switchActiveDevice(e,t){return s(this,void 0,void 0,(function*(){if("audioinput"===e){const e=Array.from(this.localParticipant.audioTracks.values()).filter((e=>e.source===S.Track.Source.Microphone));yield Promise.all(e.map((e=>{var i;return null===(i=e.audioTrack)||void 0===i?void 0:i.setDeviceId(t)}))),this.options.audioCaptureDefaults.deviceId=t}else if("videoinput"===e){const e=Array.from(this.localParticipant.videoTracks.values()).filter((e=>e.source===S.Track.Source.Camera));yield Promise.all(e.map((e=>{var i;return null===(i=e.videoTrack)||void 0===i?void 0:i.setDeviceId(t)}))),this.options.videoCaptureDefaults.deviceId=t}else if("audiooutput"===e){const e=[];this.participants.forEach((t=>{t.audioTracks.forEach((t=>{t.isSubscribed&&t.track&&t.track.attachedElements.forEach((t=>{e.push(t)}))}))})),yield Promise.all(e.map((e=>s(this,void 0,void 0,(function*(){"setSinkId"in e&&(yield e.setSinkId(t))})))))}}))}onTrackAdded(e,t,i){const n=y.unpackStreamId(t.id),r=n[0];let o=n[1];o&&""!==o||(o=e.id);this.getOrCreateParticipant(r).addSubscribedMediaTrack(e,o,t,i,this.options.adaptiveStream)}handleDisconnect(e=!0){this.state!==w.Disconnected&&(this.participants.forEach((e=>{e.tracks.forEach((t=>{e.unpublishTrack(t.trackSid)}))})),this.localParticipant.tracks.forEach((t=>{var i,n;t.track&&this.localParticipant.unpublishTrack(t.track),e&&(null===(i=t.track)||void 0===i||i.detach(),null===(n=t.track)||void 0===n||n.stop())})),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&(this.audioContext.close(),this.audioContext=void 0),window.removeEventListener("beforeunload",this.onBeforeUnload),navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange),this.state=w.Disconnected,this.emit(m.RoomEvent.Disconnected))}handleParticipantDisconnected(e,t){this.participants.delete(e),t&&(t.tracks.forEach((e=>{t.unpublishTrack(e.trackSid)})),this.emit(m.RoomEvent.ParticipantDisconnected,t))}acquireAudioContext(){this.audioContext&&this.audioContext.close();const e=window.AudioContext||window.webkitAudioContext;e&&(this.audioContext=new e)}getOrCreateParticipant(e,t){let i=this.participants.get(e);return i||(i=t?b.default.fromParticipantInfo(this.engine.client,t):new b.default(this.engine.client,e,""),this.participants.set(e,i),i.on(m.ParticipantEvent.TrackPublished,(e=>{this.emit(m.RoomEvent.TrackPublished,e,i)})).on(m.ParticipantEvent.TrackSubscribed,((e,t)=>{e.kind===S.Track.Kind.Audio&&(e.on(m.TrackEvent.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(m.TrackEvent.AudioPlaybackFailed,this.handleAudioPlaybackFailed)),this.emit(m.RoomEvent.TrackSubscribed,e,t,i)})).on(m.ParticipantEvent.TrackUnpublished,(e=>{this.emit(m.RoomEvent.TrackUnpublished,e,i)})).on(m.ParticipantEvent.TrackUnsubscribed,((e,t)=>{this.emit(m.RoomEvent.TrackUnsubscribed,e,t,i)})).on(m.ParticipantEvent.TrackSubscriptionFailed,(e=>{this.emit(m.RoomEvent.TrackSubscriptionFailed,e,i)})).on(m.ParticipantEvent.TrackMuted,(e=>{this.emit(m.RoomEvent.TrackMuted,e,i)})).on(m.ParticipantEvent.TrackUnmuted,(e=>{this.emit(m.RoomEvent.TrackUnmuted,e,i)})).on(m.ParticipantEvent.MetadataChanged,(e=>{this.emit(m.RoomEvent.MetadataChanged,e,i)})).on(m.ParticipantEvent.ParticipantMetadataChanged,(e=>{this.emit(m.RoomEvent.ParticipantMetadataChanged,e,i)})).on(m.ParticipantEvent.ConnectionQualityChanged,(e=>{this.emit(m.RoomEvent.ConnectionQualityChanged,e,i)}))),i}sendSyncState(){var e;if(void 0===this.engine.subscriber||null===this.engine.subscriber.pc.localDescription)return;const t=this.engine.subscriber.pc.localDescription,i=(null===(e=this.connOptions)||void 0===e?void 0:e.autoSubscribe)||!1,n=new Array;this.participants.forEach((e=>{e.tracks.forEach((e=>{e.isSubscribed!==i&&n.push(e.trackSid)}))})),this.engine.client.sendSyncState({answer:d.toProtoSessionDescription({sdp:t.sdp,type:t.type}),subscription:{trackSids:n,subscribe:!i,participantTracks:[]},publishTracks:this.localParticipant.publishedTracksInfo()})}emit(e,...t){return u.default.debug("room event",e,...t),super.emit(e,...t)}}t.default=T},67650:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MediaDeviceFailure=t.PublishDataError=t.UnexpectedConnectionState=t.UnsupportedServer=t.TrackInvalidError=t.ConnectionError=t.LivekitError=void 0;class i extends Error{constructor(e,t){super(t||"an error has occured"),this.code=e}}t.LivekitError=i;t.ConnectionError=class extends i{constructor(e){super(1,e)}};t.TrackInvalidError=class extends i{constructor(e){super(20,e||"Track is invalid")}};t.UnsupportedServer=class extends i{constructor(e){super(10,e||"Unsupported server")}};t.UnexpectedConnectionState=class extends i{constructor(e){super(12,e||"Unexpected connection state")}};t.PublishDataError=class extends i{constructor(e){super(13,e||"Unable to publish data")}},function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(t.MediaDeviceFailure||(t.MediaDeviceFailure={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(t.MediaDeviceFailure||(t.MediaDeviceFailure={}))},28911:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackEvent=t.EngineEvent=t.ParticipantEvent=t.RoomEvent=void 0,function(e){e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ActiveSpeakersChanged="activeSpeakersChanged",e.MetadataChanged="metadataChanged",e.ParticipantMetadataChanged="participantMetaDataChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.MediaDevicesError="mediaDevicesError"}(t.RoomEvent||(t.RoomEvent={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.MetadataChanged="metadataChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.MediaDevicesError="mediaDevicesError"}(t.ParticipantEvent||(t.ParticipantEvent={})),function(e){e.Connected="connected",e.Disconnected="disconnected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.SignalConnected="singalConnected",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived"}(t.EngineEvent||(t.EngineEvent={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Ended="ended",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged"}(t.TrackEvent||(t.TrackEvent={}))},24149:function(e,t,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&n(t,e,i);return r(t,e),t},s=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=a(i(72662)),d=i(44658),u=i(67650),l=i(28911),p=a(i(98669)),h=a(i(170)),f=o(i(76887)),m=i(36669),v=i(80410),b=i(89565),g=a(i(22070)),k=i(48792),S=i(85482),y=a(i(51488));class w extends g.default{constructor(e,t,i,n){super(e,t),this.pendingPublishing=new Set,this.onTrackUnmuted=e=>{this.onTrackMuted(e,!1)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):c.default.error("could not update mute status for unpublished track",e)},this.handleSubscribedQualityUpdate=e=>{var t,i;if(!(null===(t=this.roomOptions)||void 0===t?void 0:t.dynacast))return;const n=this.videoTracks.get(e.trackSid);n?null===(i=n.videoTrack)||void 0===i||i.setPublishingLayers(e.subscribedQualities):c.default.warn("handleSubscribedQualityUpdate","received subscribed quality update for unknown track",e.trackSid)},this.onTrackUnpublish=e=>{this.unpublishTrack(e)},this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=i,this.roomOptions=n,this.engine.client.onRemoteMuteChanged=(e,t)=>{const i=this.tracks.get(e);i&&i.track&&(t?i.mute():i.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}setCameraEnabled(e){return this.setTrackEnabled(v.Track.Source.Camera,e)}setMicrophoneEnabled(e){return this.setTrackEnabled(v.Track.Source.Microphone,e)}setScreenShareEnabled(e){return this.setTrackEnabled(v.Track.Source.ScreenShare,e)}setTrackEnabled(e,t){return s(this,void 0,void 0,(function*(){c.default.debug("setTrackEnabled",e,t);const i=this.getTrack(e);if(t)if(i)yield i.unmute();else{let t;if(this.pendingPublishing.has(e))return void c.default.info("skipping duplicate published source",e);this.pendingPublishing.add(e);try{switch(e){case v.Track.Source.Camera:[t]=yield this.createTracks({video:!0});break;case v.Track.Source.Microphone:[t]=yield this.createTracks({audio:!0});break;case v.Track.Source.ScreenShare:[t]=yield this.createScreenTracks({audio:!1});break;default:throw new u.TrackInvalidError(e)}yield this.publishTrack(t)}catch(n){throw n instanceof Error&&!(n instanceof u.TrackInvalidError)&&this.emit(l.ParticipantEvent.MediaDevicesError,n),n}finally{this.pendingPublishing.delete(e)}}else i&&i.track&&(e===v.Track.Source.ScreenShare?this.unpublishTrack(i.track):yield i.mute())}))}enableCameraAndMicrophone(){return s(this,void 0,void 0,(function*(){if(!this.pendingPublishing.has(v.Track.Source.Camera)&&!this.pendingPublishing.has(v.Track.Source.Microphone)){this.pendingPublishing.add(v.Track.Source.Camera),this.pendingPublishing.add(v.Track.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map((e=>this.publishTrack(e))))}finally{this.pendingPublishing.delete(v.Track.Source.Camera),this.pendingPublishing.delete(v.Track.Source.Microphone)}}}))}createTracks(e){var t,i;return s(this,void 0,void 0,(function*(){const n=b.mergeDefaultOptions(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(i=this.roomOptions)||void 0===i?void 0:i.videoCaptureDefaults),r=b.constraintsForOptions(n);let o;try{o=yield navigator.mediaDevices.getUserMedia(r)}catch(s){throw s instanceof Error&&(r.audio&&(this.microphoneError=s),r.video&&(this.cameraError=s)),s}return r.audio&&(this.microphoneError=void 0),r.video&&(this.cameraError=void 0),o.getTracks().map((t=>{const i="audio"===t.kind;let n,o=i?e.audio:e.video;"boolean"!==typeof o&&o||(o={});const s=i?r.audio:r.video;"boolean"!==typeof s&&(n=s);const a=S.mediaTrackToLocalTrack(t,n);return a.kind===v.Track.Kind.Video?a.source=v.Track.Source.Camera:a.kind===v.Track.Kind.Audio&&(a.source=v.Track.Source.Microphone),a}))}))}createScreenTracks(e){var t;return s(this,void 0,void 0,(function*(){void 0===e&&(e={}),void 0===e.resolution&&(e.resolution=m.VideoPresets.fhd.resolution);let i=!0;e.resolution&&(i={width:e.resolution.width,height:e.resolution.height,frameRate:e.resolution.frameRate});const n=yield navigator.mediaDevices.getDisplayMedia({audio:null!==(t=e.audio)&&void 0!==t&&t,video:i}),r=n.getVideoTracks();if(0===r.length)throw new u.TrackInvalidError("no video track found");const o=new f.default(r[0]);o.source=v.Track.Source.ScreenShare;const s=[o];if(n.getAudioTracks().length>0){const e=new p.default(n.getAudioTracks()[0]);e.source=v.Track.Source.ScreenShareAudio,s.push(e)}return s}))}publishTrack(e,t){var i,n,r,o,a,m,b,g;return s(this,void 0,void 0,(function*(){const s=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),t);if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new p.default(e);break;case"video":e=new f.default(e);break;default:throw new u.TrackInvalidError(`unsupported MediaStreamTrack kind ${e.kind}`)}let k;if(this.tracks.forEach((t=>{t.track&&t.track===e&&(k=t)})),k)return k;s.source&&(e.source=s.source),s.stopMicTrackOnMute&&e instanceof p.default&&(e.stopOnMute=!0),e.on(l.TrackEvent.Muted,this.onTrackMuted),e.on(l.TrackEvent.Unmuted,this.onTrackUnmuted),e.on(l.TrackEvent.Ended,this.onTrackUnpublish);const y=d.AddTrackRequest.fromPartial({cid:e.mediaStreamTrack.id,name:null===t||void 0===t?void 0:t.name,type:v.Track.kindToProto(e.kind),muted:e.isMuted,source:v.Track.sourceToProto(e.source),disableDtx:!(null===(n=null===s||void 0===s?void 0:s.dtx)||void 0===n||n)});let w;if(e.kind===v.Track.Kind.Video){const t=e.mediaStreamTrack.getSettings(),i=null!==(r=t.width)&&void 0!==r?r:null===(o=e.dimensions)||void 0===o?void 0:o.width,n=null!==(a=t.height)&&void 0!==a?a:null===(m=e.dimensions)||void 0===m?void 0:m.height;y.width=null!==i&&void 0!==i?i:0,y.height=null!==n&&void 0!==n?n:0,w=S.computeVideoEncodings(e.source===v.Track.Source.ScreenShare,i,n,s),y.layers=f.videoLayersFromEncodings(y.width,y.height,w)}else e.kind===v.Track.Kind.Audio&&s.audioBitrate&&(w=[{maxBitrate:s.audioBitrate}]);const T=yield this.engine.addTrack(y),P=new h.default(e.kind,T,e);if(e.sid=T.sid,!this.engine.publisher)throw new u.UnexpectedConnectionState("publisher is closed");c.default.debug(`publishing ${e.kind} with encodings`,w,T);const C={direction:"sendonly"};w&&(C.sendEncodings=w);const E=this.engine.publisher.pc.addTransceiver(e.mediaStreamTrack,C);if(this.engine.negotiate(),e.sender=E.sender,e instanceof f.default){const t=null!==(g=null===(b=this.roomOptions)||void 0===b?void 0:b.expDisableLayerPause)&&void 0!==g&&g;e.startMonitor(this.engine.client,t)}else e instanceof p.default&&e.startMonitor();return s.videoCodec&&this.setPreferredCodec(E,e.kind,s.videoCodec),this.addTrackPublication(P),this.emit(l.ParticipantEvent.LocalTrackPublished,P),P}))}unpublishTrack(e){var t,i;const n=this.getPublicationForTrack(e);if(c.default.debug("unpublishTrack","unpublishing track",e),!n||!n.track)return c.default.warn("unpublishTrack","track was not unpublished because no publication was found",e),null;(e=n.track).off(l.TrackEvent.Muted,this.onTrackMuted),e.off(l.TrackEvent.Unmuted,this.onTrackUnmuted),e.off(l.TrackEvent.Ended,this.onTrackUnpublish),(null===(i=null===(t=this.roomOptions)||void 0===t?void 0:t.stopLocalTrackOnUnpublish)||void 0===i||i)&&e.stop();const{mediaStreamTrack:r}=e;if(this.engine.publisher){this.engine.publisher.pc.getSenders().forEach((e=>{var t;if(e.track===r)try{null===(t=this.engine.publisher)||void 0===t||t.pc.removeTrack(e),this.engine.negotiate()}catch(i){c.default.warn("unpublishTrack","failed to remove track",i)}}))}switch(this.tracks.delete(n.trackSid),n.kind){case v.Track.Kind.Audio:this.audioTracks.delete(n.trackSid);break;case v.Track.Kind.Video:this.videoTracks.delete(n.trackSid)}return n.setTrack(void 0),this.emit(l.ParticipantEvent.LocalTrackUnpublished,n),n}unpublishTracks(e){const t=[];return e.forEach((e=>{const i=this.unpublishTrack(e);i&&t.push(i)})),t}get publisherMetrics(){return null}publishData(e,t,i){return s(this,void 0,void 0,(function*(){const n=[];void 0!==i&&i.forEach((e=>{e instanceof y.default?n.push(e.sid):n.push(e)}));const r={kind:t,user:{participantSid:this.sid,payload:e,destinationSids:n}};yield this.engine.sendDataPacket(r,t)}))}setTrackSubscriptionPermissions(e,t=[]){this.engine.client.sendUpdateSubscriptionPermissions(e,t.map((e=>k.trackPermissionToProto(e))))}getPublicationForTrack(e){let t;return this.tracks.forEach((i=>{const n=i.track;n&&(e instanceof MediaStreamTrack?(n instanceof p.default||n instanceof f.default)&&n.mediaStreamTrack===e&&(t=i):e===n&&(t=i))})),t}setPreferredCodec(e,t,i){if(!("getCapabilities"in RTCRtpSender))return;const n=RTCRtpSender.getCapabilities(t);if(!n)return;const r=n.codecs.find((e=>{const t=e.mimeType.toLowerCase(),n=t===`video/${i}`;return"h264"===i&&e.sdpFmtpLine?n&&e.sdpFmtpLine.includes("profile-level-id=42e01f"):n||"audio/opus"===t}));r&&"setCodecPreferences"in e&&e.setCodecPreferences([r])}publishedTracksInfo(){const e=[];return this.tracks.forEach((t=>{void 0!==t.track&&e.push({cid:t.track.mediaStreamTrack.id,track:t.trackInfo})})),e}}t.default=w},22070:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionQuality=void 0;const n=i(17187),r=i(8983),o=i(28911),s=i(80410);var a;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Unknown="unknown"}(a=t.ConnectionQuality||(t.ConnectionQuality={}));class c extends n.EventEmitter{constructor(e,t){super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=a.Unknown,this.sid=e,this.identity=t,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){if(e!==s.Track.Source.Unknown)for(const[,t]of this.tracks){if(t.source===e)return t;if(t.source===s.Track.Source.Unknown){if(e===s.Track.Source.Microphone&&t.kind===s.Track.Kind.Audio&&"screen"!==t.trackName)return t;if(e===s.Track.Source.Camera&&t.kind===s.Track.Kind.Video&&"screen"!==t.trackName)return t;if(e===s.Track.Source.ScreenShare&&t.kind===s.Track.Kind.Video&&"screen"===t.trackName)return t;if(e===s.Track.Source.ScreenShareAudio&&t.kind===s.Track.Kind.Audio&&"screen"===t.trackName)return t}}}getTrackByName(e){for(const[,t]of this.tracks)if(t.trackName===e)return t}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrack(s.Track.Source.Camera);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrack(s.Track.Source.Microphone);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrack(s.Track.Source.ScreenShare)}get joinedAt(){return this.participantInfo?new Date(1e3*this.participantInfo.joinedAt):new Date}updateInfo(e){this.identity=e.identity,this.sid=e.sid,this.name=e.name,this.setMetadata(e.metadata),this.participantInfo=e}setMetadata(e){const t=!this.participantInfo||this.participantInfo.metadata!==e,i=this.metadata;this.metadata=e,t&&(this.emit(o.ParticipantEvent.MetadataChanged,i,this),this.emit(o.ParticipantEvent.ParticipantMetadataChanged,i,this))}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(o.ParticipantEvent.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case r.ConnectionQuality.EXCELLENT:return a.Excellent;case r.ConnectionQuality.GOOD:return a.Good;case r.ConnectionQuality.POOR:return a.Poor;default:return a.Unknown}}(e),t!==this._connectionQuality&&this.emit(o.ParticipantEvent.ConnectionQualityChanged,this._connectionQuality)}addTrackPublication(e){e.on(o.TrackEvent.Muted,(()=>{this.emit(o.ParticipantEvent.TrackMuted,e)})),e.on(o.TrackEvent.Unmuted,(()=>{this.emit(o.ParticipantEvent.TrackUnmuted,e)}));const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case s.Track.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case s.Track.Kind.Video:this.videoTracks.set(e.trackSid,e)}}}t.default=c},48792:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trackPermissionToProto=void 0,t.trackPermissionToProto=function(e){var t;if(!e.participantSid)throw new Error("Invalid track permission, missing participantSid");return{participantSid:e.participantSid,allTracks:null!==(t=e.allowAll)&&void 0!==t&&t,trackSids:e.allowedTrackSids||[]}}},51488:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(i(72662)),o=i(28911),s=n(i(35941)),a=n(i(40297)),c=n(i(466)),d=i(80410),u=n(i(22070));class l extends u.default{constructor(e,t,i){super(t,i||""),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map}static fromParticipantInfo(e,t){const i=new l(e,t.sid,t.identity);return i.updateInfo(t),i}addTrackPublication(e){super.addTrackPublication(e),e.on(o.TrackEvent.UpdateSettings,(e=>{this.signalClient.sendUpdateTrackSettings(e)})),e.on(o.TrackEvent.UpdateSubscription,(e=>{this.signalClient.sendUpdateSubscription(e)})),e.on(o.TrackEvent.Ended,(t=>{this.emit(o.ParticipantEvent.TrackUnsubscribed,t,e)}))}getTrack(e){const t=super.getTrack(e);if(t)return t}getTrackByName(e){const t=super.getTrackByName(e);if(t)return t}addSubscribedMediaTrack(e,t,i,n,a,d){let u=this.getTrackPublication(t);if(u||t.startsWith("TR")||this.tracks.forEach((t=>{u||e.kind!==t.kind.toString()||(u=t)})),!u)return 0===d?(r.default.error("could not find published track",this.sid,t),void this.emit(o.ParticipantEvent.TrackSubscriptionFailed,t)):(void 0===d&&(d=20),void setTimeout((()=>{this.addSubscribedMediaTrack(e,t,i,n,a,d-1)}),150));let l;return l="video"===e.kind?new c.default(e,t,n,a):new s.default(e,t,n),l.source=u.source,l.isMuted=u.isMuted,l.setMediaStream(i),l.start(),u.setTrack(l),this.emit(o.ParticipantEvent.TrackSubscribed,l,u),u}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){const t=this.hasMetadata;super.updateInfo(e);const i=new Map,n=new Map;e.tracks.forEach((e=>{let t=this.getTrackPublication(e.sid);if(t)t.updateInfo(e);else{const i=d.Track.kindFromProto(e.type);if(!i)return;t=new a.default(i,e.sid,e.name),t.updateInfo(e),n.set(e.sid,t),this.addTrackPublication(t)}i.set(e.sid,t)})),t&&n.forEach((e=>{this.emit(o.ParticipantEvent.TrackPublished,e)})),this.tracks.forEach((e=>{i.has(e.trackSid)||this.unpublishTrack(e.trackSid,!0)}))}unpublishTrack(e,t){const i=this.tracks.get(e);if(!i)return;switch(this.tracks.delete(e),i.kind){case d.Track.Kind.Audio:this.audioTracks.delete(e);break;case d.Track.Kind.Video:this.videoTracks.delete(e)}const{track:n}=i;if(n){const{isSubscribed:e}=i;n.stop(),i.setTrack(void 0),e&&this.emit(o.ParticipantEvent.TrackUnsubscribed,n,i)}t&&this.emit(o.ParticipantEvent.TrackUnpublished,i)}emit(e,...t){return r.default.trace("participant event",this.sid,e,...t),super.emit(e,...t)}}t.default=l},85482:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.presetsForResolution=t.determineAppropriateEncoding=t.computeVideoEncodings=t.presetsScreenShare=t.presets43=t.presets169=t.mediaTrackToLocalTrack=void 0;const r=n(i(72662)),o=i(67650),s=n(i(98669)),a=n(i(76887)),c=i(36669);t.mediaTrackToLocalTrack=function(e,t){switch(e.kind){case"audio":return new s.default(e,t);case"video":return new a.default(e,t);default:throw new o.TrackInvalidError(`unsupported track type: ${e.kind}`)}},t.presets169=[c.VideoPresets.qvga,c.VideoPresets.vga,c.VideoPresets.qhd,c.VideoPresets.hd,c.VideoPresets.fhd],t.presets43=[c.VideoPresets43.qvga,c.VideoPresets43.vga,c.VideoPresets43.qhd,c.VideoPresets43.hd,c.VideoPresets43.fhd],t.presetsScreenShare=[c.ScreenSharePresets.vga,c.ScreenSharePresets.hd_8,c.ScreenSharePresets.hd_15,c.ScreenSharePresets.fhd_15,c.ScreenSharePresets.fhd_30];const d=["q","h","f"];function u(e,t,i){const n=l(e,t,i);let{encoding:r}=n[0];const o=Math.max(t,i);for(let s=0;s<n.length;s+=1){const e=n[s];if(r=e.encoding,e.width>=o)break}return r}function l(e,i,n){if(e)return t.presetsScreenShare;const r=i>n?i/n:n/i;return Math.abs(r-16/9)<Math.abs(r-4/3)?t.presets169:t.presets43}function p(e,t,i){const n=[];return i.forEach(((i,r)=>{if(r>=d.length)return;const o=Math.min(e,t),s=d[r];n.push({rid:s,scaleResolutionDownBy:o/Math.min(i.width,i.height),maxBitrate:i.encoding.maxBitrate,maxFramerate:i.encoding.maxFramerate})})),n}t.computeVideoEncodings=function(e,t,i,n){let o=null===n||void 0===n?void 0:n.videoEncoding;e&&(o=null===n||void 0===n?void 0:n.screenShareEncoding);const s=!e&&(null===n||void 0===n?void 0:n.simulcast);if(!o&&!s||!t||!i)return[{}];if(o||(o=u(e,t,i),r.default.debug("using video encoding",o)),!s)return[o];const a=l(e,t,i);let d;const h=a[0];a.length>1&&([,d]=a);const f=new c.VideoPreset(t,i,o.maxBitrate,o.maxFramerate),m=Math.max(t,i);return p(t,i,m>=960&&d?[h,d,f]:m>=500?[h,f]:[f])},t.determineAppropriateEncoding=u,t.presetsForResolution=l},24448:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeBitrate=t.monitorFrequency=void 0,t.monitorFrequency=2e3,t.computeBitrate=function(e,t){if(!t)return 0;let i,n;return"bytesReceived"in e?(i=e.bytesReceived,n=t.bytesReceived):"bytesSent"in e&&(i=e.bytesSent,n=t.bytesSent),void 0===i||void 0===n||void 0===e.timestamp||void 0===t.timestamp?0:8*(i-n)*1e3/(e.timestamp-t.timestamp)}},98669:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(i(72662)),s=i(24448),a=r(i(35728)),c=i(80410),d=i(89565);class u extends a.default{constructor(e,t){super(e,c.Track.Kind.Audio,t),this.stopOnMute=!1,this.monitorSender=()=>n(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);const e=yield this.getSenderStats();e&&this.prevStats&&(this._currentBitrate=s.computeBitrate(e,this.prevStats)),this.prevStats=e,setTimeout((()=>{this.monitorSender()}),s.monitorFrequency)}))}setDeviceId(e){return n(this,void 0,void 0,(function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))}))}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return n(this,void 0,void 0,(function*(){return this.source===c.Track.Source.Microphone&&this.stopOnMute&&(o.default.debug("stopping mic track"),this.mediaStreamTrack.stop()),yield e.mute.call(this),this}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return n(this,void 0,void 0,(function*(){return this.source===c.Track.Source.Microphone&&this.stopOnMute&&(o.default.debug("reacquiring mic track"),yield this.restartTrack()),yield e.unmute.call(this),this}))}restartTrack(e){return n(this,void 0,void 0,(function*(){let t;if(e){const i=d.constraintsForOptions({audio:e});"boolean"!==typeof i.audio&&(t=i.audio)}yield this.restart(t)}))}startMonitor(){setTimeout((()=>{this.monitorSender()}),s.monitorFrequency)}getSenderStats(){return n(this,void 0,void 0,(function*(){if(!this.sender)return;let e;return(yield this.sender.getStats()).forEach((t=>{"outbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,packetsSent:t.packetsSent,packetsLost:t.packetsLost,bytesSent:t.bytesSent,timestamp:t.timestamp,roundTripTime:t.roundTripTime,jitter:t.jitter})})),e}))}}t.default=u},35728:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(i(72662)),s=r(i(11480)),a=i(67650),c=i(28911),d=i(80410);class u extends d.Track{constructor(e,t,i){super(e,t),this.handleEnded=()=>{this.emit(c.TrackEvent.Ended,this)},this.mediaStreamTrack.addEventListener("ended",this.handleEnded),this.constraints=null!==i&&void 0!==i?i:e.getConstraints()}get id(){return this.mediaStreamTrack.id}get dimensions(){if(this.kind!==d.Track.Kind.Video)return;const{width:e,height:t}=this.mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}getDeviceId(){return n(this,void 0,void 0,(function*(){if(this.source===d.Track.Source.ScreenShare)return;const{deviceId:e,groupId:t}=this.mediaStreamTrack.getSettings(),i=this.kind===d.Track.Kind.Audio?"audioinput":"videoinput";return s.default.getInstance().normalizeDeviceId(i,e,t)}))}mute(){return n(this,void 0,void 0,(function*(){return this.setTrackMuted(!0),this}))}unmute(){return n(this,void 0,void 0,(function*(){return this.setTrackMuted(!1),this}))}restart(e){return n(this,void 0,void 0,(function*(){if(!this.sender)throw new a.TrackInvalidError("unable to restart an unpublished track");e||(e=this.constraints),o.default.debug("restarting track with constraints",e);const t={audio:!1,video:!1};this.kind===d.Track.Kind.Video?t.video=e:t.audio=e,this.attachedElements.forEach((e=>{d.detachTrack(this.mediaStreamTrack,e)})),this.mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.mediaStreamTrack.stop();const i=(yield navigator.mediaDevices.getUserMedia(t)).getTracks()[0];return i.addEventListener("ended",this.handleEnded),o.default.debug("re-acquired MediaStreamTrack"),yield this.sender.replaceTrack(i),this.mediaStreamTrack=i,this.attachedElements.forEach((e=>{d.attachToElement(i,e)})),this.constraints=e,this}))}setTrackMuted(e){this.isMuted!==e&&(this.isMuted=e,this.mediaStreamTrack.enabled=!e,this.emit(e?c.TrackEvent.Muted:c.TrackEvent.Unmuted,this))}}t.default=u},170:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=i(28911),o=i(22184);class s extends o.TrackPublication{constructor(e,t,i){super(e,t.sid,t.name),this.handleTrackEnded=e=>{this.emit(r.TrackEvent.Ended,e)},this.updateInfo(t),this.setTrack(i)}setTrack(e){this.track&&this.track.off(r.TrackEvent.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(r.TrackEvent.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return n(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.mute()}))}unmute(){var e;return n(this,void 0,void 0,(function*(){return null===(e=this.track)||void 0===e?void 0:e.unmute()}))}}t.default=s},76887:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.videoLayersFromEncodings=t.videoQualityForRid=void 0;const o=r(i(72662)),s=i(8983),a=i(24448),c=i(71981),d=r(i(35728)),u=i(80410),l=i(89565),p=["q","h","f"];class h extends d.default{constructor(e,t){super(e,u.Track.Kind.Video,t),this.monitorSender=e=>n(this,void 0,void 0,(function*(){if(!this.sender)return void(this._currentBitrate=0);const t=yield this.getSenderStats(),i=new Map(t.map((e=>[e.rid,e])));if(!e&&this.prevStats&&this.isSimulcast&&this.checkAndUpdateSimulcast(i),this.prevStats){let e=0;i.forEach(((t,i)=>{var n;const r=null===(n=this.prevStats)||void 0===n?void 0:n.get(i);e+=a.computeBitrate(t,r)})),this._currentBitrate=e}this.prevStats=i,setTimeout((()=>{this.monitorSender(e)}),a.monitorFrequency)}))}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e,t){var i;this.signalClient=e;const n=null===(i=this.sender)||void 0===i?void 0:i.getParameters();n&&(this.encodings=n.encodings),setTimeout((()=>{this.monitorSender(t)}),a.monitorFrequency)}stop(){this.sender=void 0,this.mediaStreamTrack.getConstraints(),super.stop()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return n(this,void 0,void 0,(function*(){return this.source===u.Track.Source.Camera&&(o.default.debug("stopping camera track"),this.mediaStreamTrack.stop()),yield e.mute.call(this),this}))}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return n(this,void 0,void 0,(function*(){return this.source===u.Track.Source.Camera&&(o.default.debug("reacquiring camera track"),yield this.restartTrack()),yield e.unmute.call(this),this}))}getSenderStats(){return n(this,void 0,void 0,(function*(){if(!this.sender)return[];const e=[],t=yield this.sender.getStats();return t.forEach((i=>{var n;if("outbound-rtp"===i.type){const r={type:"video",streamId:i.id,frameHeight:i.frameHeight,frameWidth:i.frameWidth,firCount:i.firCount,pliCount:i.pliCount,nackCount:i.nackCount,packetsSent:i.packetsSent,bytesSent:i.bytesSent,framesSent:i.framesSent,timestamp:i.timestamp,rid:null!==(n=i.rid)&&void 0!==n?n:"",retransmittedPacketsSent:i.retransmittedPacketsSent,qualityLimitationReason:i.qualityLimitationReason,qualityLimitationResolutionChanges:i.qualityLimitationResolutionChanges},o=t.get(i.remoteId);o&&(r.jitter=o.jitter,r.packetsLost=o.packetsLost,r.roundTripTime=o.roundTripTime),e.push(r)}})),e}))}setPublishingQuality(e){const t=[];for(let i=s.VideoQuality.LOW;i<=s.VideoQuality.HIGH;i+=1)t.push({quality:i,enabled:i<=e});o.default.debug("setting publishing quality. max quality",e),this.setPublishingLayers(t)}setDeviceId(e){return n(this,void 0,void 0,(function*(){this.constraints.deviceId!==e&&(this.constraints.deviceId=e,this.isMuted||(yield this.restartTrack()))}))}restartTrack(e){return n(this,void 0,void 0,(function*(){let t;if(e){const i=l.constraintsForOptions({video:e});"boolean"!==typeof i.video&&(t=i.video)}yield this.restart(t)}))}setPublishingLayers(e){return n(this,void 0,void 0,(function*(){if(o.default.debug("setting publishing layers",e),!this.sender||!this.encodings)return;const t=this.sender.getParameters(),{encodings:i}=t;if(!i)return;if(i.length!==this.encodings.length)return void o.default.warn("cannot set publishing layers, encodings mismatch");this.activeQualities=e;let n=!1;i.forEach(((t,i)=>{var r;let s=null!==(r=t.rid)&&void 0!==r?r:"";""===s&&(s="q");const a=f(s),d=e.find((e=>e.quality===a));d&&t.active!==d.enabled&&(n=!0,t.active=d.enabled,o.default.debug(`setting layer ${d.quality} to ${t.active?"enabled":"disabled"}`),c.isFireFox()&&(d.enabled?(t.scaleResolutionDownBy=this.encodings[i].scaleResolutionDownBy,t.maxBitrate=this.encodings[i].maxBitrate,t.maxFrameRate=this.encodings[i].maxFrameRate):(t.scaleResolutionDownBy=4,t.maxBitrate=10,t.maxFrameRate=2)))})),n&&(t.encodings=i,yield this.sender.setParameters(t))}))}checkAndUpdateSimulcast(e){var t,i;if(!this.sender||this.isMuted||!this.encodings)return;let n;const{encodings:r}=this.sender.getParameters();if(r.forEach((e=>{e.active&&(void 0===n||n.rid&&e.rid&&p.indexOf(n.rid)<p.indexOf(e.rid)||void 0!==n.maxBitrate&&void 0!==e.maxBitrate&&n.maxBitrate<e.maxBitrate)&&(n=e)})),!n)return;const a=null!==(t=n.rid)&&void 0!==t?t:"",c=e.get(a),d=null===(i=this.prevStats)||void 0===i?void 0:i.get(a);if(!c||!d)return;const u=f(a);if(c.qualityLimitationResolutionChanges-d.qualityLimitationResolutionChanges>0&&(this.lastQualityChange=(new Date).getTime()),c.framesSent-d.framesSent>0){if(u===s.VideoQuality.HIGH||!this.lastQualityChange)return;const e=u+1;if((new Date).getTime()-this.lastQualityChange<6e4)return;if(this.activeQualities&&this.activeQualities.some((t=>t.quality===e&&!t.enabled)))return;let t=s.VideoQuality.LOW;if(r.forEach((e=>{var i;const n=f(null!==(i=e.rid)&&void 0!==i?i:"");n>t&&(t=n)})),e>t)return;return o.default.debug("upgrading video quality to",e),void this.setPublishingQuality(e)}0!==c.framesSent&&(this.lastExplicitQualityChange&&(new Date).getTime()-this.lastExplicitQualityChange<5e3||u!==s.VideoQuality.UNRECOGNIZED&&u!==s.VideoQuality.LOW&&(o.default.debug("downgrading video quality to",u-1),this.setPublishingQuality(u-1)))}}function f(e){switch(e){case"f":return s.VideoQuality.HIGH;case"h":return s.VideoQuality.MEDIUM;case"q":return s.VideoQuality.LOW;default:return s.VideoQuality.UNRECOGNIZED}}t.default=h,t.videoQualityForRid=f,t.videoLayersFromEncodings=function(e,t,i){return i?i.map((n=>{var r,o,a;const c=null!==(r=n.scaleResolutionDownBy)&&void 0!==r?r:1;let d=f(null!==(o=n.rid)&&void 0!==o?o:"");return d===s.VideoQuality.UNRECOGNIZED&&1===i.length&&(d=s.VideoQuality.HIGH),{quality:d,width:e/c,height:t/c,bitrate:null!==(a=n.maxBitrate)&&void 0!==a?a:0,ssrc:0}})):[{quality:s.VideoQuality.HIGH,width:e,height:t,bitrate:0,ssrc:0}]}},35941:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(24448),s=r(i(65785)),a=i(80410);class c extends s.default{constructor(e,t,i){super(e,t,a.Track.Kind.Audio,i),this.monitorReceiver=()=>n(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=o.computeBitrate(e,this.prevStats)),this.prevStats=e,setTimeout((()=>{this.monitorReceiver()}),o.monitorFrequency)}))}getReceiverStats(){return n(this,void 0,void 0,(function*(){if(!this.receiver)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"audio",timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})})),e}))}}t.default=c},65785:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(28911),r=i(24448),o=i(80410);class s extends o.Track{constructor(e,t,i,n){super(e,i),this.sid=t,this.receiver=n}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this.emit(e?n.TrackEvent.Muted:n.TrackEvent.Unmuted,this))}setMediaStream(e){e.onremovetrack=()=>{this.receiver=void 0,this._currentBitrate=0,this.emit(n.TrackEvent.Ended,this)}}start(){this.startMonitor(),super.enable()}stop(){super.disable()}startMonitor(){setTimeout((()=>{this.monitorReceiver()}),r.monitorFrequency)}}t.default=s},40297:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=n(i(72662)),o=i(8983),s=i(44658),a=i(28911),c=n(i(466)),d=i(22184);class u extends d.TrackPublication{constructor(){super(...arguments),this._allowed=!0,this.disabled=!1,this.currentVideoQuality=o.VideoQuality.HIGH,this.handleEnded=e=>{this.emit(a.TrackEvent.Ended,e)},this.handleVisibilityChange=e=>{r.default.debug("adaptivestream video visibility",this.trackSid,`visible=${e}`),this.disabled=!e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{r.default.debug("adaptivestream video dimensions",this.trackSid,`${e.width}x${e.height}`),this.videoDimensions=e,this.emitTrackUpdate()}}setSubscribed(e){this.subscribed=e;const t={trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[]};this.emit(a.TrackEvent.UpdateSubscription,t)}get subscriptionStatus(){return!1!==this.subscribed&&super.isSubscribed?this._allowed?d.TrackPublication.SubscriptionStatus.Subscribed:d.TrackPublication.SubscriptionStatus.NotAllowed:d.TrackPublication.SubscriptionStatus.Unsubscribed}get isSubscribed(){return!1!==this.subscribed&&(!!this._allowed&&super.isSubscribed)}get isEnabled(){return!this.disabled}setEnabled(e){this.isManualOperationAllowed()&&this.disabled!==!e&&(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.currentVideoQuality!==e&&(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,i;this.isManualOperationAllowed()&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(i=this.videoDimensions)||void 0===i?void 0:i.height)===e.height||(this.track instanceof c.default&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}get videoQuality(){return this.currentVideoQuality}setTrack(e){this.track&&(this.track.off(a.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),this.track.off(a.TrackEvent.VisibilityChanged,this.handleVisibilityChange),this.track.off(a.TrackEvent.Ended,this.handleEnded)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(a.TrackEvent.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(a.TrackEvent.VisibilityChanged,this.handleVisibilityChange),e.on(a.TrackEvent.Ended,this.handleEnded))}updateInfo(e){var t;super.updateInfo(e),this.metadataMuted=e.muted,null===(t=this.track)||void 0===t||t.setMuted(e.muted)}isManualOperationAllowed(){return this.isAdaptiveStream?(r.default.warn("adaptive stream is enabled, cannot change track settings",this.trackSid),!1):!!this.isSubscribed||(r.default.warn("cannot update track settings when not subscribed",this.trackSid),!1)}get isAdaptiveStream(){return this.track instanceof c.default&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=s.UpdateTrackSettings.fromPartial({trackSids:[this.trackSid],disabled:this.disabled});this.videoDimensions?(e.width=this.videoDimensions.width,e.height=this.videoDimensions.height):void 0!==this.currentVideoQuality?e.quality=this.currentVideoQuality:e.quality=o.VideoQuality.HIGH,this.emit(a.TrackEvent.UpdateSettings,e)}}t.default=u},466:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(2938),s=i(28911),a=i(24448),c=i(71981),d=r(i(65785)),u=i(80410);class l extends d.default{constructor(e,t,i,r){super(e,t,u.Track.Kind.Video,i),this.elementInfos=[],this.monitorReceiver=()=>n(this,void 0,void 0,(function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=a.computeBitrate(e,this.prevStats)),this.prevStats=e,setTimeout((()=>{this.monitorReceiver()}),a.monitorFrequency)})),this.handleVisibilityChanged=e=>{const{target:t,isIntersecting:i}=e,n=this.elementInfos.find((e=>e.element===t));n&&(n.visible=i,n.visibilityChangedAt=Date.now()),this.updateVisibility()},this.debouncedHandleResize=o.debounce((()=>{this.updateDimensions()}),100),this.adaptiveStream=r}get isAdaptiveStream(){var e;return null!==(e=this.adaptiveStream)&&void 0!==e&&e}setMuted(e){super.setMuted(e),this.attachedElements.forEach((t=>{e?u.detachTrack(this.mediaStreamTrack,t):u.attachToElement(this.mediaStreamTrack,t)}))}attach(e){return e?super.attach(e):e=super.attach(),this.adaptiveStream&&(this.elementInfos.push({element:e,visible:!0}),e.handleResize=this.debouncedHandleResize,e.handleVisibilityChanged=this.handleVisibilityChanged,c.getIntersectionObserver().observe(e),c.getResizeObserver().observe(e)),e}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const i of t)this.stopObservingElement(i);return t}getReceiverStats(){return n(this,void 0,void 0,(function*(){if(!this.receiver)return;let e;return(yield this.receiver.getStats()).forEach((t=>{"inbound-rtp"===t.type&&(e={type:"video",framesDecoded:t.framesDecoded,framesDropped:t.framesDropped,framesReceived:t.framesReceived,packetsReceived:t.packetsReceived,packetsLost:t.packetsLost,frameWidth:t.frameWidth,frameHeight:t.frameHeight,pliCount:t.pliCount,firCount:t.firCount,nackCount:t.nackCount,jitter:t.jitter,timestamp:t.timestamp,bytesReceived:t.bytesReceived})})),e}))}stopObservingElement(e){var t,i;null===(t=c.getIntersectionObserver())||void 0===t||t.unobserve(e),null===(i=c.getResizeObserver())||void 0===i||i.unobserve(e),this.elementInfos=this.elementInfos.filter((t=>t.element!==e))}updateVisibility(){const e=this.elementInfos.reduce(((e,t)=>Math.max(e,t.visibilityChangedAt||0)),0),t=this.elementInfos.some((e=>e.visible));this.lastVisible!==t&&(!t&&Date.now()-e<100?setTimeout((()=>{this.updateVisibility()}),Date.now()-e):(this.lastVisible=t,this.emit(s.TrackEvent.VisibilityChanged,t,this)))}updateDimensions(){var e,t;let i=0,n=0;for(const r of this.elementInfos)r.visible&&r.element.clientWidth+r.element.clientHeight>i+n&&(i=r.element.clientWidth,n=r.element.clientHeight);(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===i&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===n||(this.lastDimensions={width:i,height:n},this.emit(s.TrackEvent.VideoDimensionsChanged,this.lastDimensions,this))}}t.default=l},80410:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detachTrack=t.attachToElement=t.Track=void 0;const n=i(17187),r=i(8983),o=i(44658),s=i(28911),a=i(71981),c=[];class d extends n.EventEmitter{constructor(e,t){super(),this.attachedElements=[],this.isMuted=!1,this.streamState=d.StreamState.Active,this._currentBitrate=0,this.kind=t,this.mediaStreamTrack=e,this.source=d.Source.Unknown}get currentBitrate(){return this._currentBitrate}attach(e){let t="audio";return this.kind===d.Kind.Video&&(t="video"),e||("audio"===t&&(c.forEach((t=>{null!==t.parentElement||e||(e=t)})),e&&c.splice(c.indexOf(e),1)),e||(e=document.createElement(t))),e instanceof HTMLVideoElement&&(e.playsInline=!0,e.autoplay=!0),this.attachedElements.includes(e)||(u(this.mediaStreamTrack,e),this.attachedElements.push(e),e instanceof HTMLAudioElement&&e.play().then((()=>{this.emit(s.TrackEvent.AudioPlaybackStarted)})).catch((e=>{this.emit(s.TrackEvent.AudioPlaybackFailed,e)}))),e}detach(e){if(e){l(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e)),e}const t=[];return this.attachedElements.forEach((e=>{l(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e)})),this.attachedElements=[],t}stop(){this.mediaStreamTrack.stop()}enable(){this.mediaStreamTrack.enabled=!0}disable(){this.mediaStreamTrack.enabled=!1}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),c.forEach((e=>{e.parentElement||(t=!1)})),t&&c.push(e)}}}function u(e,t){let i,n;t.srcObject instanceof MediaStream?i=t.srcObject:(i=new MediaStream,t.srcObject=i),n="audio"===e.kind?i.getAudioTracks():i.getVideoTracks(),n.forEach((e=>{i.removeTrack(e)})),i.addTrack(e),a.isFireFox()&&setTimeout((()=>{t.srcObject=i}),1)}function l(e,t){if(t.srcObject instanceof MediaStream){t.srcObject.removeTrack(e),t.srcObject=null}}t.Track=d,t.attachToElement=u,t.detachTrack=l,function(e){let t,i,n;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(i=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(n=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return r.TrackType.AUDIO;case t.Video:return r.TrackType.VIDEO;default:return r.TrackType.UNRECOGNIZED}},e.kindFromProto=function(e){switch(e){case r.TrackType.AUDIO:return t.Audio;case r.TrackType.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case i.Camera:return r.TrackSource.CAMERA;case i.Microphone:return r.TrackSource.MICROPHONE;case i.ScreenShare:return r.TrackSource.SCREEN_SHARE;case i.ScreenShareAudio:return r.TrackSource.SCREEN_SHARE_AUDIO;default:return r.TrackSource.UNRECOGNIZED}},e.sourceFromProto=function(e){switch(e){case r.TrackSource.CAMERA:return i.Camera;case r.TrackSource.MICROPHONE:return i.Microphone;case r.TrackSource.SCREEN_SHARE:return i.ScreenShare;case r.TrackSource.SCREEN_SHARE_AUDIO:return i.ScreenShareAudio;default:return i.Unknown}},e.streamStateFromProto=function(e){switch(e){case o.StreamState.ACTIVE:return n.Active;case o.StreamState.PAUSED:return n.Paused;default:return n.Unknown}}}(d=t.Track||(t.Track={}))},22184:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackPublication=void 0;const r=i(17187),o=i(28911),s=n(i(98669)),a=n(i(76887)),c=n(i(35941)),d=n(i(466)),u=i(80410);class l extends r.EventEmitter{constructor(e,t,i){super(),this.metadataMuted=!1,this.handleMuted=()=>{this.emit(o.TrackEvent.Muted)},this.handleUnmuted=()=>{this.emit(o.TrackEvent.Unmuted)},this.kind=e,this.trackSid=t,this.trackName=i,this.source=u.Track.Source.Unknown}setTrack(e){this.track&&(this.track.off(o.TrackEvent.Muted,this.handleMuted),this.track.off(o.TrackEvent.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(o.TrackEvent.Muted,this.handleMuted),e.on(o.TrackEvent.Unmuted,this.handleUnmuted))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get audioTrack(){if(this.track instanceof s.default||this.track instanceof c.default)return this.track}get videoTrack(){if(this.track instanceof a.default||this.track instanceof d.default)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=u.Track.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===u.Track.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.trackInfo=e}}t.TrackPublication=l,function(e){let t;!function(e){e.Subscribed="subscribed",e.NotAllowed="not_allowed",e.Unsubscribed="unsubscribed"}(t=e.SubscriptionStatus||(e.SubscriptionStatus={}))}(l=t.TrackPublication||(t.TrackPublication={}))},60119:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalScreenTracks=t.createLocalAudioTrack=t.createLocalVideoTrack=t.createLocalTracks=void 0;const o=i(67650),s=i(85482),a=i(21442),c=r(i(98669)),d=r(i(76887)),u=i(36669),l=i(80410),p=i(89565);function h(e){var t,i;return n(this,void 0,void 0,(function*(){null!==e&&void 0!==e||(e={}),null!==(t=e.audio)&&void 0!==t||(e.audio=!0),null!==(i=e.video)&&void 0!==i||(e.video=!0);const n=p.mergeDefaultOptions(e,a.audioDefaults,a.videoDefaults),r=p.constraintsForOptions(n);return(yield navigator.mediaDevices.getUserMedia(r)).getTracks().map((t=>{const i="audio"===t.kind;let n,o=i?e.audio:e.video;"boolean"!==typeof o&&o||(o={});const a=i?r.audio:r.video;"boolean"!==typeof a&&(n=a);const c=s.mediaTrackToLocalTrack(t,n);return c.kind===l.Track.Kind.Video?c.source=l.Track.Source.Camera:c.kind===l.Track.Kind.Audio&&(c.source=l.Track.Source.Microphone),c}))}))}t.createLocalTracks=h,t.createLocalVideoTrack=function(e){return n(this,void 0,void 0,(function*(){return(yield h({audio:!1,video:e}))[0]}))},t.createLocalAudioTrack=function(e){return n(this,void 0,void 0,(function*(){return(yield h({audio:e,video:!1}))[0]}))},t.createLocalScreenTracks=function(e){var t;return n(this,void 0,void 0,(function*(){void 0===e&&(e={}),void 0===e.resolution&&(e.resolution=u.VideoPresets.fhd.resolution);let i=!0;e.resolution&&(i={width:e.resolution.width,height:e.resolution.height});const n=yield navigator.mediaDevices.getDisplayMedia({audio:null!==(t=e.audio)&&void 0!==t&&t,video:i}),r=n.getVideoTracks();if(0===r.length)throw new o.TrackInvalidError("no video track found");const s=new d.default(r[0]);s.source=l.Track.Source.ScreenShare;const a=[s];if(n.getAudioTracks().length>0){const e=new c.default(n.getAudioTracks()[0]);e.source=l.Track.Source.ScreenShareAudio,a.push(e)}return a}))}},21442:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.videoDefaults=t.audioDefaults=t.publishDefaults=void 0;const n=i(36669);t.publishDefaults={audioBitrate:n.AudioPresets.speech.maxBitrate,dtx:!0,simulcast:!0,screenShareEncoding:n.ScreenSharePresets.hd_15.encoding,stopMicTrackOnMute:!1},t.audioDefaults={autoGainControl:!0,channelCount:1,echoCancellation:!0,noiseSuppression:!0},t.videoDefaults={resolution:n.VideoPresets.qhd.resolution}},36669:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenSharePresets=t.VideoPresets43=t.VideoPresets=t.AudioPresets=t.VideoPreset=void 0;class i{constructor(e,t,i,n){this.width=e,this.height=t,this.encoding={maxBitrate:i,maxFramerate:n}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}t.VideoPreset=i,function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3}}(t.AudioPresets||(t.AudioPresets={})),t.VideoPresets={qvga:new i(320,180,12e4,10),vga:new i(640,360,3e5,20),qhd:new i(960,540,6e5,25),hd:new i(1280,720,2e6,30),fhd:new i(1920,1080,3e6,30)},t.VideoPresets43={qvga:new i(240,180,9e4,10),vga:new i(480,360,225e3,20),qhd:new i(720,540,45e4,25),hd:new i(960,720,15e5,30),fhd:new i(1440,1080,28e5,30)},t.ScreenSharePresets={vga:new i(640,360,2e5,3),hd_8:new i(1280,720,4e5,5),hd_15:new i(1280,720,1e6,15),fhd_15:new i(1920,1080,15e5,15),fhd_30:new i(1920,1080,3e6,30)}},55884:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},89565:function(e,t){"use strict";function i(e,t){return Object.keys(t).forEach((i=>{void 0===e[i]&&(e[i]=t[i])})),e}Object.defineProperty(t,"__esModule",{value:!0}),t.constraintsForOptions=t.mergeDefaultOptions=void 0,t.mergeDefaultOptions=function(e,t,n){const r=Object.assign({},e);return!0===r.audio&&(r.audio={}),!0===r.video&&(r.video={}),r.audio&&i(r.audio,t),r.video&&i(r.video,n),r},t.constraintsForOptions=function(e){const t={};if(e.video)if("object"===typeof e.video){const n={},r=n,o=e.video;Object.keys(o).forEach((e=>{switch(e){case"resolution":i(r,o.resolution);break;default:r[e]=o[e]}})),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?"object"===typeof e.audio?t.audio=e.audio:t.audio=!0:t.audio=!1,t}},71981:function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getClientInfo=t.getIntersectionObserver=t.getResizeObserver=t.isFireFox=t.sleep=t.unpackStreamId=void 0;const o=r(i(42238)),s=i(8983),a=i(36942);function c(e){for(const t of e)t.target.handleResize(t)}function d(e){for(const t of e)t.target.handleVisibilityChanged(t)}t.unpackStreamId=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]},t.sleep=function(e){return n(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))},t.isFireFox=function(){return-1!==navigator.userAgent.indexOf("Firefox")};let u=null;t.getResizeObserver=()=>(u||(u=new ResizeObserver(c)),u);let l=null;t.getIntersectionObserver=()=>(l||(l=new IntersectionObserver(d)),l),t.getClientInfo=function(){const e=o.default(navigator.userAgent),t=s.ClientInfo.fromPartial({sdk:s.ClientInfo_SDK.JS,protocol:a.protocolVersion,version:a.version,os:e.os.name,osVersion:e.os.version,browser:e.browser.name,browserVersion:e.browser.version});let i="";return e.device.vendor&&(i+=e.device.vendor),e.device.model&&(i&&(i+=" "),i+=e.device.model),i&&(t.deviceModel=i),t}},36942:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.protocolVersion=t.version=void 0,t.version="0.15.4",t.protocolVersion=5},2043:function(e,t,i){var n,r;!function(o,s){"use strict";void 0===(r="function"===typeof(n=function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function r(e,t){var i=e[t];if("function"===typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(n){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function o(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&i?o:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):e)}function a(t,i){for(var r=0;r<n.length;r++){var o=n[r];this[o]=r<t?e:this.methodFactory(o,t,i)}this.log=this.debug}function c(e,i,n){return function(){typeof console!==t&&(a.call(this,i,n),this[e].apply(this,arguments))}}function d(e,t,i){return s(e)||c.apply(this,arguments)}function u(e,i,r){var o,s=this;i=null==i?"WARN":i;var c="loglevel";function u(e){var i=(n[e]||"silent").toUpperCase();if(typeof window!==t&&c){try{return void(window.localStorage[c]=i)}catch(r){}try{window.document.cookie=encodeURIComponent(c)+"="+i+";"}catch(r){}}}function l(){var e;if(typeof window!==t&&c){try{e=window.localStorage[c]}catch(r){}if(typeof e===t)try{var i=window.document.cookie,n=i.indexOf(encodeURIComponent(c)+"=");-1!==n&&(e=/^([^;]+)/.exec(i.slice(n))[1])}catch(r){}return void 0===s.levels[e]&&(e=void 0),e}}function p(){if(typeof window!==t&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}"string"===typeof e?c+=":"+e:"symbol"===typeof e&&(c=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=r||d,s.getLevel=function(){return o},s.setLevel=function(i,n){if("string"===typeof i&&void 0!==s.levels[i.toUpperCase()]&&(i=s.levels[i.toUpperCase()]),!("number"===typeof i&&i>=0&&i<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(o=i,!1!==n&&u(i),a.call(s,i,e),typeof console===t&&i<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){i=e,l()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(i,!1),p()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var h=l();null==h&&(h=i),s.setLevel(h,!1)}var l=new u,p={};l.getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=p[e];return t||(t=p[e]=new u(e,l.getLevel(),l.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=h),l},l.getLoggers=function(){return p},l.default=l,l})?n.call(t,i,t,e):n)||(e.exports=r)}()},43720:function(e){e.exports=i;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(C){}function i(e,t,i){this.low=0|e,this.high=0|t,this.unsigned=!!i}function n(e){return!0===(e&&e.__isLong__)}i.prototype.__isLong__,Object.defineProperty(i.prototype,"__isLong__",{value:!0}),i.isLong=n;var r={},o={};function s(e,t){var i,n,s;return t?(s=0<=(e>>>=0)&&e<256)&&(n=o[e])?n:(i=c(e,(0|e)<0?-1:0,!0),s&&(o[e]=i),i):(s=-128<=(e|=0)&&e<128)&&(n=r[e])?n:(i=c(e,e<0?-1:0,!1),s&&(r[e]=i),i)}function a(e,t){if(isNaN(e))return t?b:v;if(t){if(e<0)return b;if(e>=h)return w}else{if(e<=-f)return T;if(e+1>=f)return y}return e<0?a(-e,t).neg():c(e%p|0,e/p|0,t)}function c(e,t,n){return new i(e,t,n)}i.fromInt=s,i.fromNumber=a,i.fromBits=c;var d=Math.pow;function u(e,t,i){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return v;if("number"===typeof t?(i=t,t=!1):t=!!t,(i=i||10)<2||36<i)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return u(e.substring(1),t,i).neg();for(var r=a(d(i,8)),o=v,s=0;s<e.length;s+=8){var c=Math.min(8,e.length-s),l=parseInt(e.substring(s,s+c),i);if(c<8){var p=a(d(i,c));o=o.mul(p).add(a(l))}else o=(o=o.mul(r)).add(a(l))}return o.unsigned=t,o}function l(e,t){return"number"===typeof e?a(e,t):"string"===typeof e?u(e,t):c(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}i.fromString=u,i.fromValue=l;var p=4294967296,h=p*p,f=h/2,m=s(1<<24),v=s(0);i.ZERO=v;var b=s(0,!0);i.UZERO=b;var g=s(1);i.ONE=g;var k=s(1,!0);i.UONE=k;var S=s(-1);i.NEG_ONE=S;var y=c(-1,2147483647,!1);i.MAX_VALUE=y;var w=c(-1,-1,!0);i.MAX_UNSIGNED_VALUE=w;var T=c(0,-2147483648,!1);i.MIN_VALUE=T;var P=i.prototype;P.toInt=function(){return this.unsigned?this.low>>>0:this.low},P.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},P.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var t=a(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var r=a(d(e,6),this.unsigned),o=this,s="";;){var c=o.div(r),u=(o.sub(c.mul(r)).toInt()>>>0).toString(e);if((o=c).isZero())return u+s;for(;u.length<6;)u="0"+u;s=""+u+s}},P.getHighBits=function(){return this.high},P.getHighBitsUnsigned=function(){return this.high>>>0},P.getLowBits=function(){return this.low},P.getLowBitsUnsigned=function(){return this.low>>>0},P.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},P.isZero=function(){return 0===this.high&&0===this.low},P.eqz=P.isZero,P.isNegative=function(){return!this.unsigned&&this.high<0},P.isPositive=function(){return this.unsigned||this.high>=0},P.isOdd=function(){return 1===(1&this.low)},P.isEven=function(){return 0===(1&this.low)},P.equals=function(e){return n(e)||(e=l(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},P.eq=P.equals,P.notEquals=function(e){return!this.eq(e)},P.neq=P.notEquals,P.ne=P.notEquals,P.lessThan=function(e){return this.comp(e)<0},P.lt=P.lessThan,P.lessThanOrEqual=function(e){return this.comp(e)<=0},P.lte=P.lessThanOrEqual,P.le=P.lessThanOrEqual,P.greaterThan=function(e){return this.comp(e)>0},P.gt=P.greaterThan,P.greaterThanOrEqual=function(e){return this.comp(e)>=0},P.gte=P.greaterThanOrEqual,P.ge=P.greaterThanOrEqual,P.compare=function(e){if(n(e)||(e=l(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},P.comp=P.compare,P.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(g)},P.neg=P.negate,P.add=function(e){n(e)||(e=l(e));var t=this.high>>>16,i=65535&this.high,r=this.low>>>16,o=65535&this.low,s=e.high>>>16,a=65535&e.high,d=e.low>>>16,u=0,p=0,h=0,f=0;return h+=(f+=o+(65535&e.low))>>>16,p+=(h+=r+d)>>>16,u+=(p+=i+a)>>>16,u+=t+s,c((h&=65535)<<16|(f&=65535),(u&=65535)<<16|(p&=65535),this.unsigned)},P.subtract=function(e){return n(e)||(e=l(e)),this.add(e.neg())},P.sub=P.subtract,P.multiply=function(e){if(this.isZero())return v;if(n(e)||(e=l(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return v;if(this.eq(T))return e.isOdd()?T:v;if(e.eq(T))return this.isOdd()?T:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return a(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,r=65535&this.high,o=this.low>>>16,s=65535&this.low,d=e.high>>>16,u=65535&e.high,p=e.low>>>16,h=65535&e.low,f=0,b=0,g=0,k=0;return g+=(k+=s*h)>>>16,b+=(g+=o*h)>>>16,g&=65535,b+=(g+=s*p)>>>16,f+=(b+=r*h)>>>16,b&=65535,f+=(b+=o*p)>>>16,b&=65535,f+=(b+=s*u)>>>16,f+=i*h+r*p+o*u+s*d,c((g&=65535)<<16|(k&=65535),(f&=65535)<<16|(b&=65535),this.unsigned)},P.mul=P.multiply,P.divide=function(e){if(n(e)||(e=l(e)),e.isZero())throw Error("division by zero");var i,r,o;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return k;o=b}else{if(this.eq(T))return e.eq(g)||e.eq(S)?T:e.eq(T)?g:(i=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?g:S:(r=this.sub(e.mul(i)),o=i.add(r.div(e)));if(e.eq(T))return this.unsigned?b:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=v}for(r=this;r.gte(e);){i=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(i)/Math.LN2),u=s<=48?1:d(2,s-48),p=a(i),h=p.mul(e);h.isNegative()||h.gt(r);)h=(p=a(i-=u,this.unsigned)).mul(e);p.isZero()&&(p=g),o=o.add(p),r=r.sub(h)}return o},P.div=P.divide,P.modulo=function(e){return n(e)||(e=l(e)),t?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},P.mod=P.modulo,P.rem=P.modulo,P.not=function(){return c(~this.low,~this.high,this.unsigned)},P.and=function(e){return n(e)||(e=l(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},P.or=function(e){return n(e)||(e=l(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},P.xor=function(e){return n(e)||(e=l(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},P.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},P.shl=P.shiftLeft,P.shiftRight=function(e){return n(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},P.shr=P.shiftRight,P.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},P.shru=P.shiftRightUnsigned,P.shr_u=P.shiftRightUnsigned,P.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},P.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},P.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},P.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},P.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},i.fromBytes=function(e,t,n){return n?i.fromBytesLE(e,t):i.fromBytesBE(e,t)},i.fromBytesLE=function(e,t){return new i(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},i.fromBytesBE=function(e,t){return new i(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},75093:function(e,t,i){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i.d(t,{Z:function(){return n}})},40355:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});var n=i(75093);function r(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?(0,n.Z)(e,t):void 0}}},62100:function(e,t,i){"use strict";e.exports=i(89482)},89482:function(e,t,i){"use strict";var n=t;function r(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=i(41173),n.BufferWriter=i(43155),n.Reader=i(51408),n.BufferReader=i(50593),n.util=i(99693),n.rpc=i(35994),n.roots=i(85054),n.configure=r,r()},51408:function(e,t,i){"use strict";e.exports=c;var n,r=i(99693),o=r.LongBits,s=r.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var d="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")},u=function(){return r.Buffer?function(e){return(c.create=function(e){return r.Buffer.isBuffer(e)?new n(e):d(e)})(e)}:d};function l(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function h(){if(this.pos+8>this.len)throw a(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=u(),c.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,c.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return e}}(),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},c.prototype.string=function(){var e=this.bytes();return s.read(e,0,e.length)},c.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e,c.create=u(),n._configure();var t=r.Long?"toLong":"toNumber";r.merge(c.prototype,{int64:function(){return l.call(this)[t](!1)},uint64:function(){return l.call(this)[t](!0)},sint64:function(){return l.call(this).zzDecode()[t](!1)},fixed64:function(){return h.call(this)[t](!0)},sfixed64:function(){return h.call(this)[t](!1)}})}},50593:function(e,t,i){"use strict";e.exports=o;var n=i(51408);(o.prototype=Object.create(n.prototype)).constructor=o;var r=i(99693);function o(e){n.call(this,e)}o._configure=function(){r.Buffer&&(o.prototype._slice=r.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},85054:function(e){"use strict";e.exports={}},35994:function(e,t,i){"use strict";t.Service=i(77948)},77948:function(e,t,i){"use strict";e.exports=r;var n=i(99693);function r(e,t,i){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,i,r,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return n.asPromise(e,a,t,i,r,o);if(a.rpcImpl)try{return a.rpcImpl(t,i[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,i){if(e)return a.emit("error",e,t),s(e);if(null!==i){if(!(i instanceof r))try{i=r[a.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return a.emit("error",e,t),s(e)}return a.emit("data",i,t),s(null,i)}a.end(!0)}))}catch(c){return a.emit("error",c,t),void setTimeout((function(){s(c)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:function(e,t,i){"use strict";e.exports=r;var n=i(99693);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=r.zero=new r(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new r(i,n)},r.from=function(e){if("number"===typeof e)return r.fromNumber(e);if(n.isString(e)){if(!n.Long)return r.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):o},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;r.fromHash=function(e){return e===s?o:new r((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},99693:function(e,t,i){"use strict";var n=t;function r(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;++r)void 0!==e[n[r]]&&i||(e[n[r]]=t[n[r]]);return e}function o(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&r(this,i)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=i(34537),n.base64=i(97419),n.EventEmitter=i(19211),n.float=i(10945),n.inquire=i(67199),n.utf8=i(94997),n.pool=i(76662),n.LongBits=i(1945),n.isNode=Boolean("undefined"!==typeof i.g&&i.g&&i.g.process&&i.g.process.versions&&i.g.process.versions.node),n.global=n.isNode&&i.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"===typeof e||e instanceof String},n.isObject=function(e){return e&&"object"===typeof e},n.isset=n.isSet=function(e,t){var i=e[t];return!(null==i||!e.hasOwnProperty(t))&&("object"!==typeof i||(Array.isArray(i)?i.length:Object.keys(i).length)>0)},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"===typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&void 0!==this[e[i]]&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},41173:function(e,t,i){"use strict";e.exports=l;var n,r=i(99693),o=r.LongBits,s=r.base64,a=r.utf8;function c(e,t,i){this.fn=e,this.len=t,this.next=void 0,this.val=i}function d(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function l(){this.len=0,this.head=new c(d,0,0),this.tail=this.head,this.states=null}var p=function(){return r.Buffer?function(){return(l.create=function(){return new n})()}:function(){return new l}};function h(e,t,i){t[i]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function v(e,t,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24}l.create=p(),l.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(l.alloc=r.pool(l.alloc,r.Array.prototype.subarray)),l.prototype._push=function(e,t,i){return this.tail=this.tail.next=new c(e,t,i),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},l.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},l.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},l.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},l.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},l.prototype.int64=l.prototype.uint64,l.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},l.prototype.bool=function(e){return this._push(h,1,e?1:0)},l.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},l.prototype.sfixed32=l.prototype.fixed32,l.prototype.fixed64=function(e){var t=o.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},l.prototype.sfixed64=l.prototype.fixed64,l.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},l.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var b=r.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};l.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(r.isString(e)){var i=l.alloc(t=s.length(e));s.decode(e,i,0),e=i}return this.uint32(t)._push(b,t,e)},l.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(h,1,0)},l.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(d,0,0),this.len=0,this},l.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(d,0,0),this.len=0),this},l.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},l.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},l._configure=function(e){n=e,l.create=p(),n._configure()}},43155:function(e,t,i){"use strict";e.exports=o;var n=i(41173);(o.prototype=Object.create(n.prototype)).constructor=o;var r=i(99693);function o(){n.call(this)}function s(e,t,i){e.length<40?r.utf8.write(e,t,i):t.utf8Write?t.utf8Write(e,i):t.write(e,i)}o._configure=function(){o.alloc=r._Buffer_allocUnsafe,o.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}},o.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=r.Buffer.byteLength(e);return this.uint32(t),t&&this._push(s,t,e),this},o._configure()},57539:function(e){"use strict";const t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const i=t.splitSections(e);return i&&i[0]},t.getMediaSections=function(e){const i=t.splitSections(e);return i.shift(),i},t.matchPrefix=function(e,i){return t.splitLines(e).filter((e=>0===e.indexOf(i)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const i={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let n=8;n<t.length;n+=2)switch(t[n]){case"raddr":i.relatedAddress=t[n+1];break;case"rport":i.relatedPort=parseInt(t[n+1],10);break;case"tcptype":i.tcpType=t[n+1];break;case"ufrag":i.ufrag=t[n+1],i.usernameFragment=t[n+1];break;default:void 0===i[t[n]]&&(i[t[n]]=t[n+1])}return i},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const i=e.component;"rtp"===i?t.push(1):"rtcp"===i?t.push(2):t.push(i),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){let t=e.substr(9).split(" ");const i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){const t={};let i;const n=e.substr(e.indexOf(" ")+1).split(";");for(let r=0;r<n.length;r++)i=n[r].trim().split("="),t[i[0].trim()]=i[1];return t},t.writeFmtp=function(e){let t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+i+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),i={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return n>-1?(i.attribute=e.substr(t+1,n-t-1),i.value=e.substr(n+1)):i.attribute=e.substr(t+1),i},t.parseSsrcGroup=function(e){const t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const i=t.matchPrefix(e,"a=mid:")[0];if(i)return i.substr(6)},t.parseFingerprint=function(e){const t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,i){return{role:"auto",fingerprints:t.matchPrefix(e+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},t.parseCryptoLine=function(e){const t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,i){return t.matchPrefix(e+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,i){const n=t.matchPrefix(e+i,"a=ice-ufrag:")[0],r=t.matchPrefix(e+i,"a=ice-pwd:")[0];return n&&r?{usernameFragment:n.substr(12),password:r.substr(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" ");for(let r=3;r<n.length;r++){const o=n[r],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){const n=t.parseRtpMap(s),r=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(n.parameters=r.length?t.parseFmtp(r[0]):{},n.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),i.codecs.push(n),n.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(n.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((e=>{i.headerExtensions.push(t.parseExtmap(e))})),i},t.writeRtpDescription=function(e,i){let n="";n+="m="+e+" ",n+=i.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=i.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));let r=0;return i.codecs.forEach((e=>{e.maxptime>r&&(r=e.maxptime)})),r>0&&(n+="a=maxptime:"+r+"\r\n"),i.headerExtensions&&i.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){const i=[],n=t.parseRtpParameters(e),r=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=s.length>0&&s[0].ssrc;let c;const d=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substr(17).split(" ").map((e=>parseInt(e,10)))));d.length>0&&d[0].length>1&&d[0][0]===a&&(c=d[0][1]),n.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),i.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&a&&i.push({ssrc:a});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,i.forEach((e=>{e.maxBitrate=u}))),i},t.parseRtcpParameters=function(e){const i={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(i.cname=n.value,i.ssrc=n.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");i.reducedSize=r.length>0,i.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return i.mux=o.length>0,i},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let i;const n=t.matchPrefix(e,"a=msid:");if(1===n.length)return i=n[0].substr(7).split(" "),{stream:i[0],track:i[1]};const r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return r.length>0?(i=r[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},t.parseSctpDescription=function(e){const i=t.parseMLine(e),n=t.matchPrefix(e,"a=max-message-size:");let r;n.length>0&&(r=parseInt(n[0].substr(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:i.fmt,maxMessageSize:r};const s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substr(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,i,n){let r;const o=void 0!==i?i:2;r=e||t.generateSessionId();return"v=0\r\no="+(n||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,i){const n=t.splitLines(e);for(let t=0;t<n.length;t++)switch(n[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[t].substr(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const i=t.splitLines(e)[0].substr(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(e){const i=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const i=t.splitLines(e);for(let t=0;t<i.length;t++)if(i[t].length<2||"="!==i[t].charAt(1))return!1;return!0},e.exports=t},2938:function(e,t,i){"use strict";function n(e,t,i){var n,r,o;void 0===t&&(t=50),void 0===i&&(i={});var s=null!=(n=i.isImmediate)&&n,a=null!=(r=i.callback)&&r,c=i.maxWait,d=Date.now(),u=[];function l(){if(void 0!==c){var e=Date.now()-d;if(e+t>=c)return c-e}return t}var p=function(){var t=[].slice.call(arguments),i=this;return new Promise((function(n,r){var c=s&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,d=Date.now(),!s){var n=e.apply(i,t);a&&a(n),u.forEach((function(e){return(0,e.resolve)(n)})),u=[]}}),l()),c){var p=e.apply(i,t);return a&&a(p),n(p)}u.push({resolve:n,reject:r})}))};return p.cancel=function(e){void 0!==o&&clearTimeout(o),u.forEach((function(t){return(0,t.reject)(e)})),u=[]},p}i.r(t),i.d(t,{debounce:function(){return n}})},42238:function(e,t,i){var n;!function(r,o){"use strict";var s="function",a="undefined",c="object",d="string",u="model",l="name",p="type",h="vendor",f="version",m="architecture",v="console",b="mobile",g="tablet",k="smarttv",S="wearable",y="embedded",w="Amazon",T="Apple",P="ASUS",C="BlackBerry",E="Firefox",O="Google",R="Huawei",_="LG",N="Microsoft",D="Motorola",U="Opera",I="Samsung",M="Sony",L="Xiaomi",x="Zebra",A="Facebook",j=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},J=function(e,t){return typeof e===d&&-1!==V(t).indexOf(V(e))},V=function(e){return e.toLowerCase()},q=function(e,t){if(typeof e===d)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===a?e:e.substring(0,255)},F=function(e,t){for(var i,n,r,a,d,u,l=0;l<t.length&&!d;){var p=t[l],h=t[l+1];for(i=n=0;i<p.length&&!d;)if(d=p[i++].exec(e))for(r=0;r<h.length;r++)u=d[++n],typeof(a=h[r])===c&&a.length>0?2===a.length?typeof a[1]==s?this[a[0]]=a[1].call(this,u):this[a[0]]=a[1]:3===a.length?typeof a[1]!==s||a[1].exec&&a[1].test?this[a[0]]=u?u.replace(a[1],a[2]):o:this[a[0]]=u?a[1].call(this,u,a[2]):o:4===a.length&&(this[a[0]]=u?a[3].call(this,u.replace(a[1],a[2])):o):this[a]=u||o;l+=2}},B=function(e,t){for(var i in t)if(typeof t[i]===c&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(J(t[i][n],e))return"?"===i?o:i}else if(J(t[i],e))return"?"===i?o:i;return e},Q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},G={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,f],[/opios[\/ ]+([\w\.]+)/i],[f,[l,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[f,[l,U]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[l,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[l,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[f,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[l,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure Browser"],f],[/\bfocus\/([\w\.]+)/i],[f,[l,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[f,[l,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[l,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[l,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[f,[l,E]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 Browser"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,A],f],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[l,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[l,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,"Chrome WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[l,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,f],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[f,[l,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[f,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[f,B,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[l,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[l,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,V]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",V]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[h,I],[p,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[h,I],[p,b]],[/\((ip(?:hone|od)[\w ]*);/i],[u,[h,T],[p,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[h,T],[p,g]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[h,R],[p,g]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[u,[h,R],[p,b]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[h,L],[p,b]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[h,L],[p,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[h,"OPPO"],[p,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[h,"Vivo"],[p,b]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[u,[h,"Realme"],[p,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[h,D],[p,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[h,D],[p,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[h,_],[p,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[h,_],[p,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[h,"Lenovo"],[p,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[h,"Nokia"],[p,b]],[/(pixel c)\b/i],[u,[h,O],[p,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[h,O],[p,b]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[h,M],[p,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[h,M],[p,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[h,"OnePlus"],[p,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[h,w],[p,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[h,w],[p,b]],[/(playbook);[-\w\),; ]+(rim)/i],[u,h,[p,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[h,C],[p,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[h,P],[p,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[h,P],[p,b]],[/(nexus 9)/i],[u,[h,"HTC"],[p,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[h,[u,/_/g," "],[p,b]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[h,"Acer"],[p,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[h,"Meizu"],[p,b]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[h,"Sharp"],[p,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,u,[p,b]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,u,[p,g]],[/(surface duo)/i],[u,[h,N],[p,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[h,"Fairphone"],[p,b]],[/(u304aa)/i],[u,[h,"AT&T"],[p,b]],[/\bsie-(\w*)/i],[u,[h,"Siemens"],[p,b]],[/\b(rct\w+) b/i],[u,[h,"RCA"],[p,g]],[/\b(venue[\d ]{2,7}) b/i],[u,[h,"Dell"],[p,g]],[/\b(q(?:mv|ta)\w+) b/i],[u,[h,"Verizon"],[p,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[h,"Barnes & Noble"],[p,g]],[/\b(tm\d{3}\w+) b/i],[u,[h,"NuVision"],[p,g]],[/\b(k88) b/i],[u,[h,"ZTE"],[p,g]],[/\b(nx\d{3}j) b/i],[u,[h,"ZTE"],[p,b]],[/\b(gen\d{3}) b.+49h/i],[u,[h,"Swiss"],[p,b]],[/\b(zur\d{3}) b/i],[u,[h,"Swiss"],[p,g]],[/\b((zeki)?tb.*\b) b/i],[u,[h,"Zeki"],[p,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],u,[p,g]],[/\b(ns-?\w{0,9}) b/i],[u,[h,"Insignia"],[p,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[h,"NextBook"],[p,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],u,[p,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],u,[p,b]],[/\b(ph-1) /i],[u,[h,"Essential"],[p,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[h,"Envizen"],[p,g]],[/\b(trio[-\w\. ]+) b/i],[u,[h,"MachSpeed"],[p,g]],[/\btu_(1491) b/i],[u,[h,"Rotor"],[p,g]],[/(shield[\w ]+) b/i],[u,[h,"Nvidia"],[p,g]],[/(sprint) (\w+)/i],[h,u,[p,b]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[h,N],[p,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[h,x],[p,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[h,x],[p,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,u,[p,v]],[/droid.+; (shield) bui/i],[u,[h,"Nvidia"],[p,v]],[/(playstation [345portablevi]+)/i],[u,[h,M],[p,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[h,N],[p,v]],[/smart-tv.+(samsung)/i],[h,[p,k]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[h,I],[p,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,_],[p,k]],[/(apple) ?tv/i],[h,[u,"Apple TV"],[p,k]],[/crkey/i],[[u,"Chromecast"],[h,O],[p,k]],[/droid.+aft(\w)( bui|\))/i],[u,[h,w],[p,k]],[/\(dtv[\);].+(aquos)/i],[u,[h,"Sharp"],[p,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[h,q],[u,q],[p,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[p,k]],[/((pebble))app/i],[h,u,[p,S]],[/droid.+; (glass) \d/i],[u,[h,O],[p,S]],[/droid.+; (wt63?0{2,3})\)/i],[u,[h,x],[p,S]],[/(quest( 2)?)/i],[u,[h,A],[p,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[p,y]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[u,[p,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[p,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[p,g]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[p,b]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[l,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[l,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[f,B,Q]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[f,B,Q]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,"Mac OS"],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[f,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,f],[/\(bb(10);/i],[f,[l,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[l,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[l,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[l,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[l,"Chromium OS"],f],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,f],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[l,f]]},W=function(e,t){if(typeof e===c&&(t=e,e=o),!(this instanceof W))return new W(e,t).getResult();var i=e||(typeof r!==a&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),n=t?function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2===0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i}(G,t):G;return this.getBrowser=function(){var e,t={};return t.name=o,t.version=o,F.call(t,i,n.browser),t.major=typeof(e=t.version)===d?e.replace(/[^\d\.]/g,"").split(".")[0]:o,t},this.getCPU=function(){var e={};return e.architecture=o,F.call(e,i,n.cpu),e},this.getDevice=function(){var e={};return e.vendor=o,e.model=o,e.type=o,F.call(e,i,n.device),e},this.getEngine=function(){var e={};return e.name=o,e.version=o,F.call(e,i,n.engine),e},this.getOS=function(){var e={};return e.name=o,e.version=o,F.call(e,i,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===d&&e.length>255?q(e,255):e,this},this.setUA(i),this};W.VERSION="1.0.2",W.BROWSER=j([l,f,"major"]),W.CPU=j([m]),W.DEVICE=j([u,h,p,v,b,k,g,S,y]),W.ENGINE=W.OS=j([l,f]),typeof t!==a?(e.exports&&(t=e.exports=W),t.UAParser=W):i.amdO?(n=function(){return W}.call(t,i,t,e))===o||(e.exports=n):typeof r!==a&&(r.UAParser=W);var z=typeof r!==a&&(r.jQuery||r.Zepto);if(z&&!z.ua){var H=new W;z.ua=H.getResult(),z.ua.get=function(){return H.getUA()},z.ua.set=function(e){H.setUA(e);var t=H.getResult();for(var i in t)z.ua[i]=t[i]}}}("object"===typeof window?window:this)},50835:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return ae}});var n={};i.r(n),i.d(n,{fixNegotiationNeeded:function(){return N},shimAddTrackRemoveTrack:function(){return R},shimAddTrackRemoveTrackWithNative:function(){return O},shimGetDisplayMedia:function(){return y},shimGetSendersWithDtmf:function(){return P},shimGetStats:function(){return C},shimGetUserMedia:function(){return S},shimMediaStream:function(){return w},shimOnTrack:function(){return T},shimPeerConnection:function(){return _},shimSenderReceiverGetStats:function(){return E}});var r={};i.r(r),i.d(r,{shimAddTransceiver:function(){return J},shimCreateAnswer:function(){return F},shimCreateOffer:function(){return q},shimGetDisplayMedia:function(){return U},shimGetParameters:function(){return V},shimGetUserMedia:function(){return D},shimOnTrack:function(){return I},shimPeerConnection:function(){return M},shimRTCDataChannel:function(){return j},shimReceiverGetStats:function(){return x},shimRemoveStream:function(){return A},shimSenderGetStats:function(){return L}});var o={};i.r(o),i.d(o,{shimAudioContext:function(){return $},shimCallbacksAPI:function(){return G},shimConstraints:function(){return z},shimCreateOfferLegacy:function(){return Z},shimGetUserMedia:function(){return W},shimLocalStreamsAPI:function(){return B},shimRTCIceServerUrls:function(){return H},shimRemoteStreamsAPI:function(){return Q},shimTrackEventTransceiver:function(){return K}});var s={};i.r(s),i.d(s,{removeExtmapAllowMixed:function(){return re},shimAddIceCandidateNullOrEmpty:function(){return oe},shimConnectionState:function(){return ne},shimMaxMessageSize:function(){return te},shimParameterlessSetLocalDescription:function(){return se},shimRTCIceCandidate:function(){return ee},shimSendThrowTypeError:function(){return ie}});let a=!0,c=!0;function d(e,t,i){const n=e.match(t);return n&&n.length>=i&&parseInt(n[i],10)}function u(e,t,i){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,r=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=i(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),r.apply(this,[e,o])};const o=n.removeEventListener;n.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(i))return o.apply(this,arguments);const n=this._eventMap[t].get(i);return this._eventMap[t].delete(i),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function l(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(a=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function p(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(c=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function h(){if("object"===typeof window){if(a)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function f(e,t){c&&console.warn(e+" is deprecated, please use "+t+" instead.")}function m(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e){return m(e)?Object.keys(e).reduce((function(t,i){const n=m(e[i]),r=n?v(e[i]):e[i],o=n&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[i]:r})}),{}):e}function b(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?b(e,e.get(t[n]),i):n.endsWith("Ids")&&t[n].forEach((t=>{b(e,e.get(t),i)}))})))}function g(e,t,i){const n=i?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((i=>{i.type===n&&i.trackId===t.id&&b(e,i,r)}))})),r}const k=h;function S(e,t){const i=e&&e.navigator;if(!i.mediaDevices)return;const n=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((i=>{if("require"===i||"advanced"===i||"mediaSource"===i)return;const n="object"===typeof e[i]?e[i]:{ideal:e[i]};void 0!==n.exact&&"number"===typeof n.exact&&(n.min=n.max=n.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];let e={};"number"===typeof n.ideal?(e[r("min",i)]=n.ideal,t.optional.push(e),e={},e[r("max",i)]=n.ideal,t.optional.push(e)):(e[r("",i)]=n.ideal,t.optional.push(e))}void 0!==n.exact&&"number"!==typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",i)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,i)]=n[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"===typeof e.video){let o=e.video.facingMode;o=o&&("object"===typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return i.mediaDevices.enumerateDevices().then((i=>{let s=(i=i.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&i.length&&t.includes("back")&&(s=i[i.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=n(e.video),k("chrome: "+JSON.stringify(e)),r(e)}))}e.video=n(e.video)}return k("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=function(e,t,n){r(e,(e=>{i.webkitGetUserMedia(e,t,(e=>{n&&n(o(e))}))}))}.bind(i),i.mediaDevices.getUserMedia){const e=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(t){return r(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function y(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(i){return t(i).then((t=>{const n=i.video&&i.video.width,r=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(i.video.mandatory.maxWidth=n),r&&(i.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function w(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function T(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.track.id)):{track:i.track};const r=new Event("track");r.track=i.track,r.receiver=n,r.transceiver={receiver:n},r.streams=[t.stream],this.dispatchEvent(r)})),t.stream.getTracks().forEach((i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.id)):{track:i};const r=new Event("track");r.track=i,r.receiver=n,r.transceiver={receiver:n},r.streams=[t.stream],this.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else u(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function P(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){let r=i.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function C(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,n]=arguments;if(arguments.length>0&&"function"===typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof e))return t.apply(this,[]);const r=function(e){const t={};return e.result().forEach((e=>{const i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{i[t]=e.stat(t)})),t[i.id]=i})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const n=function(e){i(o(r(e)))};return t.apply(this,[n,e])}return new Promise(((e,i)=>{t.apply(this,[function(t){e(o(r(t)))},i])})).then(i,n)}}function E(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>g(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),u(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>g(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,i,n;return this.getSenders().forEach((i=>{i.track===e&&(t?n=!0:t=i)})),this.getReceivers().forEach((t=>(t.track===e&&(i?n=!0:i=t),t.track===e))),n||t&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function O(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(n)&&this._shimmedLocalStreams[i.id].push(n):this._shimmedLocalStreams[i.id]=[i,n],n};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();i.apply(this,arguments);const n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const i=this._shimmedLocalStreams[t].indexOf(e);-1!==i&&this._shimmedLocalStreams[t].splice(i,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),r.apply(this,arguments)}}function R(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return O(e);const i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=i.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],r=e._streams[n.id];i=i.replace(new RegExp(r.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}function s(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],r=e._streams[n.id];i=i.replace(new RegExp(n.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:i})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const r=this.getSenders().find((e=>e.track===t));if(r)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[i.id];if(o)o.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const n=new e.MediaStream([t]);this._streams[i.id]=n,this._reverseStreams[n.id]=i,this.addStream(n)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?i.apply(this,[t=>{const i=o(this,t);e[0].apply(null,[i])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):i.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((i=>{this._streams[i].getTracks().find((t=>e.track===t))&&(t=this._streams[i])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function _(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function N(e,t){u(e,"negotiationneeded",(e=>{const i=e.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return e}))}function D(e,t){const i=e&&e.navigator,n=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,n){f("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const e=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(i){return"object"===typeof i&&"object"===typeof i.audio&&(i=JSON.parse(JSON.stringify(i)),e(i.audio,"autoGainControl","mozAutoGainControl"),e(i.audio,"noiseSuppression","mozNoiseSuppression")),t(i)},n&&n.prototype.getSettings){const t=n.prototype.getSettings;n.prototype.getSettings=function(){const i=t.apply(this,arguments);return e(i,"mozAutoGainControl","autoGainControl"),e(i,"mozNoiseSuppression","noiseSuppression"),i}}if(n&&n.prototype.applyConstraints){const t=n.prototype.applyConstraints;n.prototype.applyConstraints=function(i){return"audio"===this.kind&&"object"===typeof i&&(i=JSON.parse(JSON.stringify(i)),e(i,"autoGainControl","mozAutoGainControl"),e(i,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[i])}}}}function U(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})}function I(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function M(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!r)try{e.forEach((e=>{e.type=i[e.type]||e.type}))}catch(n){if("TypeError"!==n.name)throw n;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(r,o)}}function L(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function x(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),u(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function A(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){f("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function j(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function J(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],i=e&&"sendEncodings"in e;i&&e.sendEncodings.forEach((e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const n=t.apply(this,arguments);if(i){const{sender:t}=n,i=t.getParameters();(!("encodings"in i)||1===i.encodings.length&&0===Object.keys(i.encodings[0]).length)&&(i.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(i).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return n})}function V(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function q(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function F(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function B(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((i=>t.call(this,i,e))),e.getVideoTracks().forEach((i=>t.call(this,i,e)))},e.RTCPeerConnection.prototype.addTrack=function(e,...i){return i&&i.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const i=e.getTracks();this.getSenders().forEach((e=>{i.includes(e.track)&&this.removeTrack(e)}))})}}function Q(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}))}),t.apply(e,arguments)}}}function G(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,i=t.createOffer,n=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r};let a=function(e,t,i){const n=r.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n};t.setLocalDescription=a,a=function(e,t,i){const n=o.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.setRemoteDescription=a,a=function(e,t,i){const n=s.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.addIceCandidate=a}function W(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,i=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>i(z(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,i,n){t.mediaDevices.getUserMedia(e).then(i,n)}.bind(t))}function z(e){return e&&void 0!==e.video?Object.assign({},e,{video:v(e.video)}):e}function H(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,i){if(e&&e.iceServers){const t=[];for(let i=0;i<e.iceServers.length;i++){let n=e.iceServers[i];!n.hasOwnProperty("urls")&&n.hasOwnProperty("url")?(f("RTCIceServer.url","RTCIceServer.urls"),n=JSON.parse(JSON.stringify(n)),n.urls=n.url,delete n.url,t.push(n)):t.push(e.iceServers[i])}e.iceServers=t}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function K(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Z(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const i=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function $(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Y=i(57539),X=i.n(Y);function ee(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const i=new t(e),n=X().parseCandidate(e.candidate),r=Object.assign(i,n);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,u(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function te(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const i=function(e){if(!e||!e.sdp)return!1;const t=X().splitSections(e.sdp);return t.shift(),t.some((e=>{const t=X().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},n=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const i=parseInt(t[1],10);return i!==i?-1:i},r=function(e){let i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i},o=function(e,i){let n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);const r=X().matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?n=parseInt(r[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(n=2147483637),n},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const e=n(arguments[0]),t=r(e),i=o(arguments[0],e);let s;s=0===t&&0===i?Number.POSITIVE_INFINITY:0===t||0===i?Math.max(t,i):Math.min(t,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function ie(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const i=e.send;e.send=function(){const n=arguments[0],r=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}const i=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=i.apply(this,arguments);return t(e,this),e},u(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function ne(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}function re(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const i=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:i}):t.sdp=i}return i.apply(this,arguments)}}function oe(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const i=e.RTCPeerConnection.prototype.addIceCandidate;i&&0!==i.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function se(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const i=e.RTCPeerConnection.prototype.setLocalDescription;i&&0!==i.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return i.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return i.apply(this,[e]);const t="offer"===e.type?this.createOffer:this.createAnswer;return t.apply(this).then((e=>i.apply(this,[e])))})}var ae=function({window:e}={},t={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const i=h,a=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:i}=e;if(i.mozGetUserMedia)t.browser="firefox",t.version=d(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=d(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=d(i.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),c={browserDetails:a,commonShim:s,extractVersion:d,disableLog:l,disableWarnings:p,sdp:Y};switch(a.browser){case"chrome":if(!n||!_||!t.shimChrome)return i("Chrome shim is not included in this adapter release."),c;if(null===a.version)return i("Chrome shim can not determine version, not shimming."),c;i("adapter.js shimming chrome."),c.browserShim=n,oe(e,a),se(e),S(e,a),w(e),_(e,a),T(e),R(e,a),P(e),C(e),E(e),N(e,a),ee(e),ne(e),te(e,a),ie(e),re(e,a);break;case"firefox":if(!r||!M||!t.shimFirefox)return i("Firefox shim is not included in this adapter release."),c;i("adapter.js shimming firefox."),c.browserShim=r,oe(e,a),se(e),D(e,a),M(e,a),I(e),A(e),L(e),x(e),j(e),J(e),V(e),q(e),F(e),ee(e),ne(e),te(e,a),ie(e);break;case"safari":if(!o||!t.shimSafari)return i("Safari shim is not included in this adapter release."),c;i("adapter.js shimming safari."),c.browserShim=o,oe(e,a),se(e),H(e),Z(e),G(e),B(e),Q(e),K(e),W(e),$(e),ee(e),te(e,a),ie(e),re(e,a);break;default:i("Unsupported browser!")}return c}({window:"undefined"===typeof window?void 0:window})}}]);